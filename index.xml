<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>å‡‰éƒ½å°é“ on å‡‰éƒ½å°é“</title><link>https://ronggle.com/</link><description>Recent content in å‡‰éƒ½å°é“ on å‡‰éƒ½å°é“</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 30 Jun 2019 16:27:29 +0800</lastBuildDate><atom:link href="https://ronggle.com/" rel="self" type="application/rss+xml"/><item><title>Elassandraç®€å•ä»‹ç»</title><link>https://ronggle.com/2019/elassandra-getting-and-started/</link><pubDate>Sun, 30 Jun 2019 16:27:29 +0800</pubDate><guid>https://ronggle.com/2019/elassandra-getting-and-started/</guid><description>&lt;h2 id=&#34;elassandra&#34;&gt;Elassandra&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://www.elassandra.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Elassandra&lt;/a&gt;æ˜¯&lt;a href=&#34;https://github.com/elastic/elasticsearch&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Elasticsearch&lt;/a&gt;çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œç»è¿‡ä¿®æ”¹ï¼Œå¯ä»¥ä½œä¸º&lt;a href=&#34;http://cassandra.apache.org/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Apache Cassandra&lt;/a&gt;çš„æ’ä»¶è¿è¡Œï¼Œå…·æœ‰å¯æ‰©å±•å’Œçµæ´»çš„ç‚¹å¯¹ç‚¹æ¶æ„ã€‚ Elasticsearchä»£ç åµŒå…¥åœ¨CassandaèŠ‚ç‚¹ä¸­ï¼Œåœ¨Cassandraè¡¨ä¸Šæä¾›é«˜çº§æœç´¢åŠŸèƒ½ï¼ŒCassandraç”¨ä½œElasticsearchæ•°æ®å’Œé…ç½®å­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/elassandra-getting-and-started/elassandra-arch.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Elassandraæ”¯æŒCassandra vnodesï¼Œå¹¶é€šè¿‡æ·»åŠ æ›´å¤šèŠ‚ç‚¹è¿›è¡Œæ°´å¹³æ‰©å±•ã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›®æ–‡æ¡£å¯åœ¨&lt;a href=&#34;https://doc.elassandra.io&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;doc.elassandra.io&lt;/a&gt;ä¸Šè·å¾—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;elassandraçš„å¥½å¤„&#34;&gt;Elassandraçš„å¥½å¤„&lt;/h2&gt;
&lt;p&gt;å¯¹äºCassandraç”¨æˆ·ï¼Œelassandraæä¾›ElasticsearchåŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨Elasticsearchä¸­æ›´æ–°Cassandraç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹Cassandraæ•°æ®è¿›è¡Œå…¨æ–‡å’Œç©ºé—´æœç´¢ã€‚&lt;/li&gt;
&lt;li&gt;å®æ—¶èšåˆï¼ˆä¸éœ€è¦Sparkæˆ–Hadoopæ¥å®ŒæˆGROUP BYï¼‰&lt;/li&gt;
&lt;li&gt;åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­æä¾›å¯¹å¤šä¸ªé”®ç©ºé—´å’Œè¡¨çš„æœç´¢ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨â€œç”¨æˆ·å®šä¹‰çš„ç±»å‹â€æä¾›è‡ªåŠ¨æ¨¡å¼åˆ›å»ºå’Œæ”¯æŒåµŒå¥—æ–‡æ¡£ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›JSON REST APIå¯¹Cassandraæ•°æ®çš„è¯»/å†™è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;è®¸å¤šElasticsearchæ’ä»¶å’ŒKibanaç­‰äº§å“ã€‚&lt;/li&gt;
&lt;li&gt;ç®¡ç†å¹¶å‘å¼¹æ€§æœç´¢æ˜ å°„æ›´æ”¹å¹¶åº”ç”¨æ‰¹å¤„ç†åŸå­CQLæ¶æ„æ›´æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒElasticsearchæ‘„å–å¤„ç†å™¨ï¼Œå…è®¸è½¬æ¢è¾“å…¥æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºElasticsearchç”¨æˆ·ï¼Œelassandraæä¾›äº†æœ‰ç”¨çš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Elassandraæ˜¯æ— ä¸»çš„ã€‚ç¾¤é›†çŠ¶æ€é€šè¿‡cassandraè½»é‡çº§äº‹åŠ¡è¿›è¡Œç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;Elassandraæ˜¯ä¸€ä¸ªåˆ†ç‰‡çš„å¤šä¸»æ•°æ®åº“ï¼Œå…¶ä¸­Elasticsearchæ˜¯åˆ†ç‰‡ä¸»ä»ã€‚å› æ­¤ï¼ŒElassandraæ²¡æœ‰å•ç‚¹å†™å…¥ï¼Œæœ‰åŠ©äºå®ç°é«˜å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;Elassandraç»§æ‰¿äº†Cassandraæ•°æ®ä¿®å¤æœºåˆ¶ï¼ˆæš—ç¤ºåˆ‡æ¢ï¼Œè¯»å–ä¿®å¤å’Œnodetoolä¿®å¤ï¼‰ï¼Œä¸ºè·¨æ•°æ®ä¸­å¿ƒå¤åˆ¶æä¾›æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;å°†èŠ‚ç‚¹æ·»åŠ åˆ°Elassandraé›†ç¾¤æ—¶ï¼Œåªæœ‰ä»ç°æœ‰èŠ‚ç‚¹æå–çš„æ•°æ®æ‰ä¼šåœ¨Elasticsearchä¸­é‡æ–°ç¼–åˆ¶ç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;Cassandraå¯èƒ½æ˜¯æ‚¨ç´¢å¼•å’Œéç´¢å¼•æ•°æ®çš„å”¯ä¸€æ•°æ®å­˜å‚¨åŒºã€‚å®ƒæ›´æ˜“äºç®¡ç†å’Œä¿æŠ¤ã€‚æºæ–‡æ¡£ç°åœ¨å­˜å‚¨åœ¨Cassandraä¸­ï¼Œå¦‚æœæ‚¨éœ€è¦NoSQLæ•°æ®åº“å’ŒElasticsearchï¼Œåˆ™ä¼šå‡å°‘ç£ç›˜ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;å†™æ“ä½œä¸é™äºä¸€ä¸ªä¸»åˆ†ç‰‡ï¼Œè€Œæ˜¯åˆ†å¸ƒåœ¨è™šæ‹Ÿæ•°æ®ä¸­å¿ƒçš„æ‰€æœ‰CassandraèŠ‚ç‚¹ä¸Šã€‚åˆ†ç‰‡æ•°é‡ä¸ä¼šé™åˆ¶æ‚¨çš„å†™å…¥ååé‡ã€‚æ·»åŠ elassandraèŠ‚ç‚¹ä¼šå¢åŠ è¯»å†™ååé‡ã€‚&lt;/li&gt;
&lt;li&gt;Elasticsearchç´¢å¼•å¯ä»¥åœ¨è®¸å¤šCassandraæ•°æ®ä¸­å¿ƒä¹‹é—´å¤åˆ¶ï¼Œå…è®¸å†™å…¥æœ€è¿‘çš„æ•°æ®ä¸­å¿ƒå¹¶è¿›è¡Œå…¨å±€æœç´¢ã€‚&lt;/li&gt;
&lt;li&gt;cassandraé©±åŠ¨ç¨‹åºå¯è¯†åˆ«æ•°æ®ä¸­å¿ƒå’Œä»¤ç‰Œï¼Œæä¾›è‡ªåŠ¨è´Ÿè½½å¹³è¡¡å’Œæ•…éšœè½¬ç§»ã€‚&lt;/li&gt;
&lt;li&gt;Elassandraæœ‰æ•ˆåœ°å°†Elasticsearchæ–‡æ¡£å­˜å‚¨åœ¨äºŒè¿›åˆ¶SSTableä¸­ï¼Œè€Œä¸ä¼šäº§ç”Ÿä»»ä½•JSONå¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¿«é€Ÿå¼€å§‹&#34;&gt;å¿«é€Ÿå¼€å§‹&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨dockerå¯åŠ¨å•èŠ‚ç‚¹çš„Elassandraé›†ç¾¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# ä¸‹è½½dockeré•œåƒ
$ docker pull docker.io/strapdata/elassandra:latest
# å¯åŠ¨
$ docker run -d --rm \
--name elassandra \
-p 9042:9042 \
-p 9200:9200 \
-e JVM_OPTS=&amp;quot;-Dcassandra.custom_query_handler_class=org.elassandra.index.ElasticQueryHandler&amp;quot; \
docker.io/strapdata/elassandra:latest
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ£€æŸ¥Elassandraé›†ç¾¤çŠ¶æ€ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker exec -i elassandra nodetool status
Datacenter: DC1
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
-- Address Load Tokens Owns (effective) Host ID Rack
UN 172.17.0.3 80.97 KiB 8 100.0% 81a9e4e0-efe4-458d-861e-8d527835372d r1
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ä»cassandraè¡¨åˆ›å»ºelasticsearchç´¢å¼•&#34;&gt;ä»Cassandraè¡¨åˆ›å»ºElasticsearchç´¢å¼•&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨cassandra CQLSHåˆ›å»ºä¸€ä¸ªcassandra Keyspaceï¼Œä¸€ä¸ªUser Defined Typeï¼Œä¸€ä¸ªTableå¹¶æ·»åŠ ä¸¤è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker exec -i elassandra cqlsh &amp;lt;&amp;lt;EOF
CREATE KEYSPACE IF NOT EXISTS test WITH replication = {&#39;class&#39;: &#39;NetworkTopologyStrategy&#39;, &#39;DC1&#39;: 1};
CREATE TYPE IF NOT EXISTS test.user_type (first text, last text);
CREATE TABLE IF NOT EXISTS test.docs (uid int, username frozen&amp;lt;user_type&amp;gt;, login text, PRIMARY KEY (uid));
INSERT INTO test.docs (uid, username, login) VALUES (1, {first:&#39;vince&#39;,last:&#39;royer&#39;}, &#39;vroyer&#39;);
INSERT INTO test.docs (uid, username, login) VALUES (2, {first:&#39;barthelemy&#39;,last:&#39;delemotte&#39;}, &#39;barth&#39;);
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡å‘ç°CQLç»“æ„ä»Cassandraè¡¨æ¶æ„åˆ›å»ºElasticsearchç´¢å¼•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ curl -XPUT -H &#39;Content-Type: application/json&#39; http://localhost:9200/test -d&#39;{&amp;quot;mappings&amp;quot;:{&amp;quot;docs&amp;quot;:{&amp;quot;discover&amp;quot;:&amp;quot;.*&amp;quot;}}}&#39;
{&amp;quot;acknowledged&amp;quot;:true,&amp;quot;shards_acknowledged&amp;quot;:true,&amp;quot;index&amp;quot;:&amp;quot;test&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤å‘½ä»¤å‘ç°ä¸æä¾›çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ‰€æœ‰åˆ—ï¼Œå¹¶åˆ›å»ºEslasticsearchç´¢å¼•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»å¤´å¼€å§‹åˆ›å»ºelasticsearchç´¢å¼•&#34;&gt;ä»å¤´å¼€å§‹åˆ›å»ºElasticsearchç´¢å¼•&lt;/h3&gt;
&lt;p&gt;Elassandraåœ¨åˆ›å»ºç´¢å¼•æˆ–ä½¿ç”¨æ–°å­—æ®µæ›´æ–°æ˜ å°„æ—¶è‡ªåŠ¨ç”ŸæˆåŸºç¡€CQLç»“æ„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ curl -XPUT -H &#39;Content-Type: application/json&#39; http://localhost:9200/test2 -d&#39;{
&amp;quot;mappings&amp;quot;:{
&amp;quot;docs&amp;quot;:{
&amp;quot;properties&amp;quot;: {
&amp;quot;first&amp;quot;: {
&amp;quot;type&amp;quot;:&amp;quot;text&amp;quot;
},
&amp;quot;last&amp;quot;: {
&amp;quot;type&amp;quot;:&amp;quot;text&amp;quot;,
&amp;quot;cql_collection&amp;quot;:&amp;quot;singleton&amp;quot;
}
}
}
}
}&#39;
{&amp;quot;acknowledged&amp;quot;:true,&amp;quot;shards_acknowledged&amp;quot;:true,&amp;quot;index&amp;quot;:&amp;quot;test2&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”Ÿæˆçš„CQLç»“æ„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker exec -it elassandra cqlsh
Connected to Test Cluster at 127.0.0.1:9042.
[cqlsh 5.0.1 | Cassandra 3.11.4.2 | CQL spec 3.4.4 | Native protocol v4]
Use HELP for help.
cqlsh&amp;gt; desc KEYSPACE test2;
CREATE KEYSPACE test2 WITH replication = {&#39;class&#39;: &#39;NetworkTopologyStrategy&#39;, &#39;DC1&#39;: &#39;1&#39;} AND durable_writes = true;
CREATE TABLE test2.docs (
&amp;quot;_id&amp;quot; text PRIMARY KEY,
first list&amp;lt;text&amp;gt;,
last text
) WITH bloom_filter_fp_chance = 0.01
AND caching = {&#39;keys&#39;: &#39;ALL&#39;, &#39;rows_per_partition&#39;: &#39;NONE&#39;}
AND comment = &#39;&#39;
AND compaction = {&#39;class&#39;: &#39;org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy&#39;, &#39;max_threshold&#39;: &#39;32&#39;, &#39;min_threshold&#39;: &#39;4&#39;}
AND compression = {&#39;chunk_length_in_kb&#39;: &#39;64&#39;, &#39;class&#39;: &#39;org.apache.cassandra.io.compress.LZ4Compressor&#39;}
AND crc_check_chance = 1.0
AND dclocal_read_repair_chance = 0.1
AND default_time_to_live = 0
AND gc_grace_seconds = 864000
AND max_index_interval = 2048
AND memtable_flush_period_in_ms = 0
AND min_index_interval = 128
AND read_repair_chance = 0.0
AND speculative_retry = &#39;99PERCENTILE&#39;;
CREATE CUSTOM INDEX elastic_docs_idx ON test2.docs () USING &#39;org.elassandra.index.ExtendedElasticSecondaryIndex&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;æœç´¢æ–‡æ¡£&#34;&gt;æœç´¢æ–‡æ¡£&lt;/h3&gt;
&lt;p&gt;é€šè¿‡Elasticsearch APIæœç´¢æ–‡æ¡£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ curl &amp;quot;http://localhost:9200/test/_search?pretty&amp;quot;
{
&amp;quot;took&amp;quot; : 53,
&amp;quot;timed_out&amp;quot; : false,
&amp;quot;_shards&amp;quot; : {
&amp;quot;total&amp;quot; : 1,
&amp;quot;successful&amp;quot; : 1,
&amp;quot;skipped&amp;quot; : 0,
&amp;quot;failed&amp;quot; : 0
},
&amp;quot;hits&amp;quot; : {
&amp;quot;total&amp;quot; : 2,
&amp;quot;max_score&amp;quot; : 1.0,
&amp;quot;hits&amp;quot; : [
{
&amp;quot;_index&amp;quot; : &amp;quot;test&amp;quot;,
&amp;quot;_type&amp;quot; : &amp;quot;docs&amp;quot;,
&amp;quot;_id&amp;quot; : &amp;quot;1&amp;quot;,
&amp;quot;_score&amp;quot; : 1.0,
&amp;quot;_source&amp;quot; : {
&amp;quot;uid&amp;quot; : 1,
&amp;quot;login&amp;quot; : &amp;quot;vroyer&amp;quot;,
&amp;quot;username&amp;quot; : {
&amp;quot;last&amp;quot; : &amp;quot;royer&amp;quot;,
&amp;quot;first&amp;quot; : &amp;quot;vince&amp;quot;
}
}
},
{
&amp;quot;_index&amp;quot; : &amp;quot;test&amp;quot;,
&amp;quot;_type&amp;quot; : &amp;quot;docs&amp;quot;,
&amp;quot;_id&amp;quot; : &amp;quot;2&amp;quot;,
&amp;quot;_score&amp;quot; : 1.0,
&amp;quot;_source&amp;quot; : {
&amp;quot;uid&amp;quot; : 2,
&amp;quot;login&amp;quot; : &amp;quot;barth&amp;quot;,
&amp;quot;username&amp;quot; : {
&amp;quot;last&amp;quot; : &amp;quot;delemotte&amp;quot;,
&amp;quot;first&amp;quot; : &amp;quot;barthelemy&amp;quot;
}
}
}
]
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦é€šè¿‡CQLé©±åŠ¨ç¨‹åºæœç´¢æ–‡æ¡£ï¼Œè¯·åœ¨è¡¨æ¨¡å¼ä¸­æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªè™šæ‹Ÿåˆ—ã€‚ ç„¶åï¼Œæ‰§è¡ŒElasticsearchåµŒå¥—æŸ¥è¯¢ã€‚ ä¼ªåˆ—å…è®¸æ‚¨åœ¨ç´¢å¼•åç§°ä¸é”®ç©ºé—´åç§°ä¸åŒ¹é…æ—¶æŒ‡å®šç›®æ ‡ç´¢å¼•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker exec -it elassandra cqlsh
Connected to Test Cluster at 127.0.0.1:9042.
[cqlsh 5.0.1 | Cassandra 3.11.4.2 | CQL spec 3.4.4 | Native protocol v4]
Use HELP for help.
cqlsh&amp;gt; ALTER TABLE test.docs ADD es_query text;
cqlsh&amp;gt; ALTER TABLE test.docs ADD es_options text;
cqlsh&amp;gt; SELECT uid, login, username FROM test.docs WHERE es_query=&#39;{ &amp;quot;query&amp;quot;:{&amp;quot;nested&amp;quot;:{&amp;quot;path&amp;quot;:&amp;quot;username&amp;quot;,&amp;quot;query&amp;quot;:{&amp;quot;term&amp;quot;:{&amp;quot;username.first&amp;quot;:&amp;quot;barthelemy&amp;quot;}}}}}&#39; AND es_options=&#39;indices=test&#39; ALLOW FILTERING;
uid | login | username
-----+-------+------------------------------------------
2 | barth | {first: &#39;barthelemy&#39;, last: &#39;delemotte&#39;}
(1 rows)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ç®¡ç†elasticsearchç´¢å¼•&#34;&gt;ç®¡ç†Elasticsearchç´¢å¼•&lt;/h3&gt;
&lt;p&gt;è·å–Elasticsearché›†ç¾¤çŠ¶æ€ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ curl &amp;quot;http://localhost:9200/_cluster/state?pretty&amp;quot;
{
&amp;quot;cluster_name&amp;quot; : &amp;quot;Test Cluster&amp;quot;,
&amp;quot;compressed_size_in_bytes&amp;quot; : 730,
&amp;quot;version&amp;quot; : 14,
&amp;quot;state_uuid&amp;quot; : &amp;quot;tMqNt8PpS5ySuaRxHUGc1w&amp;quot;,
&amp;quot;master_node&amp;quot; : &amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot;,
&amp;quot;blocks&amp;quot; : { },
&amp;quot;nodes&amp;quot; : {
&amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot; : {
&amp;quot;name&amp;quot; : &amp;quot;172.17.0.3&amp;quot;,
&amp;quot;status&amp;quot; : &amp;quot;ALIVE&amp;quot;,
&amp;quot;ephemeral_id&amp;quot; : &amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot;,
&amp;quot;transport_address&amp;quot; : &amp;quot;172.17.0.3:9300&amp;quot;,
&amp;quot;attributes&amp;quot; : {
&amp;quot;rack&amp;quot; : &amp;quot;r1&amp;quot;,
&amp;quot;dc&amp;quot; : &amp;quot;DC1&amp;quot;
}
}
},
&amp;quot;metadata&amp;quot; : {
&amp;quot;version&amp;quot; : 4,
&amp;quot;cluster_uuid&amp;quot; : &amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot;,
&amp;quot;templates&amp;quot; : { },
&amp;quot;indices&amp;quot; : {
&amp;quot;test&amp;quot; : {
&amp;quot;state&amp;quot; : &amp;quot;open&amp;quot;,
&amp;quot;settings&amp;quot; : {
&amp;quot;index&amp;quot; : {
&amp;quot;creation_date&amp;quot; : &amp;quot;1561883488853&amp;quot;,
&amp;quot;number_of_shards&amp;quot; : &amp;quot;1&amp;quot;,
&amp;quot;number_of_replicas&amp;quot; : &amp;quot;0&amp;quot;,
&amp;quot;uuid&amp;quot; : &amp;quot;h34je53mSVqojho2gIH91A&amp;quot;,
&amp;quot;version&amp;quot; : {
&amp;quot;created&amp;quot; : &amp;quot;6020399&amp;quot;
},
&amp;quot;provided_name&amp;quot; : &amp;quot;test&amp;quot;
}
},
&amp;quot;mappings&amp;quot; : {
&amp;quot;docs&amp;quot; : {
&amp;quot;properties&amp;quot; : {
&amp;quot;uid&amp;quot; : {
&amp;quot;cql_partition_key&amp;quot; : true,
&amp;quot;cql_primary_key_order&amp;quot; : 0,
&amp;quot;type&amp;quot; : &amp;quot;integer&amp;quot;,
&amp;quot;cql_collection&amp;quot; : &amp;quot;singleton&amp;quot;
},
&amp;quot;login&amp;quot; : {
&amp;quot;type&amp;quot; : &amp;quot;keyword&amp;quot;,
&amp;quot;cql_collection&amp;quot; : &amp;quot;singleton&amp;quot;
},
&amp;quot;username&amp;quot; : {
&amp;quot;cql_udt_name&amp;quot; : &amp;quot;user_type&amp;quot;,
&amp;quot;type&amp;quot; : &amp;quot;nested&amp;quot;,
&amp;quot;properties&amp;quot; : {
&amp;quot;last&amp;quot; : {
&amp;quot;type&amp;quot; : &amp;quot;keyword&amp;quot;,
&amp;quot;cql_collection&amp;quot; : &amp;quot;singleton&amp;quot;
},
&amp;quot;first&amp;quot; : {
&amp;quot;type&amp;quot; : &amp;quot;keyword&amp;quot;,
&amp;quot;cql_collection&amp;quot; : &amp;quot;singleton&amp;quot;
}
},
&amp;quot;cql_collection&amp;quot; : &amp;quot;singleton&amp;quot;
}
}
}
},
&amp;quot;aliases&amp;quot; : [ ],
&amp;quot;primary_terms&amp;quot; : {
&amp;quot;0&amp;quot; : 0
},
&amp;quot;in_sync_allocations&amp;quot; : {
&amp;quot;0&amp;quot; : [ ]
}
},
&amp;quot;test2&amp;quot; : {
&amp;quot;state&amp;quot; : &amp;quot;open&amp;quot;,
&amp;quot;settings&amp;quot; : {
&amp;quot;index&amp;quot; : {
&amp;quot;creation_date&amp;quot; : &amp;quot;1561883720880&amp;quot;,
&amp;quot;number_of_shards&amp;quot; : &amp;quot;1&amp;quot;,
&amp;quot;number_of_replicas&amp;quot; : &amp;quot;0&amp;quot;,
&amp;quot;uuid&amp;quot; : &amp;quot;u7BgODwuT_idHbcuenvi6g&amp;quot;,
&amp;quot;version&amp;quot; : {
&amp;quot;created&amp;quot; : &amp;quot;6020399&amp;quot;
},
&amp;quot;provided_name&amp;quot; : &amp;quot;test2&amp;quot;
}
},
&amp;quot;mappings&amp;quot; : {
&amp;quot;docs&amp;quot; : {
&amp;quot;properties&amp;quot; : {
&amp;quot;last&amp;quot; : {
&amp;quot;type&amp;quot; : &amp;quot;text&amp;quot;,
&amp;quot;cql_collection&amp;quot; : &amp;quot;singleton&amp;quot;
},
&amp;quot;first&amp;quot; : {
&amp;quot;type&amp;quot; : &amp;quot;text&amp;quot;
}
}
}
},
&amp;quot;aliases&amp;quot; : [ ],
&amp;quot;primary_terms&amp;quot; : {
&amp;quot;0&amp;quot; : 0
},
&amp;quot;in_sync_allocations&amp;quot; : {
&amp;quot;0&amp;quot; : [ ]
}
}
},
&amp;quot;index-graveyard&amp;quot; : {
&amp;quot;tombstones&amp;quot; : [ ]
}
},
&amp;quot;routing_table&amp;quot; : {
&amp;quot;indices&amp;quot; : {
&amp;quot;test&amp;quot; : {
&amp;quot;shards&amp;quot; : {
&amp;quot;0&amp;quot; : [
{
&amp;quot;state&amp;quot; : &amp;quot;STARTED&amp;quot;,
&amp;quot;primary&amp;quot; : true,
&amp;quot;node&amp;quot; : &amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot;,
&amp;quot;relocating_node&amp;quot; : null,
&amp;quot;shard&amp;quot; : 0,
&amp;quot;index&amp;quot; : &amp;quot;test&amp;quot;,
&amp;quot;token_ranges&amp;quot; : [
&amp;quot;(-9223372036854775808,9223372036854775807]&amp;quot;
],
&amp;quot;allocation_id&amp;quot; : {
&amp;quot;id&amp;quot; : &amp;quot;dummy_alloc_id&amp;quot;
}
}
]
}
},
&amp;quot;test2&amp;quot; : {
&amp;quot;shards&amp;quot; : {
&amp;quot;0&amp;quot; : [
{
&amp;quot;state&amp;quot; : &amp;quot;STARTED&amp;quot;,
&amp;quot;primary&amp;quot; : true,
&amp;quot;node&amp;quot; : &amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot;,
&amp;quot;relocating_node&amp;quot; : null,
&amp;quot;shard&amp;quot; : 0,
&amp;quot;index&amp;quot; : &amp;quot;test2&amp;quot;,
&amp;quot;token_ranges&amp;quot; : [
&amp;quot;(-9223372036854775808,9223372036854775807]&amp;quot;
],
&amp;quot;allocation_id&amp;quot; : {
&amp;quot;id&amp;quot; : &amp;quot;dummy_alloc_id&amp;quot;
}
}
]
}
}
}
},
&amp;quot;routing_nodes&amp;quot; : {
&amp;quot;unassigned&amp;quot; : [ ],
&amp;quot;nodes&amp;quot; : {
&amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot; : [
{
&amp;quot;state&amp;quot; : &amp;quot;STARTED&amp;quot;,
&amp;quot;primary&amp;quot; : true,
&amp;quot;node&amp;quot; : &amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot;,
&amp;quot;relocating_node&amp;quot; : null,
&amp;quot;shard&amp;quot; : 0,
&amp;quot;index&amp;quot; : &amp;quot;test&amp;quot;,
&amp;quot;token_ranges&amp;quot; : [
&amp;quot;(-9223372036854775808,9223372036854775807]&amp;quot;
],
&amp;quot;allocation_id&amp;quot; : {
&amp;quot;id&amp;quot; : &amp;quot;dummy_alloc_id&amp;quot;
}
},
{
&amp;quot;state&amp;quot; : &amp;quot;STARTED&amp;quot;,
&amp;quot;primary&amp;quot; : true,
&amp;quot;node&amp;quot; : &amp;quot;81a9e4e0-efe4-458d-861e-8d527835372d&amp;quot;,
&amp;quot;relocating_node&amp;quot; : null,
&amp;quot;shard&amp;quot; : 0,
&amp;quot;index&amp;quot; : &amp;quot;test2&amp;quot;,
&amp;quot;token_ranges&amp;quot; : [
&amp;quot;(-9223372036854775808,9223372036854775807]&amp;quot;
],
&amp;quot;allocation_id&amp;quot; : {
&amp;quot;id&amp;quot; : &amp;quot;dummy_alloc_id&amp;quot;
}
}
]
}
},
&amp;quot;snapshots&amp;quot; : {
&amp;quot;snapshots&amp;quot; : [ ]
},
&amp;quot;restore&amp;quot; : {
&amp;quot;snapshots&amp;quot; : [ ]
},
&amp;quot;snapshot_deletions&amp;quot; : {
&amp;quot;snapshot_deletions&amp;quot; : [ ]
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è·å–Elasticsearchç´¢å¼•ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ curl &amp;quot;http://localhost:9200/_cat/indices?v&amp;quot;
health status index uuid pri rep docs.count docs.deleted store.size pri.store.size
green open test2 u7BgODwuT_idHbcuenvi6g 1 0 0 0 208b 208b
green open test h34je53mSVqojho2gIH91A 1 0 4 0 4kb 4kb
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ é™¤Elasticsearchç´¢å¼•ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸åˆ é™¤åº•å±‚çš„Cassandraè¡¨ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;curl -XDELETE http://localhost:9200/test
{&amp;quot;acknowledged&amp;quot;:true}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>å›¾å½¢æ•°æ®åº“ç®€å•ä»‹ç»</title><link>https://ronggle.com/2019/graph-db-getting-and-started/</link><pubDate>Fri, 08 Mar 2019 11:27:29 +0800</pubDate><guid>https://ronggle.com/2019/graph-db-getting-and-started/</guid><description>&lt;h2 id=&#34;å…³ç³»å‹æ•°æ®åº“&#34;&gt;å…³ç³»å‹æ•°æ®åº“&lt;/h2&gt;
&lt;p&gt;å…³ç³»æ•°æ®åº“ï¼Œæ˜¯å»ºç«‹åœ¨å…³ç³»æ¨¡å‹åŸºç¡€ä¸Šçš„æ•°æ®åº“ï¼Œå€ŸåŠ©äºé›†åˆä»£æ•°ç­‰æ•°å­¦æ¦‚å¿µå’Œæ–¹æ³•æ¥å¤„ç†æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;ç°å®ä¸–ç•Œä¸­çš„å„ç§å®ä½“ä»¥åŠå®ä½“ä¹‹é—´çš„å„ç§è”ç³»å‡ç”¨å…³ç³»æ¨¡å‹æ¥è¡¨ç¤ºã€‚å…³ç³»æ¨¡å‹æ˜¯ç”±åŸƒå¾·åŠ Â·ç§‘å¾·äº1970å¹´é¦–å…ˆæå‡ºçš„ï¼Œå¹¶é…åˆâ€œç§‘å¾·åäºŒå®šå¾‹â€ã€‚ç°å¦‚ä»Šè™½ç„¶å¯¹æ­¤æ¨¡å‹æœ‰ä¸€äº›æ‰¹è¯„æ„è§ï¼Œä½†å®ƒè¿˜æ˜¯æ•°æ®å­˜å‚¨çš„ä¼ ç»Ÿæ ‡å‡†ã€‚æ ‡å‡†æ•°æ®æŸ¥è¯¢è¯­è¨€SQLå°±æ˜¯ä¸€ç§åŸºäºå…³ç³»æ•°æ®åº“çš„è¯­è¨€ï¼Œè¿™ç§è¯­è¨€æ‰§è¡Œå¯¹å…³ç³»æ•°æ®åº“ä¸­æ•°æ®çš„æ£€ç´¢å’Œæ“ä½œã€‚ å…³ç³»æ¨¡å‹ç”±å…³ç³»æ•°æ®ç»“æ„ã€å…³ç³»æ“ä½œé›†åˆã€å…³ç³»å®Œæ•´æ€§çº¦æŸä¸‰éƒ¨åˆ†ç»„æˆã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•è¯´ï¼Œå…³ç³»å‹æ•°æ®åº“æ˜¯ç”±å¤šå¼ èƒ½äº’ç›¸è”æ¥çš„äºŒç»´è¡Œåˆ—è¡¨æ ¼ç»„æˆçš„æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;nosql&#34;&gt;NoSQL&lt;/h2&gt;
&lt;p&gt;NoSQL(Not Only SQL)ï¼Œæ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;p&gt;éšç€äº’è”ç½‘Web2.0ç½‘ç«™çš„å…´èµ·ï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨åº”ä»˜Web2.0ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯è¶…å¤§è§„æ¨¡å’Œé«˜å¹¶å‘çš„SNSç±»å‹çš„Web2.0çº¯åŠ¨æ€ç½‘ç«™å·²ç»æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œæš´éœ²äº†å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼Œè€Œéå…³ç³»å‹çš„æ•°æ®åº“åˆ™ç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹å¾—åˆ°äº†éå¸¸è¿…é€Ÿçš„å‘å±•ã€‚NoSQLæ•°æ®åº“çš„äº§ç”Ÿå°±æ˜¯ä¸ºäº†è§£å†³å¤§è§„æ¨¡æ•°æ®é›†åˆå¤šé‡æ•°æ®ç§ç±»å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯å¤§æ•°æ®åº”ç”¨éš¾é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;NoSQLæ•°æ®åº“çš„å››å¤§åˆ†ç±»:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;KVæ•°æ®åº“&lt;/li&gt;
&lt;li&gt;å›¾å‹æ•°æ®åº“&lt;/li&gt;
&lt;li&gt;æ–‡æ¡£å‹æ•°æ®åº“&lt;/li&gt;
&lt;li&gt;åˆ—å­˜å‚¨æ•°æ®åº“&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»Šå¤©æˆ‘ä»¬è¦è¯´çš„ï¼Œä¾¿æ˜¯å›¾å½¢æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å›¾å½¢æ•°æ®åº“&#34;&gt;å›¾å½¢æ•°æ®åº“&lt;/h2&gt;
&lt;p&gt;å›¾å½¢æ•°æ®åº“æ˜¯NoSQLæ•°æ®åº“çš„ä¸€ç§ç±»å‹ï¼Œå®ƒåº”ç”¨å›¾å½¢ç†è®ºå­˜å‚¨å®ä½“ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ã€‚å›¾å½¢æ•°æ®åº“æ˜¯ä¸€ç§éå…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒåº”ç”¨å›¾å½¢ç†è®ºå­˜å‚¨å®ä½“ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ã€‚æœ€å¸¸è§ä¾‹å­å°±æ˜¯ç¤¾ä¼šç½‘ç»œä¸­äººä¸äººä¹‹é—´çš„å…³ç³»ã€‚å…³ç³»å‹æ•°æ®åº“ç”¨äºå­˜å‚¨â€œå…³ç³»å‹â€æ•°æ®çš„æ•ˆæœå¹¶ä¸å¥½ï¼Œå…¶æŸ¥è¯¢å¤æ‚ã€ç¼“æ…¢ã€è¶…å‡ºé¢„æœŸï¼Œè€Œå›¾å½¢æ•°æ®åº“çš„ç‹¬ç‰¹è®¾è®¡æ°æ°å¼¥è¡¥äº†è¿™ä¸ªç¼ºé™·ã€‚&lt;/p&gt;
&lt;p&gt;å’Œå…¶ä»–ä»¥åˆ—ã€è¡Œæˆ–è€…KVç­‰å½¢å¼å­˜å‚¨æ•°æ®çš„æ•°æ®åº“ä¸åŒï¼Œå›¾å½¢æ•°æ®åº“ä»¥èŠ‚ç‚¹ï¼ˆNodeï¼‰å’Œè¾¹ï¼ˆEdgeï¼‰çš„ç½‘ç»œå­˜å‚¨æ‰€æœ‰ä¿¡æ¯ã€‚è¾¹è¡¨ç¤ºé‚£äº›ä»£è¡¨å¯¹è±¡çš„èŠ‚ç‚¹ä¹‹é—´çš„è”ç³»ã€‚å› ä¸ºè¾¹å’ŒèŠ‚ç‚¹éƒ½å¯ä»¥è¢«æè¿°ä¸ºå¯¹è±¡ï¼Œå¼€å‘è€…å¯ä»¥ä¸ºå…¶æŒ‡å®šå±æ€§ï¼ˆAttributeï¼Œæˆ–è€… propertyï¼‰ã€‚ä¸ºè¾¹å¢åŠ æ–¹å‘æœ€ç»ˆä¼šåˆ›å»ºä¸€ä¸ªå±æ€§å›¾ï¼Œå®ƒä»£è¡¨å›¾å½¢æ•°æ®åº“ä¸­çš„æ˜ç¡®ç»“æ„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å›¾å½¢æ•°æ®åº“&#34;&gt;æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å›¾å½¢æ•°æ®åº“ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å›¾å½¢æ•°æ®åº“å¯ä»¥é€šè¿‡ä½¿ç”¨æ“ä½œã€æ‰€æœ‰æƒå’Œçˆ¶é¡¹å…³ç³»ç­‰æ¥è¡¨ç¤ºå®ä½“ä¹‹é—´çš„å…³è”å…³ç³»ã€‚å¦‚æœå®ä½“é—´çš„è¿æ¥æˆ–å…³ç³»æ˜¯æ‚¨æ­£åœ¨å°è¯•å»ºæ¨¡çš„æ•°æ®çš„æ ¸å¿ƒï¼Œé‚£å°±é€‚åˆä½¿ç”¨å›¾å½¢æ•°æ®åº“ã€‚å› æ­¤ï¼Œå›¾å½¢æ•°æ®åº“å¯¹äºå»ºæ¨¡å’ŒæŸ¥è¯¢ç¤¾äº¤ç½‘ç»œã€æ¨èå¼•æ“ã€çŸ¥è¯†å›¾è°±ã€é©¾é©¶æ–¹å‘ (è·¯çº¿æŸ¥æ‰¾)ã€ä¸šåŠ¡å…³ç³»ã€ä¾èµ–å…³ç³»ã€è´§ç‰©ç§»åŠ¨ç­‰ç±»ä¼¼é¡¹ç›®éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¤¾äº¤ç½‘ç»œ&#34;&gt;ç¤¾äº¤ç½‘ç»œ&lt;/h3&gt;
&lt;p&gt;é€‚åˆé‡‡ç”¨å›¾å½¢çš„å¸¸è§ä½¿ç”¨æ¡ˆä¾‹çš„ä¸€ä¸ªç¤ºä¾‹å°±æ˜¯ç¤¾äº¤ç½‘ç»œæ•°æ®ã€‚
&lt;img src=&#34;https://ronggle.com/graph-db-getting-and-started/friend-likes.png&#34; alt=&#34;graph db friend links&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ¨èå¼•æ“&#34;&gt;æ¨èå¼•æ“&lt;/h3&gt;
&lt;p&gt;å¯ä»¥åœ¨å›¾å½¢æ•°æ®åº“ä¸­å­˜å‚¨å®¢æˆ·å…´è¶£ã€å¥½å‹å’Œè´­ä¹°å†å²ç­‰ä¿¡æ¯ç±»åˆ«ä¹‹é—´çš„å…³ç³»ã€‚ç„¶åï¼Œå¿«é€ŸæŸ¥è¯¢å®ƒä»¥æå‡ºä¸ªæ€§åŒ–å’Œç›¸å…³çš„å»ºè®®ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨é«˜åº¦å¯ç”¨çš„å›¾å½¢æ•°æ®åº“ï¼Œæ ¹æ®å…³æ³¨ç›¸åŒè¿åŠ¨å†…å®¹ä¸”å…·æœ‰ç±»ä¼¼è´­ä¹°å†å²è®°å½•çš„å…¶ä»–äººè´­ä¹°çš„äº§å“ï¼Œå‘ç”¨æˆ·æä¾›äº§å“æ¨èã€‚æˆ–è€…ï¼Œå¯ä»¥è¯†åˆ«æœ‰å…±åŒå¥½å‹ä½†è¿˜ä¸è®¤è¯†å¯¹æ–¹çš„äººå‘˜ï¼Œç„¶åæä¾›å¥½å‹æ¨èã€‚&lt;/p&gt;
&lt;h3 id=&#34;çŸ¥è¯†å›¾è°±&#34;&gt;çŸ¥è¯†å›¾è°±&lt;/h3&gt;
&lt;p&gt;åˆ©ç”¨çŸ¥è¯†å›¾å½¢ï¼Œæ‚¨å¯ä»¥å°†ä¿¡æ¯å­˜å‚¨åœ¨å›¾å½¢æ¨¡å‹ä¸­ï¼Œå¹¶å¯ä»¥ä½¿ç”¨å›¾å½¢æŸ¥è¯¢å¸®åŠ©ç”¨æˆ·æ›´è½»æ¾åœ°å¯¼èˆªé«˜åº¦å…³è”çš„æ•°æ®é›†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·å¯¹ Leonardo da Vinci åˆ›ä½œçš„ Mona Lisa æ„Ÿå…´è¶£ï¼Œæ‚¨å¯ä»¥å¸®åŠ©ä»–ä»¬å‘ç°åŒä¸€è‰ºæœ¯å®¶çš„å…¶ä»–è‰ºæœ¯ä½œå“æˆ–å‘ç°åœ¨å¢æµ®å®«å±•è§ˆçš„å…¶ä»–ä½œå“ã€‚
åˆ©ç”¨çŸ¥è¯†å›¾è°±ï¼Œæ‚¨å¯ä»¥å°†ä¸»é¢˜ä¿¡æ¯æ·»åŠ åˆ°äº§å“ç›®å½•ï¼Œæ„å»ºå’ŒæŸ¥è¯¢å¤æ‚çš„ç›‘ç®¡è§„åˆ™æ¨¡å‹ï¼Œæˆ–è€…è¿›è¡Œä¸€èˆ¬ä¿¡æ¯å»ºæ¨¡ (å¦‚ç»´åŸºæ•°æ®)ã€‚&lt;/p&gt;
&lt;h2 id=&#34;neo4j&#34;&gt;Neo4j&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://neo4j.com/docs/getting-started/current/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Neo4j&lt;/a&gt;æ˜¯ä¸–ç•Œé¢†å…ˆçš„å›¾å½¢æ•°æ®åº“ã€‚ å®ƒæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„å›¾å½¢å­˜å‚¨ï¼Œå…·æœ‰æˆç†Ÿå’Œå¼ºå¤§çš„æ•°æ®åº“æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¦‚å‹å¥½çš„æŸ¥è¯¢è¯­è¨€å’ŒACIDäº‹åŠ¡ã€‚ ç¨‹åºå‘˜ä½¿ç”¨çµæ´»çš„èŠ‚ç‚¹å’Œå…³ç³»ç½‘ç»œç»“æ„è€Œä¸æ˜¯é™æ€è¡¨ - ä½†äº«å—ä¼ä¸šçº§æ•°æ®åº“çš„æ‰€æœ‰å¥½å¤„ã€‚ å¯¹äºè®¸å¤šåº”ç”¨ç¨‹åºï¼Œä¸å…³ç³»æ•°æ®åº“ç›¸æ¯”ï¼ŒNeo4jæä¾›äº†æ•°é‡çº§çš„æ€§èƒ½ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®‰è£…&#34;&gt;å®‰è£…&lt;/h3&gt;
&lt;p&gt;è€æ ·å­ï¼Œæˆ‘ä¾æ—§ä¼šé€‚ç”¨Dockeræ¥è¿›è¡Œå®‰è£…ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker run -d \
--name neo4j \
-p 7474:7474 -p 7687:7687 \
-v $HOME/neo4j/data:/data \
-v $HOME/neo4j/logs:/logs \
neo4j
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/graph-db-getting-and-started/neo4j-dashboard.png&#34; alt=&#34;neo4j-dashboard&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;å®ä¾‹&#34;&gt;å®ä¾‹&lt;/h3&gt;
&lt;h4 id=&#34;æ·»åŠ ä¾èµ–&#34;&gt;æ·»åŠ ä¾èµ–&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-gradle&#34;&gt;dependencies {
compile(&amp;quot;org.neo4j:neo4j-ogm-core:3.1.7&amp;quot;)
compile(&amp;quot;org.neo4j:neo4j-ogm-http-driver:3.1.7&amp;quot;)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ä»£ç &#34;&gt;ä»£ç &lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package team.soi.demo;
import lombok.Getter;
import lombok.Setter;
import org.neo4j.ogm.annotation.GeneratedValue;
import org.neo4j.ogm.annotation.Id;
import org.neo4j.ogm.annotation.NodeEntity;
import org.neo4j.ogm.annotation.Relationship;
import org.neo4j.ogm.config.Configuration;
import org.neo4j.ogm.session.Session;
import org.neo4j.ogm.session.SessionFactory;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
public class App {
public static void main(String[] args) {
Configuration configuration = new Configuration.Builder()
.uri(&amp;quot;http://neo4j:qazplm@localhost:7474&amp;quot;)
.build();
SessionFactory sessionFactory = new SessionFactory(configuration, &amp;quot;team.soi.demo&amp;quot;);
Session session = sessionFactory.openSession();
User tom = new User();
tom.setName(&amp;quot;Tom&amp;quot;);
User bobby = new User();
bobby.setName(&amp;quot;Bobby&amp;quot;);
User linda = new User();
linda.setName(&amp;quot;Linda&amp;quot;);
linda.setFriends(Arrays.asList(tom, bobby));
session.save(linda);
}
}
@NodeEntity
@Getter
@Setter
class User implements Serializable {
@Id
@GeneratedValue
private Long id;
private String name;
@Relationship(type = &amp;quot;friend&amp;quot;)
private List&amp;lt;User&amp;gt; friends = new ArrayList&amp;lt;&amp;gt;();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/graph-db-getting-and-started/neo4j-friend.png&#34; alt=&#34;neo4j-friend&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://www.w3cschool.cn/neo4j/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;neo4jæ•™ç¨‹&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;dgraph&#34;&gt;Dgraph&lt;/h2&gt;
&lt;p&gt;Dgraphæ˜¯ä¸€ä¸ªæ°´å¹³å¯æ‰©å±•çš„åˆ†å¸ƒå¼å›¾å½¢æ•°æ®åº“ï¼Œæä¾›ACIDäº‹åŠ¡ï¼Œä¸€è‡´çš„å¤åˆ¶å’Œçº¿æ€§åŒ–è¯»å–ã€‚ å®ƒæ˜¯ä»å¤´å¼€å§‹æ„å»ºçš„ï¼Œç”¨äºæ‰§è¡Œä¸°å¯Œçš„æŸ¥è¯¢ã€‚ ä½œä¸ºæœ¬æœºå›¾å½¢æ•°æ®åº“ï¼Œå®ƒä¸¥æ ¼æ§åˆ¶æ•°æ®åœ¨ç£ç›˜ä¸Šçš„æ’åˆ—æ–¹å¼ï¼Œä»¥ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½å’Œååé‡ï¼Œå‡å°‘ç£ç›˜æœç´¢å’Œç¾¤é›†ä¸­çš„ç½‘ç»œè°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Dgraphçš„ç›®æ ‡æ˜¯æä¾›è°·æ­Œç”Ÿäº§æ°´å¹³çš„è§„æ¨¡å’Œååé‡ï¼Œå…·æœ‰è¶³å¤Ÿä½çš„å»¶è¿Ÿï¼Œå¯ä»¥æä¾›è¶…è¿‡æ•°TBçš„ç»“æ„åŒ–æ•°æ®çš„å®æ—¶ç”¨æˆ·æŸ¥è¯¢ã€‚ Dgraphæ”¯æŒç±»ä¼¼GraphQLçš„æŸ¥è¯¢è¯­æ³•ï¼Œå¹¶é€šè¿‡GRPCå’ŒHTTPå“åº”JSONå’ŒProtocol Buffersã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®‰è£…-1&#34;&gt;å®‰è£…&lt;/h3&gt;
&lt;p&gt;ç”±äºDgraphè‡³å°‘è¦æœ‰ä¸€ä¸ªzeroå’Œä¸€ä¸ªserveræ‰èƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨docker-compose.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;version: &amp;quot;3.2&amp;quot;
services:
zero:
image: dgraph/dgraph:latest
volumes:
- type: volume
source: dgraph
target: /dgraph
volume:
nocopy: true
ports:
- 5080:5080
- 6080:6080
restart: on-failure
command: dgraph zero --my=zero:5080
server:
image: dgraph/dgraph:latest
volumes:
- type: volume
source: dgraph
target: /dgraph
volume:
nocopy: true
ports:
- 8080:8080
- 9080:9080
restart: on-failure
command: dgraph alpha --my=server:7080 --lru_mb=2048 --zero=zero:5080
ratel:
image: dgraph/dgraph:latest
volumes:
- type: volume
source: dgraph
target: /dgraph
volume:
nocopy: true
ports:
- 8000:8000
command: dgraph-ratel
volumes:
dgraph:
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å®ä¾‹-1&#34;&gt;å®ä¾‹&lt;/h3&gt;
&lt;h4 id=&#34;ä¾èµ–&#34;&gt;ä¾èµ–&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;compile(&amp;quot;io.dgraph:dgraph4j:1.7.1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ä»£ç -1&#34;&gt;ä»£ç &lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package team.soi.demo;
import com.google.gson.Gson;
import com.google.gson.annotations.SerializedName;
import com.google.protobuf.ByteString;
import io.dgraph.DgraphClient;
import io.dgraph.DgraphGrpc;
import io.dgraph.DgraphProto;
import io.dgraph.Transaction;
import io.grpc.ManagedChannel;
import io.grpc.ManagedChannelBuilder;
import lombok.Getter;
import lombok.Setter;
import java.io.Serializable;
import java.time.LocalDateTime;
import java.util.*;
public class DgraphApp {
public static void main(String[] args) {
ManagedChannel channel = ManagedChannelBuilder
.forAddress(&amp;quot;localhost&amp;quot;, 9080)
.usePlaintext()
.build();
DgraphGrpc.DgraphStub stub = DgraphGrpc.newStub(channel);
DgraphClient dgraph = new DgraphClient(stub);
//
dgraph.alter(DgraphProto.Operation.newBuilder().setDropAll(true).build());
Gson gson = new Gson();
Transaction tx = dgraph.newTransaction();
try {
Tag database = new Tag();
database.setName(&amp;quot;Database&amp;quot;);
Tag graph = new Tag();
graph.setName(&amp;quot;Graph&amp;quot;);
Category category = new Category();
category.setName(&amp;quot;GraphDB&amp;quot;);
Post post = new Post();
post.setTitle(&amp;quot;Hello dgraph&amp;quot;);
post.setDigest(&amp;quot;Dgraph demo.&amp;quot;);
post.setContent(&amp;quot;Hello dgraph,this is a demo.&amp;quot;);
post.setViews(0);
post.setCreated(LocalDateTime.now().toString());
post.setTags(Arrays.asList(database, graph));
post.setCategories(Collections.singletonList(category));
String json = gson.toJson(post);
DgraphProto.Mutation mu = DgraphProto.Mutation
.newBuilder()
.setSetJson(ByteString.copyFromUtf8(json))
.build();
tx.mutate(mu);
tx.commit();
} finally {
tx.discard();
}
// query
String query = &amp;quot;query posts($offset: int, $count: int){\n&amp;quot; +
&amp;quot;\t\tposts(func: has(title), orderdesc: created, orderdesc: views, offset: $offset, first: $count){\n&amp;quot; +
&amp;quot;\t\t\tuid\n&amp;quot; +
&amp;quot;\t\t\ttitle\n&amp;quot; +
&amp;quot;\t\t\tcategories {\n&amp;quot; +
&amp;quot;\t\t\t\tuid\n&amp;quot; +
&amp;quot;\t\t\t\tname\n&amp;quot; +
&amp;quot;\t\t\t}\n&amp;quot; +
&amp;quot;\t\t\ttags {\n&amp;quot; +
&amp;quot;\t\t\t\tuid\n&amp;quot; +
&amp;quot;\t\t\t\tname\n&amp;quot; +
&amp;quot;\t\t\t}\n&amp;quot; +
&amp;quot;\t\t\tdigest\n&amp;quot; +
&amp;quot;\t\t\tcreated\n&amp;quot; +
&amp;quot;\t\t}\n&amp;quot; +
&amp;quot;\t}&amp;quot;;
Map&amp;lt;String, String&amp;gt; vars = new HashMap&amp;lt;&amp;gt;();
vars.put(&amp;quot;$offset&amp;quot;, &amp;quot;0&amp;quot;);
vars.put(&amp;quot;$count&amp;quot;, &amp;quot;25&amp;quot;);
DgraphProto.Response response = dgraph.newReadOnlyTransaction().queryWithVars(query, vars);
Posts posts = gson.fromJson(response.getJson().toStringUtf8(), Posts.class);
System.out.printf(&amp;quot;Found hot post: %d\n&amp;quot;, posts.getPosts().size());
posts.getPosts().forEach(post -&amp;gt; System.out.println(post.getTitle()));
}
}
@Getter
@Setter
class Posts implements Serializable {
List&amp;lt;Post&amp;gt; posts;
}
@Getter
@Setter
class Post implements Serializable {
@SerializedName(&amp;quot;uid&amp;quot;)
private String id;
private String title;
private String digest;
private String content;
private String created;
private Integer views;
private List&amp;lt;Tag&amp;gt; tags = new ArrayList&amp;lt;&amp;gt;();
private List&amp;lt;Category&amp;gt; categories = new ArrayList&amp;lt;&amp;gt;();
}
@Getter
@Setter
class Tag implements Serializable {
@SerializedName(&amp;quot;uid&amp;quot;)
private String id;
private String name;
}
@Setter
@Getter
class Category implements Serializable {
@SerializedName(&amp;quot;uid&amp;quot;)
private String id;
private String name;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/graph-db-getting-and-started/dgraph-post.png&#34; alt=&#34;dgraph-post&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://dgraph-zh.cn/#/home/index&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Dgraphä¸­æ–‡æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ç»“æŸè¯­&#34;&gt;ç»“æŸè¯­&lt;/h2&gt;
&lt;p&gt;å½“ç„¶ï¼Œæœ¬æ¬¡çŸ¥è¯†ç²—ç•¥ä»‹ç»äº†ä¸‹å›¾æ•°æ®åº“ï¼Œå¦‚æœæœ‰æ—¶é—´ï¼Œåç»­æˆ‘åº”è¯¥ä¼šæ‰¾ä¸€ä¸ªåœºæ™¯æ¥å®é™…åº”ç”¨ï¼Œå…ˆæŒ–ä¸ªå‘ï¼Œåç»­åŠªåŠ›è¡¥ä¸Š ğŸ˜„ ã€‚&lt;/p&gt;</description></item><item><title>Traefik on Kubernetes</title><link>https://ronggle.com/2018/traefik-on-kubernetes/</link><pubDate>Sat, 10 Nov 2018 21:34:29 +0800</pubDate><guid>https://ronggle.com/2018/traefik-on-kubernetes/</guid><description>&lt;p&gt;ä¹‹å‰åŒäº‹é—®æˆ‘åœ¨Kubernetesä¸Šä½¿ç”¨ï¼Œä»–æŒ‰ç…§Traefikæ–‡æ¡£ä¸Šçš„éƒ¨ç½²ï¼Œä¸èƒ½ä½¿ç”¨ã€‚åé¢æˆ‘è‡ªå·±æŠŠæˆ‘æ•´ç†çš„é…ç½®å‘ç»™ä»–ï¼ŒæˆåŠŸåœ¨Kubernetesä¸Šéƒ¨ç½²ï¼Œè®°å½•ä¸‹ï¼Œæ–¹ä¾¿é‡åˆ°åŒæ ·ç–‘é—®çš„æœ‹å‹ï¼Œå¤§ç¥è¯·ç•¥è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/traefik-on-kubernetes/traefik_on_k8s.svg&#34; alt=&#34;traefik on kubernetes&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚ä¸Šå›¾ï¼Œä¸ºç§°ä¹‹ä¸ºéƒ¨ç½²æ¶æ„ã€‚ç”¨æˆ·ä½¿ç”¨åŸŸåé€šè¿‡LBè®¿é—®éƒ¨ç½²åœ¨K8Sä¸Šçš„åº”ç”¨ï¼ŒLBé€šè¿‡è´Ÿè½½å‡è¡¡åå‘ä»£ç†æš´éœ²åœ¨NodePortä¸Šçš„TraefikæœåŠ¡ï¼ŒTraefikåˆ™åœ¨K8Så†…éƒ¨ä½¿ç”¨åŸŸåå‘ç°K8Sä¸Šé€šè¿‡Ingressæš´éœ²å‡ºæ¥çš„åº”ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;éƒ¨ç½²traefik&#34;&gt;éƒ¨ç½²Traefik&lt;/h2&gt;
&lt;h3 id=&#34;traefik-rbac-yaml-traefik-on-kubernetes-traefik-rbac-yaml&#34;&gt;&lt;a href=&#34;https://ronggle.com/traefik-on-kubernetes/traefik-rbac.yaml&#34;&gt;traefik-rbac.yaml&lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;---
apiVersion: v1
kind: ConfigMap
metadata:
name: traefik
labels:
app: traefik
data:
traefik.toml: |
# traefik.toml
logLevel = &amp;quot;INFO&amp;quot;
defaultEntryPoints = [&amp;quot;http&amp;quot;, &amp;quot;httpn&amp;quot;]
[entryPoints]
[entryPoints.http]
address = &amp;quot;:80&amp;quot;
compress = true
[entryPoints.httpn]
address = &amp;quot;:8880&amp;quot;
compress = true
[entryPoints.traefik]
address = &amp;quot;:8080&amp;quot;
[kubernetes]
[traefikLog]
format = &amp;quot;json&amp;quot;
[api]
entryPoint = &amp;quot;traefik&amp;quot;
dashboard = true
---
apiVersion: apps/v1
kind: Deployment
metadata:
name: traefik
labels:
app: traefik
spec:
replicas: 1
selector:
matchLabels:
app: traefik
release: traefik
template:
metadata:
annotations:
checksum/config: 55a29204986001f01835269242a08a68d59bc276658728cc28c5543e34f26d0b
labels:
app: traefik
spec:
serviceAccountName: traefik
terminationGracePeriodSeconds: 60
containers:
- image: traefik:1.7.4
name: traefik
resources:
requests:
cpu: &amp;quot;100m&amp;quot;
memory: &amp;quot;20Mi&amp;quot;
limits:
cpu: &amp;quot;100m&amp;quot;
memory: &amp;quot;30Mi&amp;quot;
readinessProbe:
tcpSocket:
port: 80
failureThreshold: 1
initialDelaySeconds: 10
periodSeconds: 10
successThreshold: 1
timeoutSeconds: 2
livenessProbe:
tcpSocket:
port: 80
failureThreshold: 3
initialDelaySeconds: 10
periodSeconds: 10
successThreshold: 1
timeoutSeconds: 2
volumeMounts:
- mountPath: /config
name: config
ports:
- name: http
containerPort: 80
protocol: TCP
- name: httpn
containerPort: 8880
protocol: TCP
- name: https
containerPort: 443
protocol: TCP
- name: dash
containerPort: 8080
protocol: TCP
args:
- --configfile=/config/traefik.toml
volumes:
- name: config
configMap:
name: traefik
---
apiVersion: v1
kind: Service
metadata:
name: traefik
labels:
app: traefik
annotations:
spec:
type: NodePort
selector:
app: traefik
release: traefik
ports:
- port: 80
name: http
targetPort: http
- port: 443
name: https
targetPort: httpn
---
kind: ServiceAccount
apiVersion: v1
metadata:
name: traefik
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
name: traefik
rules:
- apiGroups:
- &amp;quot;&amp;quot;
resources:
- pods
- services
- endpoints
- secrets
verbs:
- get
- list
- watch
- apiGroups:
- extensions
resources:
- ingresses
verbs:
- get
- list
- watch
- apiGroups:
- extensions
resources:
- ingresses/status
verbs:
- update
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
name: traefik
roleRef:
apiGroup: rbac.authorization.k8s.io
kind: ClusterRole
name: traefik
subjects:
- kind: ServiceAccount
name: traefik
namespace: kube-system
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ kubectl apply -f traefik-rbac.yaml -n traefik
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;traefik-ui-yaml-traefik-on-kubernetes-traefik-ui-yaml&#34;&gt;&lt;a href=&#34;https://ronggle.com/traefik-on-kubernetes/traefik-ui.yaml&#34;&gt;traefik-ui.yaml&lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
name: traefik-dashboard
labels:
app: traefik
annotations:
spec:
rules:
- host: traefik.cloud-labs.io
http:
paths:
- backend:
serviceName: traefik-dashboard
servicePort: 80
---
apiVersion: v1
kind: Service
metadata:
name: traefik-dashboard
labels:
app: traefik
annotations:
spec:
selector:
app: traefik
release: traefik
ports:
- port: 80
targetPort: 8080
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ kubectl apply -f traefik-ui.yaml -n traefik
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;lb&#34;&gt;LB&lt;/h2&gt;
&lt;p&gt;è¿™è¾¹å°†ä½¿ç”¨nginxä½œä¸ºLBï¼Œä½¿ç”¨å…¶çš„åå‘ä»£ç†ï¼Œå°†è¯·æ±‚åå‘ä»£ç†åˆ°traefikæ‰€åœ¨çš„NodePortä¸Šï¼Œnginxé…ç½®&lt;a href=&#34;https://ronggle.com/traefik-on-kubernetes/defauult.conf&#34;&gt;default.conf&lt;/a&gt;å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-conf&#34;&gt;upstream k8s {
server 192.168.100.100:30080;
server 192.168.100.101:30080;
server 192.168.100.102:30080;
}
server {
listen 80;
server_name cloud-labs.io;
#access_log logs/quancha.access.log main;
#error_log logs/quancha.error.log;
root html;
index index.html index.htm index.php;
## send request back to apache ##
location / {
proxy_pass http://k8s;
#Proxy Settings
proxy_redirect off;
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;
proxy_max_temp_file_size 0;
proxy_connect_timeout 90;
proxy_send_timeout 90;
proxy_read_timeout 90;
proxy_buffer_size 4k;
proxy_buffers 4 32k;
proxy_busy_buffers_size 64k;
proxy_temp_file_write_size 64k;
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é…ç½®hosts&#34;&gt;é…ç½®hosts&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ cat /etc/hosts
192.168.100.100 traefik.cloud-labs.io
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;éªŒè¯&#34;&gt;éªŒè¯&lt;/h2&gt;
&lt;p&gt;æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥&lt;code&gt;traefik.cloud-labs.io&lt;/code&gt;å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼š
&lt;img src=&#34;https://ronggle.com/traefik-on-kubernetes/traefik-dashboard.png&#34; alt=&#34;traefik dashboard&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;éƒ¨ç½²ä¸€ä¸ªåº”ç”¨&#34;&gt;éƒ¨ç½²ä¸€ä¸ªåº”ç”¨&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†ç®€å•æ–¹ä¾¿èµ·è§ï¼Œæˆ‘åœ¨è¿™é‡Œå°†éƒ¨ç½²ä¸€ä¸ªnginxï¼Œå¹¶ä½¿ç”¨åŸŸå&lt;code&gt;nginx.cloud-labs.io&lt;/code&gt;æ¥è®¿é—®å®ƒã€‚é…ç½®æ–‡ä»¶&lt;a href=&#34;https://ronggle.com/traefik-on-kubernetes/nginx-apps.yaml&#34;&gt;nginx-apps.yaml&lt;/a&gt;å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;---
apiVersion: apps/v1
kind: Deployment
metadata:
name: nginx
labels:
app: nginx
role: web
spec:
replicas: 1
selector:
matchLabels:
app: nginx
template:
metadata:
labels:
app: nginx
spec:
containers:
- name: nginx
image: nginx:latest
imagePullPolicy: IfNotPresent
ports:
- name: http
containerPort: 80
protocol: TCP
- name: https
containerPort: 443
protocol: TCP
---
apiVersion: v1
kind: Service
metadata:
name: nginx
labels:
app: nginx
annotations:
spec:
type: ClusterIP
selector:
app: nginx
ports:
- port: 80
name: http
targetPort: http
---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
name: nginx
labels:
app: nginx
annotations:
spec:
rules:
- host: nginx.cloud-labs.io
http:
paths:
- backend:
serviceName: nginx
servicePort: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ kubectl apply -f nginx-apps.yaml
$ cat /etc/hosts
192.168.100.100 traefik.cloud-labs.io
192.168.100.100 nginx.cloud-labs.io
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰“å¼€æµè§ˆå™¨&lt;code&gt;http://nginx.cloud-labs.io/&lt;/code&gt;ï¼š
&lt;img src=&#34;https://ronggle.com/traefik-on-kubernetes/nginx-apps.png&#34; alt=&#34;nginx-apps.png&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ç»“æŸè¯­&#34;&gt;ç»“æŸè¯­&lt;/h2&gt;
&lt;p&gt;ä¸€ç¯‡æ°´æ–‡ï¼Œåˆ°æ­¤ç»“æŸï¼Œæœ¬æ–‡é‡ç‚¹è®°å½•äº†åœ¨kubernetesä¸Šä½¿ç”¨traefikä½œä¸ºingressä½¿ç”¨ï¼Œä¸ä¸ºåˆ«çš„ï¼Œå°±æ˜¯ä¸ºäº†è®°å½•ä¸‹ã€‚&lt;/p&gt;</description></item><item><title>ä½¿ç”¨gRPCå¼€å‘å¾®æœåŠ¡-æœåŠ¡æ³¨å†Œä¸å‘ç°</title><link>https://ronggle.com/2018/registry-microservies-via-grpc/</link><pubDate>Sun, 12 Aug 2018 20:04:08 +0800</pubDate><guid>https://ronggle.com/2018/registry-microservies-via-grpc/</guid><description>&lt;p&gt;è°ˆåˆ°å¾®æœåŠ¡ï¼Œå°±ä¸å…ä¼šæåŠæœåŠ¡æ³¨å†Œï¼Œæˆ‘ä»¬ä¸Šä¸€èŠ‚ä¸­å·²ç»å®ç°äº†gRPCçš„æœåŠ¡å¼€å‘ï¼Œä»¥åŠå®¢æˆ·ç«¯å¼€å‘ï¼Œåœ¨æˆ‘ä»¬çš„å®¢æˆ·ç«¯ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨æœåŠ¡ç«¯æ—¶ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡ç«¯çš„IPï¼Œç«¯å£ç­‰ä¿¡æ¯ï¼Œè€Œåœ¨æˆ‘ä»¬çš„ç¼–æ’ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬çš„IPæ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡æœåŠ¡çš„å‘ç°ï¼Œè‡ªå·±å»å‘ç°æœåŠ¡ç«¯çš„é…ç½®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‰æ&#34;&gt;å‰æ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.consul.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Consul&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Docker&lt;/li&gt;
&lt;li&gt;Golang&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡æ³¨å†Œ&#34;&gt;æœåŠ¡æ³¨å†Œ&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å®šä¹‰æœåŠ¡æ³¨å†Œçš„æ¥å£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;// Registry interface for extend
type Registry interface {
Register(id string, name string, port int, tags ...string) error
DeRegister(string) error
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœåŠ¡æ³¨å†Œä¸»è¦æœ‰ä¸¤ä¸ªæ¥å£ï¼Œä¸€ä¸ªç”¨äºæ³¨å†ŒæœåŠ¡çš„&lt;code&gt;Register&lt;/code&gt;ï¼Œä¸€ä¸ªç”¨äºå–æ¶ˆæ³¨å†Œçš„&lt;code&gt;DeRegister&lt;/code&gt;,å½“æˆ‘ä»¬æ³¨å†ŒæœåŠ¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æä¾›å½“å‰æœåŠ¡çš„IDï¼Œåç§°ï¼Œç«¯å£ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ³¨å†Œä¸­å¿ƒconsul&#34;&gt;æ³¨å†Œä¸­å¿ƒConsul&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬çš„æœåŠ¡æ³¨å†Œï¼Œæˆ‘åˆ™ä½¿ç”¨&lt;a href=&#34;https://www.consul.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Consul&lt;/a&gt;ä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œå¦‚æœä½ è¿˜ä¸çŸ¥é“ä»€ä¹ˆæ˜¯Consulï¼Œä½ å¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„åšå®¢[consulå­¦ä¹ ä¸€-åˆè§]()ä»¥åŠConsulçš„å®˜ç½‘è¿›è¡Œäº†è§£ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°Registryï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;type consul struct {
client *api.Client
addr string
}
// NewConsulRegistry returns a registryClient interface for given consul address
func NewConsulRegistry(c Config) (Registry, error) {
addr := fmt.Sprintf(&amp;quot;%s:%s&amp;quot;, c.Host, c.Port)
if addr == &amp;quot;&amp;quot; {
addr = &amp;quot;consul:8500&amp;quot;
}
cfg := api.DefaultConfig()
cfg.Address = addr
cl, err := api.NewClient(cfg)
if err != nil {
logrus.Errorf(&amp;quot;Can&#39;t connect to consul server at %s&amp;quot;, addr)
return nil, err
}
return consul{client: cl, addr: addr}, nil
}
func (r consul) Register(id string, name string, port int, tags ...string) error {
conn, err := net.Dial(&amp;quot;udp&amp;quot;, &amp;quot;8.8.8.8:80&amp;quot;)
if err != nil {
return fmt.Errorf(&amp;quot;unable to determine local addr: %v&amp;quot;, err)
}
defer conn.Close()
localAddr := conn.LocalAddr().(*net.UDPAddr)
asr := &amp;amp;api.AgentServiceRegistration{
ID: name,
Name: name,
Port: port,
EnableTagOverride: false,
Tags: tags,
Address: localAddr.IP.String(),
}
err = r.client.Agent().ServiceRegister(asr)
if err != nil {
logrus.Errorf(&amp;quot;Failed to register service at &#39;%s&#39;. error: %v&amp;quot;, r.addr, err)
} else {
logrus.Infof(&amp;quot;Regsitered service &#39;%s&#39; at consul.&amp;quot;, id)
}
return err
}
func (r consul) DeRegister(name string) error {
err := r.client.Agent().ServiceDeregister(name)
if err != nil {
logrus.Errorf(&amp;quot;Failed to deregister service by id: &#39;%s&#39;. Error: %v&amp;quot;, name, err)
} else {
logrus.Infof(&amp;quot;Deregistered service &#39;%s&#39; at consul.&amp;quot;, name)
}
return err
}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;å®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹&lt;a href=&#34;https://github.com/ycrxun/gf/tree/master/registry&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;gf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;æœåŠ¡å‘ç°&#34;&gt;æœåŠ¡å‘ç°&lt;/h2&gt;
&lt;p&gt;åŒæ ·ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¥å£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;// Discovery service
type Discovery interface {
Dial(name string, opts ...grpc.DialOption) (*grpc.ClientConn, error)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;åŸºäºconsulå‘ç°æœåŠ¡&#34;&gt;åŸºäºConsulå‘ç°æœåŠ¡&lt;/h3&gt;
&lt;p&gt;åŸºäºConsulå‘ç°æœåŠ¡å…¶å®ç®€å•ï¼Œå°±æ˜¯ä½¿ç”¨Consulæä¾›çš„APIï¼Œæˆ‘ä»¬å»æ³¨å†Œä¸­å¿ƒè¯»å–æœåŠ¡çš„ä¿¡æ¯ï¼ˆIPï¼Œportç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;// discovery provider
type discovery struct {
*api.Client
dialopts []grpc.DialOption
}
// NewConsulDiscovery returns discovery
func NewConsulDiscovery(cfg Config) (Discovery, error) {
config := api.DefaultConfig()
config.Address = fmt.Sprintf(&amp;quot;%s:%s&amp;quot;, cfg.Host, cfg.Port)
c, err := api.NewClient(config)
if err != nil {
return nil, err
}
opts := []grpc.DialOption{
grpc.WithInsecure(),
grpc.WithBlock(),
}
if cfg.Tracer != nil {
opts = append(opts, grpc.WithUnaryInterceptor(otgrpc.OpenTracingClientInterceptor(cfg.Tracer)))
opts = append(opts, grpc.WithStreamInterceptor(otgrpc.OpenTracingStreamClientInterceptor(cfg.Tracer)))
}
return discovery{c, opts}, nil
}
// Dial grpc server
func (c discovery) Dial(name string, opts ...grpc.DialOption) (*grpc.ClientConn, error) {
r, err := lb.NewResolver(c.Client, name, &amp;quot;&amp;quot;)
if err != nil {
return nil, fmt.Errorf(&amp;quot;Create balancer resolver for service %s failed. Error: %v&amp;quot;, name, err)
}
c.dialopts = append(c.dialopts, grpc.WithBalancer(grpc.RoundRobin(r)))
c.dialopts = append(c.dialopts, opts...)
conn, err := grpc.Dial(&amp;quot;&amp;quot;, c.dialopts...)
if err != nil {
return nil, fmt.Errorf(&amp;quot;Failed to dial %s: %v&amp;quot;, name, err)
}
return conn, nil
}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;å®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹&lt;a href=&#34;https://github.com/ycrxun/gf/tree/master/discovery&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;gf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä½¿ç”¨&#34;&gt;ä½¿ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;æ³¨å†Œä¸å–æ¶ˆæ³¨å†Œ&#34;&gt;æ³¨å†Œä¸å–æ¶ˆæ³¨å†Œ&lt;/h3&gt;
&lt;p&gt;æ ¹æ®ä¸Šç¯‡ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¯åŠ¨gRPC serverçš„æ—¶å€™ï¼ŒæŠŠæˆ‘ä»¬çš„æœåŠ¡æ³¨å†Œåˆ°Consulå³å¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;package cmd
import (
&amp;quot;github.com/ycrxun/add&amp;quot;
&amp;quot;github.com/ycrxun/add/server&amp;quot;
&amp;quot;github.com/ycrxun/gf/registry&amp;quot;
&amp;quot;github.com/sirupsen/logrus&amp;quot;
&amp;quot;github.com/spf13/cobra&amp;quot;
&amp;quot;google.golang.org/grpc&amp;quot;
&amp;quot;github.com/ycrxun/gf&amp;quot;
)
var serveCmd = &amp;amp;cobra.Command{
Use: &amp;quot;serve&amp;quot;,
Short: &amp;quot;Run the RPC server&amp;quot;,
Run: func(cmd *cobra.Command, args []string) {
logrus.Fatal(runServe())
},
}
func runServe() error {
r, err := registry.NewRegistry(registry.Config{
Provider: registry.Consul,
Host: &amp;quot;192.168.31.70&amp;quot;,
Port: &amp;quot;8500&amp;quot;,
})
if err != nil {
return err
}
s := gf.NewService(&amp;quot;add&amp;quot;)
s.GRPCImplementation(func(g *grpc.Server) {
add.RegisterAddServiceServer(g, server.AddServer{})
})
s.UseRegistry(r)
s.Run()
return nil
}
func init() {
rootCmd.AddCommand(serveCmd)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å‘ç°æœåŠ¡&#34;&gt;å‘ç°æœåŠ¡&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä¸Šé¢çš„ä»£ç æ”¹é€ ï¼Œæˆ‘ä»¬ä¼šåœ¨æœåŠ¡ç«¯å¯åŠ¨æ—¶æŠŠæœåŠ¡æ³¨å†Œåˆ°Consulï¼Œé‚£ä¹ˆåœ¨å®¢æˆ·ç«¯ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å»Consulå‘ç°æœåŠ¡å³å¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;package cmd
import (
&amp;quot;context&amp;quot;
&amp;quot;github.com/kataras/iris&amp;quot;
&amp;quot;github.com/sirupsen/logrus&amp;quot;
&amp;quot;github.com/spf13/cobra&amp;quot;
&amp;quot;github.com/ycrxun/add&amp;quot;
&amp;quot;github.com/ycrxun/gf/discovery&amp;quot;
)
var clientCmd = &amp;amp;cobra.Command{
Use: &amp;quot;client&amp;quot;,
Short: &amp;quot;Run the RPC client&amp;quot;,
Run: func(cmd *cobra.Command, args []string) {
logrus.Fatal(runClient())
},
}
func runClient() error {
// Define discovery
d, err := discovery.NewDiscovery(discovery.Config{
Provider: discovery.Consul,
Host: &amp;quot;192.168.31.70&amp;quot;,
Port: &amp;quot;8500&amp;quot;,
})
if err != nil {
return err
}
// discovery service via name.
cc, err := d.Dial(&amp;quot;add&amp;quot;)
if err != nil {
return err
}
cl := add.NewAddServiceClient(cc)
app := iris.New()
app.Get(&amp;quot;/:a/:b&amp;quot;, func(ctx iris.Context) {
a, _ := ctx.Params().GetInt64(&amp;quot;a&amp;quot;)
b, _ := ctx.Params().GetInt64(&amp;quot;b&amp;quot;)
c := context.Background()
rs, err := cl.Add(c, &amp;amp;add.AddRequest{A: uint64(a), B: uint64(b)})
if err != nil {
ctx.Text(err.Error())
return
}
ctx.JSON(rs)
})
return app.Run(iris.Addr(&amp;quot;:8100&amp;quot;))
}
func init() {
rootCmd.AddCommand(clientCmd)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¯åŠ¨&#34;&gt;å¯åŠ¨&lt;/h3&gt;
&lt;p&gt;ç¼–è¯‘å¹¶ä¾æ¬¡å¯åŠ¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ pwd
/home/soi/golang/src/github.com/ycrxun/add/add
$ go build
$ ./add serve
INFO[0000] add serve at 0.0.0.0:8000
INFO[0000] Regsitered service &#39;add&#39; at consul.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæˆ‘ä»¬æ‰“å¼€consulçš„æ§åˆ¶é¢æ¿ï¼Œå¯ä»¥çœ‹åˆ°æœåŠ¡å·²ç»æ³¨å†Œåˆ°ä¸Šé¢äº†
&lt;img src=&#34;https://ronggle.com/registry-microservies-via-grpc/consul.png&#34; alt=&#34;consul&#34; /&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨client&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ ./add client
Now listening on: http://localhost:8100
Application started. Press CTRL+C to shut down.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥&lt;code&gt;http://localhost:8100/1/1&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;{&amp;quot;result&amp;quot;:2}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>ä½¿ç”¨gRPCå¼€å‘å¾®æœåŠ¡-å¼€å§‹</title><link>https://ronggle.com/2018/setup-microservies-via-grpc/</link><pubDate>Sun, 12 Aug 2018 17:44:33 +0800</pubDate><guid>https://ronggle.com/2018/setup-microservies-via-grpc/</guid><description>&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯grpc&#34;&gt;ä»€ä¹ˆæ˜¯gRPC&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://grpc.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;gRPC&lt;/a&gt;æ˜¯ä¸€ä¸ªç°ä»£çš„å¼€æºé«˜æ€§èƒ½RPCæ¡†æ¶ï¼Œå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸­è¿è¡Œã€‚å®ƒå¯ä»¥æœ‰æ•ˆåœ°è¿æ¥æ•°æ®ä¸­å¿ƒå†…å’Œè·¨æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ï¼Œå¹¶æä¾›å¯æ’æ‹”çš„æ”¯æŒï¼Œä»¥å®ç°è´Ÿè½½å¹³è¡¡ï¼Œè·Ÿè¸ªï¼Œå¥åº·æ£€æŸ¥å’Œèº«ä»½éªŒè¯ã€‚å®ƒæ”¯æŒå¤šç§è¯­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;gRPCä½¿ç”¨&lt;a href=&#34;https://developers.google.com/protocol-buffers/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Protocol Buffers&lt;/a&gt;ä½œä¸ºIDLå®šä¹‰æœåŠ¡ï¼ŒProtocol Buffersæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„äºŒè¿›åˆ¶åºåˆ—åŒ–å·¥å…·é›†å’Œè¯­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/setup-microservies-via-grpc/grpc.svg&#34; alt=&#34;grpc.io&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¸»è¦ä½¿ç”¨åœºæ™¯&#34;&gt;ä¸»è¦ä½¿ç”¨åœºæ™¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨å¾®æœåŠ¡å¼æ¶æ„ä¸­æœ‰æ•ˆåœ°è¿æ¥å¤šè¯­è¨€æœåŠ¡&lt;/li&gt;
&lt;li&gt;å°†ç§»åŠ¨è®¾å¤‡ï¼Œæµè§ˆå™¨å®¢æˆ·ç«¯è¿æ¥åˆ°åç«¯æœåŠ¡&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆé«˜æ•ˆçš„å®¢æˆ·ç«¯åº“&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ ¸å¿ƒåŠŸèƒ½&#34;&gt;æ ¸å¿ƒåŠŸèƒ½&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;10ç§è¯­è¨€çš„å®¢æˆ·ç«¯åº“&lt;/li&gt;
&lt;li&gt;é«˜æ•ˆå’Œç®€å•çš„æœåŠ¡å®šä¹‰æ¡†æ¶&lt;/li&gt;
&lt;li&gt;åŸºäºhttp/2çš„ä¼ è¾“çš„åŒå‘æµ&lt;/li&gt;
&lt;li&gt;å¯æ’æ‹”èº«ä»½éªŒè¯ï¼Œè·Ÿè¸ªï¼Œè´Ÿè½½å¹³è¡¡å’Œå¥åº·æ£€æŸ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®‰è£…å’Œå‰æœŸå‡†å¤‡è¯·å‚é˜…å®˜æ–¹æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å‰ç½®æ¡ä»¶&#34;&gt;å‰ç½®æ¡ä»¶&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://developers.google.com/protocol-buffers/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Protocol Buffers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://golang.org/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Golang&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä¸€ä¸ªç®€å•çš„å¼€å§‹&#34;&gt;ä¸€ä¸ªç®€å•çš„å¼€å§‹&lt;/h2&gt;
&lt;h3 id=&#34;ä½¿ç”¨protocol-bufferså®šä¹‰æœåŠ¡&#34;&gt;ä½¿ç”¨Protocol Bufferså®šä¹‰æœåŠ¡&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-proto&#34;&gt;syntax = &amp;quot;proto3&amp;quot;;
package add;
message AddRequest {
uint64 a = 1;
uint64 b = 2;
}
message AddResponse {
uint64 result = 1;
}
service AddService {
rpc Add (AddRequest) returns (AddResponse) {}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é¡¹ç›®ç»“æ„&#34;&gt;é¡¹ç›®ç»“æ„&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;.
â”œâ”€â”€ add
â”‚Â Â  â”œâ”€â”€ cmd
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ client.go
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ root.go
â”‚Â Â  â”‚Â Â  â””â”€â”€ server.go
â”‚Â Â  â””â”€â”€ main.go
â”œâ”€â”€ add.pb.go
â”œâ”€â”€ add.proto
â””â”€â”€ server
â””â”€â”€ server.go
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ç”Ÿæˆä»£ç &#34;&gt;ç”Ÿæˆä»£ç &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ pwd
/home/soi/golang/src/github.com/ycrxun/add
$ protoc -I . add.proto --go_out=plugins=grpc:.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“æˆ‘ä»¬æ‰§è¡Œå®Œå‘½ä»¤åï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸Šç”Ÿæˆä¸€ä¸ª&lt;code&gt;add.pb.go&lt;/code&gt;æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬ä¸éœ€è¦å»åŠ¨ï¼Œä½†æ˜¯æˆ‘ä»¬ç”Ÿæˆçš„è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰æˆ‘ä»¬å®šä¹‰çš„AddServiceServerçš„æ¥å£ï¼Œéœ€è¦æˆ‘ä»¬å»å®ç°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;// AddServiceServer is the server API for AddService service.
type AddServiceServer interface {
Add(context.Context, *AddRequest) (*AddResponse, error)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å®ç°addserviceserver&#34;&gt;å®ç°AddServiceServer&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$Â pwd
/home/soi/golang/src/github.com/ycrxun/add
$ mkdir server
$ touch server/server.go
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶ååœ¨&lt;code&gt;server.go&lt;/code&gt;ä¸­å®šä¹‰ä¸€ä¸ªstruct&lt;code&gt;AddServer&lt;/code&gt;,å¹¶ä¸”å®ç°&lt;code&gt;AddServiceServer&lt;/code&gt;çš„&lt;code&gt;Add&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;package server
import (
&amp;quot;context&amp;quot;
&amp;quot;github.com/ycrxun/add&amp;quot;
)
// AddServer struct for AddService
type AddServer struct {
}
// Add method
func (a AddServer) Add(ctx context.Context, r *add.AddRequest) (*add.AddResponse, error) {
rs := r.A + r.B
s := add.AddResponse{
Result: uint64(rs),
}
return &amp;amp;s, nil
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ°æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å®Œæˆæˆ‘ä»¬çš„gRPCçš„serverã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ç°serverç«¯&#34;&gt;å®ç°Serverç«¯&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ pwd
/home/soi/golang/src/github.com/ycrxun/add/add
$ ls
cmd main.go
$ cat main.go
package main
import &amp;quot;github.com/ycrxun/add/add/cmd&amp;quot;
func main() {
cmd.Execute()
}
$ cat cmd/root.go
package cmd
import (
&amp;quot;fmt&amp;quot;
&amp;quot;os&amp;quot;
&amp;quot;github.com/spf13/cobra&amp;quot;
)
var rootCmd = &amp;amp;cobra.Command{
Use: &amp;quot;add&amp;quot;,
Short: &amp;quot;grpc add service simple.&amp;quot;,
}
// Execute cmd
func Execute() {
if err := rootCmd.Execute(); err != nil {
fmt.Println(err)
os.Exit(-1)
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºäº†åç»­çš„æ“ä½œï¼Œæˆ‘ä»¬æœ€å¥½æŒ‰ç…§è¿™ç§ç»“æ„å»å†™ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸è¿™ä¹ˆå†™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å»å®ç°æˆ‘ä»¬çš„gRPC Server&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;package cmd
import (
&amp;quot;net&amp;quot;
&amp;quot;github.com/ycrxun/add&amp;quot;
&amp;quot;github.com/ycrxun/add/server&amp;quot;
&amp;quot;github.com/sirupsen/logrus&amp;quot;
&amp;quot;github.com/spf13/cobra&amp;quot;
&amp;quot;google.golang.org/grpc&amp;quot;
)
var serveCmd = &amp;amp;cobra.Command{
Use: &amp;quot;serve&amp;quot;,
Short: &amp;quot;Run the RPC server&amp;quot;,
Run: func(cmd *cobra.Command, args []string) {
logrus.Fatal(runServe())
},
}
func runServe() error {
lis, err := net.Listen(&amp;quot;tcp&amp;quot;, &amp;quot;:8000&amp;quot;)
logrus.Infof(&amp;quot;add serve at %s&amp;quot;, &amp;quot;0.0.0.0:8000&amp;quot;)
if err != nil {
return err
}
s := grpc.NewServer()
add.RegisterAddServiceServer(s, &amp;amp;server.AddServer{})
return s.Serve(lis)
}
func init() {
rootCmd.AddCommand(serveCmd)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è‡³æ­¤ï¼Œæˆ‘ä»¬çš„gRPC serverä»¥åŠæˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘å°±å®Œæˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯ä¸æ˜¯å¾ˆé¸¡å†»å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ç¼–è¯‘å¹¶è¿è¡Œèµ·æ¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$Â pwd
/home/soi/golang/src/github.com/ycrxun/add/add
$ go build
$Â ls
add cmd main.go
$Â ./add serve
INFO[0000] add serve at 0.0.0.0:8000
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ç¼–å†™å®¢æˆ·ç«¯&#34;&gt;ç¼–å†™å®¢æˆ·ç«¯&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬å·²ç»ç¼–å†™å¹¶å®Œæˆäº†gRPC serveråŠå…¶ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªå®¢æˆ·ç«¯å»è°ƒç”¨æˆ‘ä»¬çš„æœåŠ¡ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨&lt;a href=&#34;https://iris-go.com/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;iris&lt;/a&gt;æ¥æ„å»ºä¸€ä¸ªHTTPçš„APIå¯¹å¤–æä¾›æœåŠ¡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-golang&#34;&gt;package cmd
import (
&amp;quot;context&amp;quot;
&amp;quot;github.com/kataras/iris&amp;quot;
&amp;quot;github.com/sirupsen/logrus&amp;quot;
&amp;quot;github.com/spf13/cobra&amp;quot;
&amp;quot;github.com/ycrxun/add&amp;quot;
&amp;quot;google.golang.org/grpc&amp;quot;
)
var clientCmd = &amp;amp;cobra.Command{
Use: &amp;quot;client&amp;quot;,
Short: &amp;quot;Run the RPC client&amp;quot;,
Run: func(cmd *cobra.Command, args []string) {
logrus.Fatal(runClient())
},
}
func runClient() error {
// å»ºç«‹ä¸€ä¸ªgrpcè¿æ¥
cc, err := grpc.Dial(&amp;quot;0.0.0.0:8000&amp;quot;, grpc.WithInsecure())
if err != nil {
return err
}
// åˆ›å»ºAddServiceçš„å®¢æˆ·ç«¯
cl := add.NewAddServiceClient(cc)
app := iris.New()
app.Get(&amp;quot;/:a/:b&amp;quot;, func(ctx iris.Context) {
a, _ := ctx.Params().GetInt64(&amp;quot;a&amp;quot;)
b, _ := ctx.Params().GetInt64(&amp;quot;b&amp;quot;)
c := context.Background()
rs, err := cl.Add(c, &amp;amp;add.AddRequest{A: uint64(a), B: uint64(b)})
if err != nil {
ctx.Text(err.Error())
return
}
ctx.JSON(rs)
})
return app.Run(iris.Addr(&amp;quot;:8100&amp;quot;))
}
func init() {
rootCmd.AddCommand(clientCmd)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ°æ­¤ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯ä¹Ÿå®Œæˆäº†ï¼Œæ¥ä¸‹æ¥ä¸ºä»¬é‡æ–°ç¼–è¯‘ä¸‹ï¼Œå¹¶ä¾æ¬¡å°†æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯å¯åŠ¨èµ·æ¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ pwd
/home/soi/golang/src/github.com/ycrxun/add/add
$ go build
$ ./add serve
INFO[0000] add serve at 0.0.0.0:8000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡æ–°å¼€ä¸€ä¸ªç»ˆç«¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ ./add client
Now listening on: http://localhost:8100
Application started. Press CTRL+C to shut down.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥&lt;code&gt;http://localhost:8100/1/1&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;{&amp;quot;result&amp;quot;:2}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>å¼€å¯Traefikçš„https</title><link>https://ronggle.com/2018/traefik-https/</link><pubDate>Thu, 26 Jul 2018 22:42:22 +0800</pubDate><guid>https://ronggle.com/2018/traefik-https/</guid><description>&lt;p&gt;åœ¨&lt;a href=&#34;https://ronggle.com/2018/05/cloud-labs/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;ä½¿ç”¨Dockeræ‰“é€ è‡ªå·±çš„äº‘å¹³å°&lt;/a&gt;ä¸­æˆ‘ä»¬æœ‰æåˆ°&lt;strong&gt;Traefik&lt;/strong&gt;ï¼Œå¹¶å¯¹å…¶è¿›è¡Œäº†ç®€å•çš„ä½¿ç”¨ï¼Œåé¢åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨httpsï¼Œæ‰€ä»¥ä¹Ÿå¯¹traefikè‡ªåŠ¨ä»&lt;a href=&#34;https://letsencrypt.org/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Let&amp;rsquo;s Encrypt&lt;/a&gt;è·å–è¯ä¹¦è¿›è¡Œäº†éªŒè¯ä¸ä½¿ç”¨ï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•ä¸‹éªŒè¯çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›®æ ‡&#34;&gt;ç›®æ ‡&lt;/h2&gt;
&lt;p&gt;å¼€å¯Traefikçš„httpsæœåŠ¡ã€‚
&lt;img src=&#34;https://ronggle.com/traefik-https/console.png&#34; alt=&#34;traefik console&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;å‰æœŸå‡†å¤‡&#34;&gt;å‰æœŸå‡†å¤‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://traefik.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Traefik&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.portainer.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Portainer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/compose/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Docker Compose&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/engine/swarm/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Docker Swarm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;traefik&#34;&gt;Traefik&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Traefik&lt;/strong&gt;äº‘åŸç”Ÿè¾¹ç¼˜è·¯ç”±å™¨,åå‘ä»£ç†/è´Ÿè½½å‡è¡¡å™¨ï¼Œç®€å•ï¼ŒåŠ¨æ€ï¼Œè‡ªåŠ¨ï¼Œå¿«é€Ÿï¼ŒåŠŸèƒ½é½å…¨ï¼Œå¼€æºï¼Œç»è¿‡ç”Ÿäº§éªŒè¯ï¼Œæä¾›æŒ‡æ ‡ï¼Œå¹¶ä¸å„ç§ä¸»è¦é›†ç¾¤æŠ€æœ¯é›†æˆ&amp;hellip;&amp;hellip;éš¾æ€ªå®ƒå¦‚æ­¤å—æ¬¢è¿ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/traefik-https/traefik-architecture.svg&#34; alt=&#34;æ¶æ„&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/traefik-https/web.frontend.png&#34; alt=&#34;WebUI&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/traefik-https/traefik-health.png&#34; alt=&#34;Health&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ–°å»ºstackç¼–æ’æ–‡ä»¶&#34;&gt;æ–°å»ºstackç¼–æ’æ–‡ä»¶&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;version: &amp;quot;3.4&amp;quot;
services:
server:
image: traefik:latest
command:
- &amp;quot;--api&amp;quot;
- &amp;quot;--api.dashboard&amp;quot;
- &amp;quot;--api.statistics&amp;quot;
- &amp;quot;--entrypoints=Name:http Address::80 Redirect.EntryPoint:https&amp;quot;
- &amp;quot;--entrypoints=Name:https Address::443 TLS&amp;quot;
- &amp;quot;--defaultentrypoints=http,https&amp;quot;
- &amp;quot;--acme&amp;quot;
- &amp;quot;--acme.storage=/acme.json&amp;quot;
- &amp;quot;--acme.entryPoint=https&amp;quot;
- &amp;quot;--acme.httpChallenge.entryPoint=http&amp;quot;
- &amp;quot;--acme.onHostRule=true&amp;quot;
- &amp;quot;--acme.onDemand=false&amp;quot;
- &amp;quot;--acme.email=example@mail.com&amp;quot;
- &amp;quot;--docker&amp;quot;
- &amp;quot;--docker.swarmMode&amp;quot;
- &amp;quot;--docker.domain=example.com&amp;quot;
- &amp;quot;--docker.watch&amp;quot;
ports:
- &amp;quot;80:80&amp;quot;
- &amp;quot;443:443&amp;quot;
networks:
- proxy
volumes:
- /var/run/docker.sock:/var/run/docker.sock
deploy:
placement:
constraints:
- node.role == manager
update_config:
parallelism: 1
delay: 10s
restart_policy:
condition: on-failure
labels:
- traefik.backend=traefik
- traefik.frontend.rule=Host:monitor.example.com
- traefik.docker.network=traefik_proxy
- traefik.port=8080
networks:
proxy:
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚ä¸Šï¼Œæˆ‘ä»¬å¼€å¯äº†traefikçš„&lt;code&gt;api&lt;/code&gt;ã€&lt;code&gt;docker&lt;/code&gt;ã€&lt;code&gt;docker swarm&lt;/code&gt;ã€&lt;code&gt;https&lt;/code&gt;ã€&lt;code&gt;è‡ªåŠ¨å‘Let&#39;s Encryptç”³è¯·è¯ä¹¦&lt;/code&gt;åŠŸèƒ½ï¼Œå¹¶ä¸”æŠŠå®ƒçš„&lt;code&gt;web&lt;/code&gt;åŠŸèƒ½æš´éœ²åˆ°&lt;code&gt;monitor.example.com&lt;/code&gt;ï¼Œå½“æˆ‘ä»¬éƒ¨ç½²å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨&lt;code&gt;https://monitor.example.com&lt;/code&gt;è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;éƒ¨ç½²traefik&#34;&gt;éƒ¨ç½²traefik&lt;/h3&gt;
&lt;p&gt;éƒ¨ç½²å…¶å®å¾ˆç®€å•ï¼Œä¸ºé‡‡ç”¨çš„stackæ¨¡å¼éƒ¨ç½²çš„traefikï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š
```bash
$ ls
traefik.yml&lt;/p&gt;
&lt;p&gt;$ sudo docker stack deploy -c traefik.yml traefik&lt;/p&gt;
&lt;p&gt;ç¨ç­‰ä¸€ä¼šå„¿å°±å¯ä»¥æŸ¥çœ‹åˆ°æˆ‘ä»¬å·²ç»å®Œæˆäº†traefikçš„éƒ¨ç½²ï¼Œå¹¶ä¸”ä½¿ç”¨traefikè‡ªåŠ¨å‘ç°Dockerä¸Šè¿è¡Œçš„åº”ç”¨æ—¶ï¼Œä»¥åŠæ˜¯httpsäº†ï¼ŒæŸ¥çœ‹è¯ä¹¦è¯¦æƒ…ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è¯ä¹¦ä½¿ç”¨çš„Let&amp;rsquo;s Encryptç”³è¯·ã€‚
&lt;img src=&#34;https://ronggle.com/traefik-https/lets-encrypt.png&#34; alt=&#34;è¯ä¹¦è¯¦æƒ…&#34; /&gt;&lt;/p&gt;</description></item><item><title>2Bå°å§å§</title><link>https://ronggle.com/2018/love-2b-miss/</link><pubDate>Thu, 17 May 2018 21:08:52 +0800</pubDate><guid>https://ronggle.com/2018/love-2b-miss/</guid><description>&lt;p&gt;2Bæ˜¯æ¸¸æˆã€Šå°¼å°”ï¼šæœºæ¢°çºªå…ƒã€‹ä¸­çš„å¯æ“ä½œè§’è‰²ï¼Œå…¨ç§°ï¼šãƒ¨ãƒ«ãƒ2å·Bå‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/love-2b-miss/1.jpg&#34; alt=&#34;1&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/2.jpg&#34; alt=&#34;2&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/3.jpg&#34; alt=&#34;3&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/4.jpg&#34; alt=&#34;4&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/5.jpg&#34; alt=&#34;5&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/6.jpg&#34; alt=&#34;6&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/7.jpg&#34; alt=&#34;7&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/8.jpg&#34; alt=&#34;8&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/9.jpg&#34; alt=&#34;9&#34; /&gt;
&lt;img src=&#34;https://ronggle.com/love-2b-miss/10.jpg&#34; alt=&#34;10&#34; /&gt;&lt;/p&gt;</description></item><item><title>ä½¿ç”¨Dockeræ‰“é€ è‡ªå·±çš„äº‘å¹³å°</title><link>https://ronggle.com/2018/cloud-labs/</link><pubDate>Sun, 13 May 2018 18:00:59 +0800</pubDate><guid>https://ronggle.com/2018/cloud-labs/</guid><description>&lt;p&gt;å¤±è¸ªäººå£å›å½’ï¼Œç»è¿‡å‡ ä¸ªæœˆçš„å¤±è¸ªï¼Œæˆ‘åˆç»ˆäºå›å½’æ­£è½¨äº†ï¼Œå‰é¢æ²¡æœ‰æ›´åšå®¢ï¼Œä¸»è¦åŸå› æ˜¯ï¼Œå› ä¸ºæˆ‘å®åœ¨æ˜¯å¤ªå¿™ï¼ˆæ‡’ï¼‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œæ—¢ç„¶å›å½’ï¼Œå½“ç„¶æ˜¯è¦æ‹¿å‡ºå¹²è´§å’¯ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¤©è¯´ç‚¹ä»€ä¹ˆå‘¢ï¼Ÿæ²‰å¯‚äº†è¿™ä¹ˆä¹…ï¼Œä¹Ÿä¸€ç›´åœ¨åšä¸Dockerç›¸å…³çš„å·¥ä½œä¸å­¦ä¹ ï¼Œå°±è®°å½•ä¸‹æœ€è¿‘çš„ä¸€äº›å†…å®¹ï¼Œä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢è‡ªå·±åˆå¿˜äº†ï¼Œæ¯æ¬¡éƒ½è¦å»æ‰¾å„ç§æ–‡æ¡£ï¼Œæ²¡æ³•å¿«é€Ÿå¤åˆ¶å‡ºä¸€ä»½è‡ªå·±ç©è¿‡çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›®æ ‡&#34;&gt;ç›®æ ‡&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨Dockeræ­å»ºä¸€ä¸ªè‡ªå·±çš„â€äº‘å¹³å°â€œï¼Œå¤§æ¦‚å°±æ˜¯ï¼Œå¯ä»¥åœ¨ä¸Šé¢éƒ¨ç½²åº”ç”¨ï¼Œå¹¶ä¸”è‡ªåŠ¨æš´éœ²å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/cloud-labs/monitor.png&#34; alt=&#34;traefik&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/cloud-labs/console.png&#34; alt=&#34;potainer&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/cloud-labs/console-services.png&#34; alt=&#34;potainer services&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;å‰æœŸå‡†å¤‡&#34;&gt;å‰æœŸå‡†å¤‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://traefik.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Traefik&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.portainer.io/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Portainer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/compose/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Docker Compose&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/engine/swarm/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Docker Swarm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šæ˜¯æˆ‘ä»¬éœ€è¦å‰æœŸå‡†å¤‡å¥½çš„ï¼ŒåŒ…æ‹¬å®ƒä»¬åˆ†åˆ«æ˜¯ä»€ä¹ˆã€æ€ä¹ˆå®‰è£…ã€æ€ä¹ˆä½¿ç”¨ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å› ä¸ºç¯‡å¹…é—®é¢˜ï¼Œåœ¨æ­¤ä¸ä¸€ä¸€è¯¦ç»†èŠ‚ä»‹ç»ï¼Œå¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¸Œæœ›ä½ èƒ½å¤Ÿè‡ªå·±é€šè¿‡æœç´¢å¼•æ“è‡ªè¡Œäº†è§£ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½ å¯ä»¥è”ç³»æˆ‘ã€‚&lt;/p&gt;
&lt;h2 id=&#34;traefik&#34;&gt;Traefik&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;TrÃ¦fÉªk&lt;/strong&gt; æ˜¯ä¸€ä¸ªä¸ºäº†è®©éƒ¨ç½²å¾®æœåŠ¡æ›´åŠ ä¾¿æ·è€Œè¯ç”Ÿçš„ç°ä»£HTTPåå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å·¥å…·ã€‚ å®ƒæ”¯æŒå¤šç§åå° (Docker, Swarm, Kubernetes, Marathon, Mesos, Consul, Etcd, Zookeeper, BoltDB, Rest API, fileâ€¦) æ¥è‡ªåŠ¨åŒ–ã€åŠ¨æ€çš„åº”ç”¨å®ƒçš„é…ç½®æ–‡ä»¶è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/cloud-labs/traefik.png&#34; alt=&#34;traefik&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨å®ƒä½œä»€ä¹ˆå‘¢ï¼Ÿæ²¡é”™ï¼Œåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ï¼ŒåŒæ—¶å› ä¸ºå…¶æä¾›äº†å¥½ç”¨çš„åŠ¨æ€åŠŸèƒ½ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨å®ƒé…ç½®åŸŸååŠ¨æ€çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆç†è§£å‘¢ï¼Ÿå‡è®¾æˆ‘ç°åœ¨æœ‰äº†ä¸€ä¸ªåŸŸå&lt;code&gt;cloud-labs.io&lt;/code&gt;ï¼Œç„¶åä¸ºä½¿ç”¨è¿™ä¸ªåŸŸåé…ç½®äº†ä¸€ä¸ªâ€œäº‘å¹³å°â€ï¼Œç„¶åä¸ºå¸Œæœ›æˆ‘åœ¨è¿™ä¸ªå¹³å°éƒ¨ç½²ä¸€ä¸ªåº”ç”¨&lt;code&gt;nina&lt;/code&gt;,éƒ¨ç½²å®Œæˆåï¼Œä¸ºå°±å¯ä»¥ä½¿ç”¨&lt;code&gt;nina.cloud-labs.io&lt;/code&gt;è¿›è¡Œè®¿é—®ï¼Œå¹¶ä¸åœ¨ä¹æˆ‘çš„è¿ç”¨è¢«å…·ä½“éƒ¨ç½²åˆ°å“ªé‡Œã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨äº†traefikï¼Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å°†åº”ç”¨ä½œä¸ºä¸€ä¸ª&lt;code&gt;backend&lt;/code&gt;æš´éœ²ç»™traefikå³å¯ã€‚å¦‚æœç»“åˆDockerä½¿ç”¨ï¼Œä¸ºä»¬åªéœ€è¦åœ¨Labelä¸ŠåŠ ä¸Šå¯¹åº”çš„é…ç½®å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¥éƒ¨ç½²traefikå§ï¼&lt;/p&gt;
&lt;p&gt;å‰ææ¡ä»¶ï¼Œä½ å·²ç»å®‰è£…å·Dockerä»¥åŠåˆå§‹åŒ–å®ŒæˆDocker Swarmï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åªä½¿ç”¨Dockeræ¨¡å¼ï¼Œä½ å¯ä»¥å‚è€ƒtraefikçš„&lt;a href=&#34;https://docs.traefik.io/configuration/backends/docker/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ–°å»ºstackç¼–æ’æ–‡ä»¶&#34;&gt;æ–°å»ºstackç¼–æ’æ–‡ä»¶&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;version: &#39;3.3&#39;
services:
proxy:
image: traefik
command: --web --docker --docker.domain=cloud-labs.io --docker.watch --docker.swarmmode=true --logLevel=DEBUG
deploy:
labels:
- traefik.backend=traefik
- traefik.frontend.rule=Host:monitor.cloud-labs.io
- traefik.port=8080
- traefik.docker.network=traefik_proxy
networks:
- proxy
ports:
- &amp;quot;80:80&amp;quot;
- &amp;quot;443:443&amp;quot;
volumes:
- /var/run/docker.sock:/var/run/docker.sock
- /dev/null:/traefik.toml
networks:
proxy
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚ä¸Šï¼Œæˆ‘ä»¬å¼€å¯äº†traefikçš„&lt;code&gt;web&lt;/code&gt;ã€&lt;code&gt;docker&lt;/code&gt;ã€&lt;code&gt;docker swarm&lt;/code&gt;åŠŸèƒ½ï¼Œå¹¶ä¸”æŠŠå®ƒçš„&lt;code&gt;web&lt;/code&gt;åŠŸèƒ½æš´éœ²åˆ°&lt;code&gt;monitor.cloud-labs.io&lt;/code&gt;ï¼Œå½“æˆ‘ä»¬éƒ¨ç½²å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨&lt;code&gt;monitor.cloud-labs.io&lt;/code&gt;è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;éƒ¨ç½²traefik&#34;&gt;éƒ¨ç½²traefik&lt;/h3&gt;
&lt;p&gt;éƒ¨ç½²å…¶å®å¾ˆç®€å•ï¼Œä¸ºé‡‡ç”¨çš„stackæ¨¡å¼éƒ¨ç½²çš„traefikï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ ls
traefik.yml
$ docker stack deploy -c traefik.yml traefik
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¨ç­‰ä¸€ä¼šå„¿ï¼Œå°±å¯ä»¥åœ¨ä½¿ç”¨&lt;code&gt;monitor.cloud-labs.io&lt;/code&gt;è®¿é—®äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ç„¶ï¼Œ&lt;code&gt;monitor.cloud-labs.io&lt;/code&gt;æ˜¯ä¸€ä¸ªå‡å®šçš„åŸŸåï¼Œéœ€è¦åœ¨ä½ çš„hostæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚
$ cat /etc/hosts
127.0.0.1 monitor.cloud-labs.io&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;portainer&#34;&gt;Portainer&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Portainer&lt;/strong&gt;æ˜¯ä¸€ä¸ªè½»é‡çº§ç®¡ç†ç”¨æˆ·ç•Œé¢ï¼Œå¯è®©ä½ è½»æ¾ç®¡ç†ä¸åŒçš„Dockerç¯å¢ƒï¼ˆDockerä¸»æœºæˆ–Swarmé›†ç¾¤ï¼‰ã€‚å…¶ä½¿ç”¨ä¸éƒ¨ç½²ä¸€æ ·ç®€å•ï¼Œå®ƒåŒ…å«ä¸€ä¸ªå¯ä»¥åœ¨ä»»ä½•Dockerå¼•æ“ä¸Šè¿è¡Œçš„å®¹å™¨ï¼ˆå¯ä»¥ä½œä¸ºLinuxå®¹å™¨æˆ–Windowsæœ¬æœºå®¹å™¨éƒ¨ç½²ï¼‰ã€‚å¹¶å…è®¸ä½ ç®¡ç†Dockerå®¹å™¨ï¼Œå›¾åƒï¼Œå·ï¼Œç½‘ç»œç­‰ç­‰ï¼å®ƒä¸ç‹¬ç«‹çš„Dockerå¼•æ“å’ŒDocker Swarmæ¨¡å¼å…¼å®¹ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚å®ƒçš„ä»‹ç»é‚£èˆ¬ï¼Œä¸ºä»¬å¯ä»¥ä½¿ç”¨å®ƒä½œä¸ºæˆ‘ä»¬çš„â€œäº‘å¹³å°â€çš„æ§åˆ¶å°ï¼Œæ¥ä½œä¸ºæˆ‘ä»¬å¹³æ—¶çš„åº”ç”¨éƒ¨ç½²ã€ç®¡ç†ã€é…ç½®çš„WebUIï¼Œè®©æˆ‘ä»¬çš„æ“ä½œæ›´åŠ äººæ€§åŒ–ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ–°å»ºstackç¼–æ’æ–‡ä»¶-1&#34;&gt;æ–°å»ºstackç¼–æ’æ–‡ä»¶&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;version: &#39;3.3&#39;
services:
server:
image: portainer/portainer
command: -H unix:///var/run/docker.sock
networks:
- traefik_proxy
deploy:
labels:
- traefik.backend=portainer
- traefik.frontend.rule=Host:console.cloud-labs.io
- traefik.docker.network=traefik_proxy
- traefik.port=9000
volumes:
- /var/run/docker.sock:/var/run/docker.sock
- portainer:/data
networks:
traefik_proxy:
external: true
volumes:
portainer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚ä¸Šï¼Œä¸ºä»¬å°†ä¼šæŠŠPortaineréƒ¨ç½²åˆ°Dockerç¯å¢ƒä¸­ï¼ŒåŒæ—¶å°†å…¶æš´éœ²åˆ°äº†traefikä¸­ï¼Œä½¿ç”¨&lt;code&gt;console.cloud-labs.io&lt;/code&gt;è¿›è¡Œè®¿é—®ã€‚åœ¨è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šå‘ç°ï¼Œä¸ºä»¬å¹¶æ²¡æœ‰ä¸ºportaineré…ç½®æš´éœ²çš„ç«¯å£ï¼Œè¿™ä¹Ÿæ˜¯å› ä¸ºtraefikç»™æˆ‘ä»¬å¸¦æ¥çš„ä¸€ä¸ªå¥½å¤„ï¼Œä¾¿æ˜¯ä¸ºä»¬ä¸éœ€è¦åœ¨æˆ‘ä»¬çš„ç‰©ç†æœºä¸Šå¼€å¯é‚£ä¹ˆå¤šçš„ç«¯å£æ˜ å°„ï¼Œä¸ºä»¬çŸ¥é“ï¼Œå¦‚æœç«¯å£æ˜ å°„è¿‡å¤šæ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨éš¾ä»¥ç®¡ç†ã€æ„ŸçŸ¥ï¼Œå¾€å¾€ä¼šå‡ºç°ç«¯å£å·²ç»ä½¿ç”¨çš„æƒ…å†µä¸‹å¯¼è‡´éƒ¨ç½²å¤±è´¥ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬çš„Portainerçš„ç½‘ç»œè®¾ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;&amp;gt; networks:
&amp;gt; traefik_proxy:
&amp;gt; external: true
&amp;gt; ```
&amp;gt; æ˜¯çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯traefikçš„ç½‘ç»œï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿè¢«traefikå‘ç°ï¼Œå¹¶ä½œåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ã€‚
### éƒ¨ç½²Portainer
éƒ¨ç½²Portainerä¹Ÿå¾ˆç®€å•ï¼Œä¸ºä»¬ä½¿ç”¨stackè¿›è¡Œéƒ¨ç½²ï¼š
```bash
$ ls
portainer.yml
$ docker stack deploy -c portainer.yml portainer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¨ç­‰ä¸€ä¼šå„¿ï¼Œå°±å¯ä»¥åœ¨ä½¿ç”¨&lt;code&gt;monitor.cloud-labs.io&lt;/code&gt;ä¸­å‘ç°æˆ‘ä»¬çš„åº”ç”¨ä»¥åŠéƒ¨ç½²å¥½äº†ï¼Œå¹¶ä¸”è¢«æš´éœ²åœ¨&lt;code&gt;console.cloud-labs.io&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/cloud-labs/monitor-portainer.png&#34; alt=&#34;traefik monitor portainer&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åŒæ ·çš„ï¼Œ&lt;code&gt;console.cloud-labs.io&lt;/code&gt;æ˜¯ä¸€ä¸ªå‡å®šçš„åŸŸåï¼Œéœ€è¦åœ¨ä½ çš„hostæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚
$ cat /etc/hosts
127.0.0.1 console.cloud-labs.io&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;éƒ¨ç½²è¿ç”¨&#34;&gt;éƒ¨ç½²è¿ç”¨&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢ï¼Œæˆ‘ä»¬å·²ç»æŠŠæˆ‘ä»¬â€œäº‘å¹³å°â€çš„åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ç»„ä»¶traefikï¼Œä»¥åŠæ§åˆ¶å°portaineréƒ¨ç½²å®Œæ¯•ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±ä½¿ç”¨æˆ‘ä»¬çš„â€œäº‘å¹³å°â€æ¥éƒ¨ç½²ä¸€ä¸ªåº”ç”¨å§ï¼&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥éƒ¨ç½²ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„åº”ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç™»å…¥æ§åˆ¶å°&#34;&gt;ç™»å…¥æ§åˆ¶å°&lt;/h3&gt;
&lt;p&gt;ç™»é™†æˆ‘ä»¬â€œäº‘å¹³å°â€çš„æ§åˆ¶å°åï¼Œé€‰æ‹©stackï¼Œä¸ºä»¬æ¥ç¼–æ’ä¸€ä¸‹æˆ‘ä»¬çš„åº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/cloud-labs/portainer-stack-gitea.png&#34; alt=&#34;portainer stack gitea&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;è¿›å…¥traefik&#34;&gt;è¿›å…¥Traefik&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬åœ¨æ§åˆ¶å°éƒ¨ç½²å®Œæˆæˆ‘ä»¬çš„giteaåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Traefikçš„WebUIä¸­çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„giteaå·²ç»éƒ¨ç½²å®Œæˆï¼Œå¹¶æš´éœ²åœ¨&lt;code&gt;git.cloud-labs.io&lt;/code&gt;ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥è®¿é—®&lt;code&gt;git.cloud-labs.io&lt;/code&gt;æ¥è¿›è¡Œgiteaçš„é…ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åº”ç”¨é¢„è§ˆ&#34;&gt;åº”ç”¨é¢„è§ˆ&lt;/h3&gt;
&lt;p&gt;é…ç½®å®Œæˆgiteaåæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/cloud-labs/gitea.png&#34; alt=&#34;gitea&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;é€šè¿‡è¿™æ¬¡å®æˆ˜ï¼Œä½ æ˜¯å¦æœ‰æ”¶è·å‘¢ï¼Ÿå¦‚æœæœ‰ï¼Œè¯·ä¸ºè‡ªå·±é¼“æŒï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£ä½ ä¹Ÿåˆ«è´£æ€ªæˆ‘ï¼Œå› ä¸ºæˆ‘å…¶å®çœŸçš„æ˜¯ä¸ºäº†è®©è‡ªå·±è®°ä½ã€‚&lt;/p&gt;
&lt;p&gt;å¥½å§ï¼Œæˆ‘ä¼šæŠŠæœ€åçš„æ–‡ä»¶æ•´ç†ä¸‹ï¼Œæ”¾åˆ°æˆ‘çš„Githubä¸Šï¼Œä»“åº“ä¸º&lt;a href=&#34;https://github.com/ycrxun/cloud-labs&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;cloud-labs&lt;/a&gt;ã€‚&lt;/p&gt;</description></item><item><title>consulå­¦ä¹ äºŒ-é›†ç¾¤</title><link>https://ronggle.com/2018/consul-cluster/</link><pubDate>Mon, 15 Jan 2018 21:42:19 +0800</pubDate><guid>https://ronggle.com/2018/consul-cluster/</guid><description>&lt;p&gt;åœ¨å‰é¢æˆ‘ä»¬å·²ç»ä»‹ç»äº†&lt;a href=&#34;https://ronggle.com/2018/01/07/consul-first-time/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;ä»€ä¹ˆæ˜¯Consul&lt;/a&gt;ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸‹æ€ä¹ˆæ­å»ºä¸€ä¸ªé›†ç¾¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¯å¢ƒå‡†å¤‡&#34;&gt;ç¯å¢ƒå‡†å¤‡&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;èŠ‚ç‚¹åç§°&lt;/th&gt;
&lt;th&gt;ip&lt;/th&gt;
&lt;th&gt;è§’è‰²&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ams1&lt;/td&gt;
&lt;td&gt;192.168.42.33&lt;/td&gt;
&lt;td&gt;leader&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ams2&lt;/td&gt;
&lt;td&gt;192.168.42.198&lt;/td&gt;
&lt;td&gt;server&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ams3&lt;/td&gt;
&lt;td&gt;192.168.42.85&lt;/td&gt;
&lt;td&gt;server&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ams4&lt;/td&gt;
&lt;td&gt;192.168.42.252&lt;/td&gt;
&lt;td&gt;client&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;å®‰è£…å¹¶é…ç½®&#34;&gt;å®‰è£…å¹¶é…ç½®&lt;/h2&gt;
&lt;h3 id=&#34;å®‰è£…&#34;&gt;å®‰è£…&lt;/h3&gt;
&lt;p&gt;åˆ†åˆ«åœ¨4ä¸ªèŠ‚ç‚¹å®‰è£…&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ wget https://releases.hashicorp.com/consul/1.0.2/consul_1.0.2_linux_amd64.zip
$ unzip onsul_1.0.2_linux_amd64.zip -d /usr/bin
$ consul version
Consul v1.0.2
Protocol 2 spoken by default, understands 2 to 3 (agent will automatically use protocol &amp;gt;2 when speaking to compatible agents)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Consulå®‰è£…ä¹‹åï¼Œè¿è¡ŒAgentã€‚
Agentå¯ä»¥åœ¨serveræˆ–clientæ¨¡å¼ä¸‹è¿è¡Œã€‚æ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªè¿è¡Œäºserveï¼Œä½†æ¨èä½¿ç”¨3å°æˆ–5å°æœåŠ¡å™¨ã€‚
&lt;img src=&#34;https://ronggle.com/consul-cluster/consul-cluster.svg&#34; alt=&#34;consul cluster&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¯åŠ¨leader&#34;&gt;å¯åŠ¨leader&lt;/h3&gt;
&lt;h4 id=&#34;åˆ›å»ºé…ç½®æ–‡ä»¶&#34;&gt;åˆ›å»ºé…ç½®æ–‡ä»¶&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# cat /etc/consul.d/server.json
{
&amp;quot;datacenter&amp;quot;: &amp;quot;ams&amp;quot;,
&amp;quot;data_dir&amp;quot;: &amp;quot;/data/consul&amp;quot;,
&amp;quot;node_name&amp;quot;: &amp;quot;consul-leader&amp;quot;,
&amp;quot;server&amp;quot;: true,
&amp;quot;ui&amp;quot;: true,
&amp;quot;bootstrap_expect&amp;quot;: 1,
&amp;quot;client_addr&amp;quot;: &amp;quot;0.0.0.0&amp;quot;,
&amp;quot;advertise_addr&amp;quot;: &amp;quot;192.168.42.33&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;æ•°æ®ç›®å½•&#34;&gt;æ•°æ®ç›®å½•&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# mkdir -p /data/consul
# mkdir -p /data/consul/log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¯åŠ¨&#34;&gt;å¯åŠ¨&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;nohup consul agent -config-dir /etc/consul.d &amp;gt; /data/consul/log/server.log 2&amp;gt;&amp;amp;1 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¯åŠ¨server1&#34;&gt;å¯åŠ¨server1&lt;/h3&gt;
&lt;h4 id=&#34;åˆ›å»ºé…ç½®æ–‡ä»¶-1&#34;&gt;åˆ›å»ºé…ç½®æ–‡ä»¶&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# cat /etc/consul.d/server.json
{
&amp;quot;datacenter&amp;quot;: &amp;quot;ams&amp;quot;,
&amp;quot;data_dir&amp;quot;: &amp;quot;/data/consul&amp;quot;,
&amp;quot;node_name&amp;quot;: &amp;quot;consul-server1&amp;quot;,
&amp;quot;server&amp;quot;: true,
&amp;quot;ui&amp;quot;: true,
&amp;quot;client_addr&amp;quot;: &amp;quot;0.0.0.0&amp;quot;,
&amp;quot;advertise_addr&amp;quot;: &amp;quot;192.168.42.198&amp;quot;,
&amp;quot;retry_join&amp;quot;: [&amp;quot;192.168.42.33&amp;quot;]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;æ•°æ®ç›®å½•-1&#34;&gt;æ•°æ®ç›®å½•&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# mkdir -p /data/consul
# mkdir -p /data/consul/log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¯åŠ¨-1&#34;&gt;å¯åŠ¨&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;nohup consul agent -config-dir /etc/consul.d &amp;gt; /data/consul/log/server.log 2&amp;gt;&amp;amp;1 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¯åŠ¨server2&#34;&gt;å¯åŠ¨server2&lt;/h3&gt;
&lt;h4 id=&#34;åˆ›å»ºé…ç½®æ–‡ä»¶-2&#34;&gt;åˆ›å»ºé…ç½®æ–‡ä»¶&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# cat /etc/consul.d/server.json
{
&amp;quot;datacenter&amp;quot;: &amp;quot;ams&amp;quot;,
&amp;quot;data_dir&amp;quot;: &amp;quot;/data/consul&amp;quot;,
&amp;quot;node_name&amp;quot;: &amp;quot;consul-server2&amp;quot;,
&amp;quot;server&amp;quot;: true,
&amp;quot;ui&amp;quot;: true,
&amp;quot;client_addr&amp;quot;: &amp;quot;0.0.0.0&amp;quot;,
&amp;quot;advertise_addr&amp;quot;: &amp;quot;192.168.42.85&amp;quot;,
&amp;quot;retry_join&amp;quot;: [&amp;quot;192.168.42.33&amp;quot;]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;æ•°æ®ç›®å½•-2&#34;&gt;æ•°æ®ç›®å½•&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# mkdir -p /data/consul
# mkdir -p /data/consul/log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¯åŠ¨-2&#34;&gt;å¯åŠ¨&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;nohup consul agent -config-dir /etc/consul.d &amp;gt; /data/consul/log/server.log 2&amp;gt;&amp;amp;1 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¯åŠ¨client&#34;&gt;å¯åŠ¨client&lt;/h3&gt;
&lt;h4 id=&#34;åˆ›å»ºé…ç½®æ–‡ä»¶-3&#34;&gt;åˆ›å»ºé…ç½®æ–‡ä»¶&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# cat /etc/consul.d/server.json
{
&amp;quot;datacenter&amp;quot;: &amp;quot;ams&amp;quot;,
&amp;quot;data_dir&amp;quot;: &amp;quot;/data/consul&amp;quot;,
&amp;quot;node_name&amp;quot;: &amp;quot;consul-client&amp;quot;,
&amp;quot;server&amp;quot;: true,
&amp;quot;client_addr&amp;quot;: &amp;quot;0.0.0.0&amp;quot;,
&amp;quot;advertise_addr&amp;quot;: &amp;quot;192.168.42.252&amp;quot;,
&amp;quot;retry_join&amp;quot;: [&amp;quot;192.168.42.33&amp;quot;]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;æ•°æ®ç›®å½•-3&#34;&gt;æ•°æ®ç›®å½•&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# mkdir -p /data/consul
# mkdir -p /data/consul/log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¯åŠ¨-3&#34;&gt;å¯åŠ¨&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;nohup consul agent -config-dir /etc/consul.d &amp;gt; /data/consul/log/server.log 2&amp;gt;&amp;amp;1 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;éªŒè¯å®‰è£…&#34;&gt;éªŒè¯å®‰è£…&lt;/h2&gt;
&lt;p&gt;åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€&lt;a href=&#34;http://192.168.42.33:8500&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;http://192.168.42.33:8500&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/consul-cluster/consul-cluster-ui.png&#34; alt=&#34;consul cluster ui&#34; /&gt;&lt;/p&gt;</description></item><item><title>consulå­¦ä¹ ä¸€-åˆè§</title><link>https://ronggle.com/2018/consul-first-time/</link><pubDate>Sun, 07 Jan 2018 19:38:00 +0800</pubDate><guid>https://ronggle.com/2018/consul-first-time/</guid><description>&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://www.consul.io&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Consul&lt;/a&gt;&lt;/strong&gt;æ˜¯HashiCorpå…¬å¸æ¨å‡ºçš„ä¸€æ¬¾å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡å‘ç°ä¸é…ç½®&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯consul&#34;&gt;ä»€ä¹ˆæ˜¯Consul&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://www.consul.io&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Consul&lt;/a&gt;&lt;/strong&gt;æ˜¯HashiCorpå…¬å¸æ¨å‡ºçš„ä¸€æ¬¾å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡å‘ç°ä¸é…ç½®ã€‚å®ƒæä¾›äº†å‡ ä¸ªå…³é”®åŠŸèƒ½ï¼š
- æœåŠ¡å‘ç°ï¼šConsulçš„å®¢æˆ·ç«¯å¯ä»¥ä¸ºä¸€äº›å®¢æˆ·ç«¯å‘ç°ç»™å®šæœåŠ¡çš„æä¾›è€…ï¼Œè¯¸å¦‚apiæˆ–mysqlä¹‹ç±»çš„æœåŠ¡ï¼Œé€šè¿‡ä½¿ç”¨DNSæˆ–HTTPï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰¾åˆ°å®ƒä»¬æ‰€ä¾èµ–çš„æœåŠ¡ã€‚
- å¥åº·æ£€æŸ¥ï¼šConsulçš„å®¢æˆ·ç«¯å¯ä»¥æä¾›ä»»ä½•æ•°é‡çš„å¥åº·æ£€æŸ¥ï¼Œæˆ–è€…ä¸ç»™å®šçš„æœåŠ¡ï¼ˆâ€œæ˜¯WebæœåŠ¡å™¨è¿”å›200 OKâ€ï¼‰ï¼Œæˆ–ä¸æœ¬åœ°èŠ‚ç‚¹ï¼ˆâ€œå†…å­˜åˆ©ç”¨ç‡ä½äº90ï¼…â€ï¼‰ç›¸å…³è”ã€‚æ“ä½œå‘˜å¯ä»¥ä½¿ç”¨æ­¤ä¿¡æ¯æ¥ç›‘è§†ç¾¤é›†è¿è¡ŒçŠ¶å†µï¼ŒæœåŠ¡å‘ç°ç»„ä»¶ä½¿ç”¨æ­¤ä¿¡æ¯å°†æµé‡ä»ä¸å¥åº·çš„ä¸»æœºä¸­å¼•å¯¼å‡ºå»ã€‚
- KVå­˜å‚¨ï¼šåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨Consulçš„åˆ†å±‚é”®/å€¼å­˜å‚¨ï¼Œç”¨äºä»»ä½•ç›®çš„ï¼ŒåŒ…æ‹¬åŠ¨æ€é…ç½®ï¼ŒåŠŸèƒ½æ ‡è®°ï¼Œåè°ƒï¼Œé¢†å¯¼é€‰ä¸¾ç­‰ç­‰ã€‚ç®€å•çš„HTTP APIä½¿å…¶æ˜“äºä½¿ç”¨ã€‚
- å¤šæ•°æ®ä¸­å¿ƒï¼šConsulæ”¯æŒå¤šä¸ªæ•°æ®ä¸­å¿ƒã€‚è¿™æ„å‘³ç€Consulçš„ç”¨æˆ·ä¸å¿…æ‹…å¿ƒæ„å»ºé¢å¤–çš„æŠ½è±¡å±‚ä»¥æ‰©å±•åˆ°å¤šä¸ªåŒºåŸŸã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸºæœ¬æ¶æ„&#34;&gt;åŸºæœ¬æ¶æ„&lt;/h2&gt;
&lt;p&gt;Consulæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ï¼Œé«˜åº¦å¯ç”¨çš„ç³»ç»Ÿã€‚
&lt;img src=&#34;https://www.consul.io/assets/images/consul-arch-420ce04a.png&#34; alt=&#34;consul&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å‘Consulæä¾›æœåŠ¡çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œä¸€ä¸ªConsulä»£ç†ã€‚ å‘ç°å…¶ä»–æœåŠ¡æˆ–è·å–/è®¾ç½®é”®/å€¼æ•°æ®ä¸éœ€è¦è¿è¡Œä»£ç†ã€‚ ä»£ç†è´Ÿè´£å¥åº·æ£€æŸ¥èŠ‚ç‚¹ä¸Šçš„æœåŠ¡ä»¥åŠèŠ‚ç‚¹æœ¬èº«ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç†ä¸ä¸€ä¸ªæˆ–å¤šä¸ªConsulæœåŠ¡å™¨é€šè®¯ã€‚ ConsulæœåŠ¡å™¨æ˜¯æ•°æ®å­˜å‚¨å’Œå¤åˆ¶çš„åœ°æ–¹ã€‚ æœåŠ¡å™¨è‡ªå·±é€‰å‡ºä¸€ä½é¢†å¯¼ã€‚ è™½ç„¶Consulå¯ä»¥åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä½†æ¨èä½¿ç”¨3åˆ°5æ¥é¿å…å¯¼è‡´æ•°æ®ä¸¢å¤±çš„æ•…éšœæƒ…å†µã€‚ æ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½å»ºè®®ä½¿ç”¨ä¸€ç»„ConsulæœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦å‘ç°å…¶ä»–æœåŠ¡æˆ–èŠ‚ç‚¹çš„åŸºç¡€æ¶æ„ç»„ä»¶å¯ä»¥æŸ¥è¯¢ä»»ä½•ConsulæœåŠ¡å™¨æˆ–ä»»ä½•Consulä»£ç†ã€‚ ä»£ç†è‡ªåŠ¨å°†æŸ¥è¯¢è½¬å‘åˆ°æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½è¿è¡ŒConsulæœåŠ¡å™¨é›†ç¾¤ã€‚ å½“å‘ç”Ÿè·¨æ•°æ®ä¸­å¿ƒæœåŠ¡å‘ç°æˆ–é…ç½®è¯·æ±‚æ—¶ï¼Œæœ¬åœ°ConsulæœåŠ¡å™¨å°†è¯·æ±‚è½¬å‘ç»™è¿œç¨‹æ•°æ®ä¸­å¿ƒå¹¶è¿”å›ç»“æœã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç®€å•ä½¿ç”¨&#34;&gt;ç®€å•ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;consulçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œå…¶é‡‡ç”¨Goè¯­è¨€ç¼–å†™ï¼Œç¼–è¯‘å‡ºçš„æ–‡ä»¶æ— å…¶ä»–ä¾èµ–ã€‚å› æ­¤åªéœ€è¦ä»å®˜æ–¹ä¸‹è½½å¯¹åº”å¹³å°çš„ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶å¯æ‰§è¡Œç¨‹åºç›´æ¥è¿è¡Œå°±å¯ä»¥äº†ï¼Œä¸‹è½½åœ°å€&lt;a href=&#34;https://www.consul.io/downloads.html&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;https://www.consul.io/downloads.html&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;å®‰è£…&#34;&gt;å®‰è£…&lt;/h3&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨çš„Linuxç³»ç»Ÿï¼Œæ‰€ä»¥å®‰è£…å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;curl -O https://releases.hashicorp.com/consul/1.0.2/consul_1.0.2_linux_amd64.zip &amp;amp;&amp;amp; sudo unzip consul_1.0.2_linux_amd64.zip -d /usr/local/bin/
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ consul
Usage: consul [--version] [--help] &amp;lt;command&amp;gt; [&amp;lt;args&amp;gt;]
Available commands are:
agent Runs a Consul agent
catalog Interact with the catalog
event Fire a new event
exec Executes a command on Consul nodes
force-leave Forces a member of the cluster to enter the &amp;quot;left&amp;quot; state
info Provides debugging information for operators.
join Tell Consul agent to join cluster
keygen Generates a new encryption key
keyring Manages gossip layer encryption keys
kv Interact with the key-value store
leave Gracefully leaves the Consul cluster and shuts down
lock Execute a command holding a lock
maint Controls node or service maintenance mode
members Lists the members of a Consul cluster
monitor Stream logs from a Consul agent
operator Provides cluster-level tools for Consul operators
reload Triggers the agent to reload configuration files
rtt Estimates network round trip time between nodes
snapshot Saves, restores and inspects snapshots of Consul server state
validate Validate config files/directories
version Prints the Consul version
watch Watch for changes in Consul
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¯åŠ¨&#34;&gt;å¯åŠ¨&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†æš‚æ—¶åœ¨å¼€å‘è€…æ¨¡å¼ä¸­å¯åŠ¨Consulä»£ç†ã€‚è¿™ä¸ªæ¨¡å¼å¯ä»¥éå¸¸å®¹æ˜“å¿«é€Ÿåœ°å¯åŠ¨ä¸€ä¸ªå•èŠ‚ç‚¹çš„Consulç¯å¢ƒã€‚å½“ç„¶å®ƒå¹¶ä¸æ˜¯ç”¨äºç”Ÿäº§ç¯å¢ƒä¸‹å¹¶ä¸”å®ƒä¹Ÿä¸ä¼šæŒä¹…ä»»ä½•çŠ¶æ€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ consul agent -dev
==&amp;gt; Starting Consul agent...
==&amp;gt; Consul agent running!
Version: &#39;v1.0.2&#39;
Node ID: &#39;14f11e8d-4904-3fcd-1cd5-251c311cf775&#39;
Node name: &#39;master.soi.io&#39;
Datacenter: &#39;dc1&#39; (Segment: &#39;&amp;lt;all&amp;gt;&#39;)
Server: true (Bootstrap: false)
Client Addr: [127.0.0.1] (HTTP: 8500, HTTPS: -1, DNS: 8600)
Cluster Addr: 127.0.0.1 (LAN: 8301, WAN: 8302)
Encrypt: Gossip: false, TLS-Outgoing: false, TLS-Incoming: false
==&amp;gt; Log data will now stream in as it occurs:
2018/01/12 22:02:36 [DEBUG] Using random ID &amp;quot;14f11e8d-4904-3fcd-1cd5-251c311cf775&amp;quot; as node ID
2018/01/12 22:02:36 [INFO] raft: Initial configuration (index=1): [{Suffrage:Voter ID:14f11e8d-4904-3fcd-1cd5-251c311cf775 Address:127.0.0.1:8300}]
2018/01/12 22:02:36 [INFO] raft: Node at 127.0.0.1:8300 [Follower] entering Follower state (Leader: &amp;quot;&amp;quot;)
2018/01/12 22:02:36 [INFO] serf: EventMemberJoin: master.soi.io.dc1 127.0.0.1
2018/01/12 22:02:36 [INFO] serf: EventMemberJoin: master.soi.io 127.0.0.1
2018/01/12 22:02:36 [INFO] consul: Adding LAN server master.soi.io (Addr: tcp/127.0.0.1:8300) (DC: dc1)
2018/01/12 22:02:36 [INFO] consul: Handled member-join event for server &amp;quot;master.soi.io.dc1&amp;quot; in area &amp;quot;wan&amp;quot;
2018/01/12 22:02:36 [INFO] agent: Started DNS server 127.0.0.1:8600 (udp)
2018/01/12 22:02:36 [INFO] agent: Started DNS server 127.0.0.1:8600 (tcp)
2018/01/12 22:02:36 [INFO] agent: Started HTTP server on 127.0.0.1:8500 (tcp)
2018/01/12 22:02:36 [INFO] agent: started state syncer
2018/01/12 22:02:36 [WARN] raft: Heartbeat timeout from &amp;quot;&amp;quot; reached, starting election
2018/01/12 22:02:36 [INFO] raft: Node at 127.0.0.1:8300 [Candidate] entering Candidate state in term 2
2018/01/12 22:02:36 [DEBUG] raft: Votes needed: 1
2018/01/12 22:02:36 [DEBUG] raft: Vote granted from 14f11e8d-4904-3fcd-1cd5-251c311cf775 in term 2. Tally: 1
2018/01/12 22:02:36 [INFO] raft: Election won. Tally: 1
2018/01/12 22:02:36 [INFO] raft: Node at 127.0.0.1:8300 [Leader] entering Leader state
2018/01/12 22:02:36 [INFO] consul: cluster leadership acquired
2018/01/12 22:02:36 [INFO] consul: New leader elected: master.soi.io
2018/01/12 22:02:36 [DEBUG] consul: Skipping self join check for &amp;quot;master.soi.io&amp;quot; since the cluster is too small
2018/01/12 22:02:36 [INFO] consul: member &#39;master.soi.io&#39; joined, marking health alive
2018/01/12 22:02:36 [DEBUG] Skipping remote check &amp;quot;serfHealth&amp;quot; since it is managed automatically
2018/01/12 22:02:36 [INFO] agent: Synced node info
2018/01/12 22:02:36 [DEBUG] agent: Node info in sync
2018/01/12 22:02:37 [DEBUG] Skipping remote check &amp;quot;serfHealth&amp;quot; since it is managed automatically
2018/01/12 22:02:37 [DEBUG] agent: Node info in sync
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é›†ç¾¤æˆå‘˜&#34;&gt;é›†ç¾¤æˆå‘˜&lt;/h3&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæ‰“å¼€å¦ä¸€ä¸ªç»ˆç«¯ï¼Œä½¿ç”¨&lt;code&gt;consul members&lt;/code&gt;å‘½ä»¤æŸ¥çœ‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ consul members
Node Address Status Type Build Protocol DC Segment
master.soi.io 127.0.0.1:8301 alive server 1.0.2 2 dc1 &amp;lt;all&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ä½¿ç”¨serveræ¨¡å¼è¿è¡Œ&#34;&gt;ä½¿ç”¨serveræ¨¡å¼è¿è¡Œ&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ consul agent -server -bootstrap -data-dir=$PWD -advertise=192.168.31.28 -client=0.0.0.0 -ui
bootstrap = true: do not enable unless necessary
==&amp;gt; Starting Consul agent...
==&amp;gt; Consul agent running!
Version: &#39;v1.0.2&#39;
Node ID: &#39;aac96fbf-2ccb-e0a8-2e82-aa4e3ff40d82&#39;
Node name: &#39;master.soi.io&#39;
Datacenter: &#39;dc1&#39; (Segment: &#39;&amp;lt;all&amp;gt;&#39;)
Server: true (Bootstrap: true)
Client Addr: [0.0.0.0] (HTTP: 8500, HTTPS: -1, DNS: 8600)
Cluster Addr: 192.168.31.28 (LAN: 8301, WAN: 8302)
Encrypt: Gossip: false, TLS-Outgoing: false, TLS-Incoming: false
==&amp;gt; Log data will now stream in as it occurs:
2018/01/12 22:09:19 [INFO] raft: Initial configuration (index=1): [{Suffrage:Voter ID:aac96fbf-2ccb-e0a8-2e82-aa4e3ff40d82 Address:192.168.31.28:8300}]
2018/01/12 22:09:19 [INFO] raft: Node at 192.168.31.28:8300 [Follower] entering Follower state (Leader: &amp;quot;&amp;quot;)
2018/01/12 22:09:19 [INFO] serf: EventMemberJoin: master.soi.io.dc1 192.168.31.28
2018/01/12 22:09:19 [INFO] serf: EventMemberJoin: master.soi.io 192.168.31.28
2018/01/12 22:09:19 [INFO] consul: Handled member-join event for server &amp;quot;master.soi.io.dc1&amp;quot; in area &amp;quot;wan&amp;quot;
2018/01/12 22:09:19 [INFO] consul: Adding LAN server master.soi.io (Addr: tcp/192.168.31.28:8300) (DC: dc1)
2018/01/12 22:09:19 [INFO] agent: Started DNS server 0.0.0.0:8600 (udp)
2018/01/12 22:09:19 [INFO] agent: Started DNS server 0.0.0.0:8600 (tcp)
2018/01/12 22:09:19 [INFO] agent: Started HTTP server on [::]:8500 (tcp)
2018/01/12 22:09:19 [INFO] agent: started state syncer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€&lt;a href=&#34;http://localhost:8500&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;http://localhost:8500&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/consul-first-time/consul-ui.png&#34; alt=&#34;consul ui&#34; /&gt;&lt;/p&gt;</description></item><item><title>2018å¹´è®¡åˆ’</title><link>https://ronggle.com/2018/2018-technology-plan/</link><pubDate>Thu, 04 Jan 2018 21:48:48 +0800</pubDate><guid>https://ronggle.com/2018/2018-technology-plan/</guid><description>&lt;p&gt;å¼¹æŒ‡é—´ï¼Œ2017åˆæµªè´¹äº†ï¼Œ2018ä¼Šå§‹ï¼Œè¯¥åšå¥½è®¡åˆ’ï¼Œè§„åˆ’ä¸‹è‡ªå·±çš„ä¸€å¹´äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”Ÿæ´»è®¡åˆ’&#34;&gt;ç”Ÿæ´»è®¡åˆ’&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ¯å‘¨è‡³å°‘æ‰“ä¸€æ¬¡çƒ&lt;/li&gt;
&lt;li&gt;åšæŒæ¯å¤©é”»ç‚¼èº«ä½“&lt;/li&gt;
&lt;li&gt;åšæŒ23ç‚¹ç¡è§‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è¯»ä¹¦è®¡åˆ’&#34;&gt;è¯»ä¹¦è®¡åˆ’&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ã€ŠKubernetesæƒå¨æŒ‡å—ã€‹&lt;/li&gt;
&lt;li&gt;ã€Šå¼€æºå®¹å™¨äº‘-OpenShiftã€‹&lt;/li&gt;
&lt;li&gt;ã€ŠVueæƒå¨æŒ‡å—ã€‹&lt;/li&gt;
&lt;li&gt;ã€Šé¢†åŸŸé©±åŠ¨è®¾è®¡ã€‹&lt;/li&gt;
&lt;li&gt;ã€Šå¾®æœåŠ¡æ¶æ„ä¸å®è·µã€‹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è¯¾ç¨‹å­¦ä¹ &#34;&gt;è¯¾ç¨‹å­¦ä¹ &lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CKA&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æŠ€æœ¯å­¦ä¹ &#34;&gt;æŠ€æœ¯å­¦ä¹ &lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Consul&lt;/li&gt;
&lt;li&gt;Golang&lt;/li&gt;
&lt;li&gt;Spring Boot/Cloud&lt;/li&gt;
&lt;li&gt;Nomad&lt;/li&gt;
&lt;li&gt;CI/CD(CDS,GoCD,Jenkins)&lt;/li&gt;
&lt;li&gt;OpenID Connect&lt;/li&gt;
&lt;li&gt;K8s&lt;/li&gt;
&lt;li&gt;Docker&lt;/li&gt;
&lt;li&gt;Nodejs&lt;/li&gt;
&lt;li&gt;Python&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é¡¹ç›®è®¡åˆ’&#34;&gt;é¡¹ç›®è®¡åˆ’&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/ycrxun/onion&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;onion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å…¶ä»–è®¡åˆ’&#34;&gt;å…¶ä»–è®¡åˆ’&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åšæŒå†™åšå®¢&lt;/li&gt;
&lt;li&gt;åšæŒå†™åšå®¢&lt;/li&gt;
&lt;li&gt;åšæŒå†™åšå®¢&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Easy Mock è¯•ç©</title><link>https://ronggle.com/2017/easy-mock-getting-and-started/</link><pubDate>Sun, 03 Sep 2017 12:38:11 +0800</pubDate><guid>https://ronggle.com/2017/easy-mock-getting-and-started/</guid><description>&lt;p&gt;åœ¨è¿‡å»çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œæˆ–è®¸æ˜¯ä¸€ç¾¤äººååœ¨ä¸€èµ·ï¼Œé£é£ç«ç«çš„ä¸€èµ·ç ä¸€ä¸ªé¡¹ç›®ï¼Œå¤§å®¶åœ¨ä¸€èµ·ï¼Œå£å¤´æ²Ÿé€šäº¤æµï¼Œå¹¶ä¸å¤ªæ¶‰åŠåˆ°è·¨å›¢é˜Ÿé—´çš„æ•°æ®è°ƒç”¨ï¼ŒåŸºæœ¬ä¸Šæ¶‰åŠçš„APIä¹Ÿæ˜¯ä¸æ–­æ²Ÿé€šä¿®æ”¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸æ­çš„å‰è¨€&#34;&gt;ä¸æ­çš„å‰è¨€&lt;/h2&gt;
&lt;p&gt;è€Œä»Šï¼Œå¼€å‘çš„é¡¹ç›®åºå¤§è€Œä¸”å¤æ‚ï¼Œæ¶‰åŠå¤šä¸ªæ¨¡å—ï¼Œè·¨å¤šä¸ªé¡¹ç›®ç»„ï¼Œå¦‚æœå†æŒ‰ç…§å£å¤´æ²Ÿé€šåè°ƒï¼Œå¾ˆéš¾æƒ³è±¡æ˜¯å¤šä¹ˆè‰°éš¾ã€‚è€Œåœ¨æ—¥å¸¸çš„ä¸€äº›å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸åœçš„å¯¹è‡ªå·±å¼€å‘çš„ä»£ç è¿›è¡Œè°ƒè¯•ï¼Œæ¯”å¦‚æŸäº›å…¬å¸ï¼Œæœ‰äº›äº§å“çº¿æ ¹æœ¬æ²¡æœ‰ç¨³å®šçš„å¼€å‘ç¯å¢ƒæä¾›ç»™å¼€å‘äººå‘˜ä½¿ç”¨ï¼Œé‚£ä¹ˆï¼Œæ€ä¹ˆåŠï¼Œåªèƒ½ä½¿ç”¨mockçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;è¯´åˆ°mockï¼Œå…¶å®æˆ‘ä¹Ÿå†ä½¿ç”¨ï¼Œæœ‰æ—¶å€™ï¼Œä¸èƒ½æ¯æ—¶æ¯åˆ»éƒ½è°ƒç”¨çœŸå®çš„æœåŠ¡ï¼Œæˆ‘ä»¬å°±ä¼šå†è‡ªå·±é¡¹ç›®ä¸­è®¾ç½®å¼€å…³ï¼Œå½“å†å¼€å‘ç¯å¢ƒä¸‹æ—¶ï¼Œä½¿ç”¨è‡ªå·±å†æœ¬åœ°æ–‡ä»¶ä¸­ä¼ªé€ çš„æ•°æ®ï¼Œè¿™äº›æ–‡ä»¶æœ‰JSONã€TXTã€CSV/EXCELï¼Œå¾€å¾€å†ä¸åŒçš„æ¨¡å—å’Œå€Ÿå£ä¼šå†™å¾ˆå¤šä¸åŒçš„Mockæ•°æ®å¤„ç†çš„é€»è¾‘ï¼Œæ²¡æœ‰å¤ç”¨æ€§ï¼Œä¸”æ²¡æœ‰è‰¯å¥½çš„ç‰ˆæœ¬æ§åˆ¶ä¸ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè¦æ€ä¹ˆå¤„ç†è¿™äº›Mockæ•°æ®å‘¢ï¼Ÿä»Šå¤©æˆ‘ä»¬æ¥è¯•ç©ä¸€ä¸‹Easy Mockã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯easy-mock&#34;&gt;ä»€ä¹ˆæ˜¯Easy Mock&lt;/h2&gt;
&lt;p&gt;ä¼ªé€ æ•°æ®ï¼Œæˆ‘ä»¬æ›´é«˜æ•ˆï¼›ä½†ï¼Œä¸ä»…äºæ­¤ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯Easy Mockçš„&lt;a href=&#34;https://www.easy-mock.com&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;å®˜ç½‘&lt;/a&gt;ä¸Šé¢çš„ä»‹ç»ã€‚&lt;/p&gt;
&lt;p&gt;Easy Mockæ˜¯ä¸€ä¸ªæå…¶ç®€å•ã€é«˜æ•ˆã€å¯è§†åŒ–ã€å¹¶ä¸”èƒ½å¿«é€Ÿç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®çš„åœ¨çº¿MockæœåŠ¡ã€‚ä»¥é¡¹ç›®ç®¡ç†çš„æ–¹å¼ç»„ç»‡Mockæ•°æ®ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç®¡ç†Mockæ•°æ®ï¼Œä¸æ€•ä¸¢å¤±ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç‰¹æ€§&#34;&gt;ç‰¹æ€§&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒæ¥å£ä»£ç†&lt;/li&gt;
&lt;li&gt;æ”¯æŒå¿«æ·é”®æ“ä½œ&lt;/li&gt;
&lt;li&gt;æ”¯æŒååŒç¼–è¾‘&lt;/li&gt;
&lt;li&gt;æ”¯æŒå›¢é˜Ÿé¡¹ç›®&lt;/li&gt;
&lt;li&gt;æ”¯æŒ Restful&lt;/li&gt;
&lt;li&gt;æ”¯æŒ Swagger 1.2 &amp;amp; 2.0
&lt;ul&gt;
&lt;li&gt;åŸºäº Swagger å¿«é€Ÿåˆ›å»ºé¡¹ç›®&lt;/li&gt;
&lt;li&gt;æ”¯æŒæ˜¾ç¤ºæ¥å£å…¥å‚ä¸è¿”å›å€¼&lt;/li&gt;
&lt;li&gt;æ”¯æŒæ˜¾ç¤ºå®ä½“ç±»&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;æ”¯æŒçµæ´»æ€§ä¸æ‰©å±•æ€§æ›´é«˜çš„å“åº”å¼æ•°æ®å¼€å‘&lt;/li&gt;
&lt;li&gt;æ”¯æŒ Mock.js è¯­æ³•&lt;/li&gt;
&lt;li&gt;æ”¯æŒ restc æ–¹å¼çš„æ¥å£é¢„è§ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://easy-mock.com/docs&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;åœ¨çº¿ä½¿ç”¨æ–‡æ¡£&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://github.com/easy-mock/easy-mock-cli&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Easy Mock CLI&lt;/a&gt; - åŸºäº Easy Mock å¿«é€Ÿç”Ÿæˆ api.js çš„å‘½ä»¤è¡Œå·¥å…·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;æ•°æ®ä¼ªé€ &#34;&gt;æ•°æ®ä¼ªé€ &lt;/h2&gt;
&lt;p&gt;æˆ‘å‰é¢ä¹Ÿæåˆ°è¿‡ï¼Œæˆ‘ä»¬æ‰æœ‰çš„æ˜¯ç¼–ç¨‹å¼çš„ä¼ªé€ æ•°æ®ï¼Œåˆ©ç”¨è¯·æ±‚æ‹¦æˆªæˆ–è€…é…ç½®æ–‡ä»¶å¼€å…³ï¼Œæ¥åˆ‡æ¢æˆ‘ä»¬çš„æ­£å¸¸æ•°æ®è¯·æ±‚ä¸Mockæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›æ–¹æ³•è™½ç„¶å¯ä»¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œä½†åŒæ ·ä¼´éšç€ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚è¯´ï¼Œä¾èµ–ç‰¹å®šçš„æ¡†æ¶ï¼Œä¸»è¦ä½“ç°å†æˆ‘ä»¬ä½¿ç”¨springçš„é…ç½®æ–‡ä»¶profileä½œä¸ºåˆ‡æ¢å¼€å…³ï¼›åˆæ¯”å¦‚ï¼Œè„ä»£ç ï¼Œä¸»è¦æ˜¯æˆ‘ä»¬ä¼šå¸¦é¡¹ç›®æºç ä¸­ä»¥ç¼–ç¨‹çš„æ–¹å¼ä¼ªé€ Mockæ•°æ®ï¼›åˆæ¯”å¦‚è¯´ï¼Œè¿™äº›æ•°æ®æ²¡æ³•ç»Ÿä¸€ç®¡ç†ï¼Œå˜æ›´å›°éš¾ç­‰ç­‰ã€‚his&lt;/p&gt;
&lt;p&gt;è¯´åˆ°ä»¥ä¸Šçš„è¿™äº›å›°éš¾ï¼Œå¯èƒ½è¿˜æ˜¯æ²¡èƒ½è§¦åŠä½ çš„ç—›ç‚¹ï¼Œä½†æ˜¯æ— æ‰€è°“äº†ï¼Œå“ˆå“ˆå“ˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯•è¯•Easy Mockå§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰è£…&#34;&gt;å®‰è£…&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨å¼€å§‹ä¹‹å‰ï¼Œå‡è®¾ä½ å·²ç»æˆåŠŸå®‰è£…äº† Node.js (v7.4 ä»¥ä¸Š) å’Œ MongoDB (v3.4 ä»¥ä¸Š)&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œåœ¨å®‰è£…é¡¹ç›®ä¾èµ–æ—¶ï¼Œbcryptéœ€è¦c++ç¼–è¯‘ç¯å¢ƒg++ï¼Œå¦‚æœä½ æ²¡æœ‰å®‰è£…ï¼Œé‚£éœ€è¦è‡ªè¡Œå®‰è£…
&amp;gt; $ sudo dnf install gcc-c++ # æ³¨æ„ï¼Œæœ¬å±Œä½¿ç”¨çš„æ˜¯Fedoraï¼Œä½ éœ€è¦æ ¹æ®è‡ªå·±çš„æ“ä½œç³»ç»Ÿæ‰¾åˆ°å®‰è£…æ–¹å¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ git clone https://github.com/easy-mock/easy-mock.git
$ cd easy-mock &amp;amp;&amp;amp; npm install
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;é…ç½®&#34;&gt;é…ç½®&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸åŒç¯å¢ƒä¼šåŠ è½½ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨æ­¤ä¹‹å‰ä½ åº”è¯¥å¯¹ node-config æœ‰æ‰€äº†è§£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ pwd
/home/soi/web/easy-mock
$ cd config
$ cat default.json
{
&amp;quot;port&amp;quot;: 7300,
&amp;quot;pageSize&amp;quot;: 30,
&amp;quot;routerPrefix&amp;quot;: {
&amp;quot;mock&amp;quot;: &amp;quot;/mock&amp;quot;,
&amp;quot;api&amp;quot;: &amp;quot;/api&amp;quot;
},
&amp;quot;db&amp;quot;: &amp;quot;mongodb://192.168.31.28:27017/easy-mock&amp;quot;,
...
}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦é…ç½®çš„æ˜¯MongoDBï¼Œå¯ä»¥ä¸é…ç½®å…¶ä»–çš„ã€‚å¦‚æœä½ éœ€è¦ä¸€äº›é«˜çº§ç”¨æ³•ï¼Œä½ å¯ä»¥å‚è€ƒgithubä»“åº“çš„æ–‡æ¡£è¿›è¡Œé…ç½®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å¯åŠ¨&#34;&gt;å¯åŠ¨&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;$ npm run dev
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨çš„å¼€å‘æ¨¡å¼å¯åŠ¨ï¼Œå¯ä»¥åœ¨ä½ çš„æµè§ˆå™¨ä¸­è®¿é—®&lt;code&gt;http://127.0.0.1:7300&lt;/code&gt;&lt;br /&gt;
æ›´å¤šå‘½ä»¤ï¼š&lt;br /&gt;
$ npm run build # å‰ç«¯é™æ€èµ„æºæ„å»ºæ‰“åŒ…&lt;br /&gt;
$ npm run start # ä»¥ç”Ÿäº§ç¯å¢ƒæ–¹å¼å¯åŠ¨ï¼Œéœ€è¦æå‰æ‰§è¡Œ build&lt;br /&gt;
$ npm run test # æµ‹è¯•&lt;br /&gt;
$ npm run lint # è¯­æ³•æ£€æµ‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä½¿ç”¨&#34;&gt;ä½¿ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;ç™»å½•é¡µ&#34;&gt;ç™»å½•é¡µ&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/login.png&#34; alt=&#34;easy mock login&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/login-input.png&#34; alt=&#34;easy mock login input&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼Œè¿™é‡Œå¦‚æœä½ æ²¡æœ‰ç”¨æˆ·åå’Œå¯†ç çš„è¯ï¼Œç›´æ¥è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œä¼šç»™æ–°å»ºä¸€ä¸ªç”¨æˆ·&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;ä¸ªäººé¡¹ç›®&#34;&gt;ä¸ªäººé¡¹ç›®&lt;/h3&gt;
&lt;p&gt;ç™»å½•æˆåŠŸåï¼Œè¿›å…¥æˆ‘çš„ä¸ªäººé¡¹ç›®é¢æ¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/my-project.png&#34; alt=&#34;easy mock project&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»é¡¹ç›®å¯ä»¥æŸ¥çœ‹é¡¹ç›®æ¥å£åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/my-project-api.png&#34; alt=&#34;easy mock project api&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;å›¢é˜Ÿé¡¹ç›®&#34;&gt;å›¢é˜Ÿé¡¹ç›®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åˆå§‹åŒ–ä¸€ä¸ªå›¢é˜Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/my-team-new.png&#34; alt=&#34;easy mock team&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°å»ºå›¢é˜Ÿé¡¹ç›®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/my-team-project-new.png&#34; alt=&#34;easy mock team project&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼–è¾‘é¡¹ç›®API&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/my-team-project-api-edit.png&#34; alt=&#34;easy mock team project api&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¢„è§ˆé¡¹ç›®API&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/easy-mock-getting-and-started/my-team-project-api-preview.png&#34; alt=&#34;easy mock team project api previw&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;åè¯­&#34;&gt;åè¯­&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œæˆ‘å°±æ°´å®Œäº†ä¸€ç¯‡åšå®¢äº†ï¼Œå¯¹ä½ æœ‰æ²¡æœ‰å¸®åŠ©æˆ‘ä¸çŸ¥é“ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡é¦–å…ˆçš„æ„Ÿè°¢ä¸‹&lt;a href=&#34;http://f2e.souche.com/blog/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;å¤§æœè½¦æ— çº¿æ¶æ„å›¢é˜Ÿ&lt;/a&gt;ç»™æˆ‘ä»¬å¼€æºè¿™ä¸ªå¥½ç”¨çš„Mockç¥å™¨ã€‚&lt;/p&gt;</description></item><item><title>Fedora æ¡Œé¢ç³»ç»Ÿä½“éªŒ</title><link>https://ronggle.com/2017/fedora/</link><pubDate>Thu, 03 Aug 2017 21:39:17 +0800</pubDate><guid>https://ronggle.com/2017/fedora/</guid><description>&lt;p&gt;æœ€å¼€å§‹å®‰è£…Linuxæ“ä½œç³»ç»Ÿï¼Œé‚£æ˜¯ä¸‰å››å¹´å‰äº†ï¼Œé‚£æ—¶å€™è¿˜åœ¨å¤§å­¦ï¼Œå½“æ—¶å®‰è£…äº†Debianï¼Œå®Œäº†ä¸€æ®µæ—¶é—´åä¸ºäº†è€æ¸¸æˆï¼Œè¿˜æ˜¯æ¢å›äº†Windowsã€‚&lt;/p&gt;
&lt;p&gt;å†æ¬¡å®‰è£…Linuxæ˜¯ä¸¤å¹´å‰ï¼Œè‡ªå·±å®‰è£…äº†ä¸ªUbuntuï¼Œåé¢å®‰è£…äº†Deepinï¼Œæ€»ä½“ä¸Šæ„Ÿè§‰éƒ½å¾ˆä¸é”™ï¼Œç‰¹åˆ«æ˜¯Deepinï¼Œå›½å†…å‘è¡Œç‰ˆç®—æ˜¯é¢œå€¼æ¯”è¾ƒé«˜çš„äº†ï¼Œä¸€ç›´éƒ½å¾ˆå–œæ¬¢ã€‚&lt;/p&gt;
&lt;p&gt;ç›´åˆ°å»å¹´æˆ‘çš„ç¬”è®°æœ¬æŠ¥åºŸï¼Œå…­ä¸ƒå¹´å‰çš„ä½é…ç”µè„‘ï¼Œå®åœ¨æ‰›ä¸ä½äº†ã€‚åœ¨æ¢äº†æ–°çš„ç”µè„‘åï¼Œi7ã€16Gã€GTX960ï¼Œå¾ˆç»™åŠ›çš„é…ç½®ï¼Œä½†æ˜¯åœ¨æˆ‘è£…Ubuntuçš„è¿‡ç¨‹ä¸­ï¼Œä¸¥é‡ä¸å–œæ¬¢è¿™ä¸ªé…ç½®äº†ï¼Œæ˜¾å¡ä¸å…¼å®¹ï¼Œä¸Šé¢çš„Windows10è¿˜ç‰¹åˆ«è®¨åŒï¼Œä¸å¾—ä¸æ”¾å¼ƒã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®åœ¨å¾ˆä¹…ä¹‹å‰ï¼Œå°±å¬è¯´&lt;a href=&#34;https://getfedora.org/&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Fedora&lt;/a&gt;å¾ˆä¸é”™ï¼Œæœ€è¿‘å› ä¸ºæŠ˜è…¾Openshiftï¼Œçªå‘å¥‡æƒ³ï¼Œå®‰è£…äº†ä¸€ä¸ªï¼Œç„¶åè¢«Fedoraçš„é¢œå€¼ï¼ˆè‚¯å®šæ˜¯æ¡Œé¢ï¼‰å¸å¼•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼ ç¾ç¾çš„æ¡Œé¢&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/fedora/home.png&#34; alt=&#34;fedora home&#34; /&gt;&lt;/p&gt;
&lt;p&gt;åº”ç”¨åˆ—è¡¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/fedora/apps.png&#34; alt=&#34;fedora apps&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¼¹å‡º&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/fedora/super.png&#34; alt=&#34;fedora pop&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¤šçª—å£&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/fedora/edit.png&#34; alt=&#34;fedora edit&#34; /&gt;&lt;/p&gt;
&lt;p&gt;é‡å‘½å&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/fedora/rename.png&#34; alt=&#34;fedora rename&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç»ˆç«¯
&lt;img src=&#34;https://ronggle.com/fedora/terminal.png&#34; alt=&#34;fedora terminal&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ¼‚äº®ä¸ï¼Ÿå¦‚æœä½ ä¹Ÿå–œæ¬¢ï¼Œå®‰è£…ä¸ªè¯•è¯•å‘—ï¼&lt;/p&gt;</description></item><item><title>ä¸€åœºç‹è€…å†œè¯å¼•å‘çš„æ€è€ƒ</title><link>https://ronggle.com/2017/a-game-of-thinking/</link><pubDate>Sat, 29 Jul 2017 17:37:14 +0800</pubDate><guid>https://ronggle.com/2017/a-game-of-thinking/</guid><description>&lt;p&gt;æœ€è¿‘æ‰‹æ¸¸å±Šï¼Œç‹è€…å†œè¯åº”è¯¥ç®—æ˜¯æ¯”è¾ƒç«çˆ†çš„äº†ã€‚å½“ç„¶ï¼Œæˆ‘ä¹Ÿæ˜¯å…¶ä¸­çš„ä¸€åä¸­æ¯’è€…ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€æ¬¡æ¬¡çš„æ¸¸æˆä¸­ï¼Œæœ‰èƒœåˆ©ï¼Œæœ‰å¤±è´¥ï¼Œä¹Ÿæœ‰æ„¤æ€’ï¼Œä¹Ÿæœ‰è´£æ€ªï¼Œåˆ°æœ€åï¼Œæˆ‘è¿˜æ˜¯æ°¸æ’çš„â€œé’é“œâ€ã€‚&lt;/p&gt;
&lt;p&gt;æ‰¯è¿œäº†ï¼Œå›åˆ°ä¸»é¢˜ï¼Œå‰å‡ å¤©å’Œå°ä¼™ä¼´ä¸€èµ·æ‰“æ’ä½ï¼Œæœ‰ç”Ÿä¹‹å¹´ï¼Œæœ€èˆ’æœçš„ä¸€æ¬¡æ’ä½ã€‚ä»è€Œæœ‰äº†ä¸‹é¢çš„è¿™äº›æ€è€ƒï¼Œçº¯å±ä¸ªäººè§‚ç‚¹ï¼Œä¸å–œå‹¿å–·ï¼é¢ï¼Œå…¶å®ä¹Ÿä¸ä¼šæœ‰äººå–·çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/a-game-of-thinking/game.png&#34; alt=&#34;game&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;å›¢é˜Ÿ&#34;&gt;å›¢é˜Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸‰ä¸ªè‡­çš®åŒ ï¼Œé¡¶ä¸ªè¯¸è‘›äº®ã€‚ä¸å¾—ä¸è¯´ï¼Œåœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œä¼šè§åˆ°å¾ˆå¤šå›¢é˜Ÿï¼Œæœ‰æŠ€æœ¯çš„ï¼Œæœ‰æ–½å·¥çš„ï¼Œå„æœ‰ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç‹è€…å†œè¯ä¸­ï¼Œé€‰æ‹©ä¸€åœºå¯¹å±€ï¼Œé…åˆé˜Ÿå‹ï¼Œé€‰æ‹©è‡ªå·±æ“…é•¿çš„è‹±é›„ï¼Œå°„æ‰‹ã€æ³•å¸ˆã€æ‰“é‡ã€è¾…åŠ©ã€è‚‰ç›¾ï¼Œå„å¸å…¶èŒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¸¸æˆçš„è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬éƒ½ä¼šæ ¹æ®è‹±é›„çš„æ€§è´¨ä¸åŒï¼Œé€‰æ‹©ä¸åŒçš„è·¯çº¿ã€‚åŒæ—¶ï¼Œè¦å‡†å¤‡å¥½éšæ—¶æ”¯æ´å¤„äºå±é™©ä¸­çš„é˜Ÿå‹ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå®é™…ä¸Šè¿™ä¸ªæ˜¯ç†æƒ³çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;äººéƒ½æ˜¯è‡ªç§çš„ï¼Œæ‰€è°“ï¼Œâ€œäººä¸ä¸ºå·±ï¼Œå¤©è¯›åœ°ç­â€ã€‚å¾ˆå¤šæ—¶å€™ï¼Œç»„å»ºçš„å›¢é˜Ÿå¾ˆå¤šæ—¶å€™éƒ½æ˜¯æ®‹ç¼ºä¸å…¨çš„ã€‚èƒ½å¤Ÿåšåˆ°æ— ç§å¥‰çŒ®è‡ªå·±çš„ï¼Œèƒ½æœ‰å¤šå°‘äººå‘¢ï¼Ÿæˆ‘ä»¬éƒ½æ˜¯å‡¡å¤«ä¿—å­ï¼Œéƒ½æœ‰ä¸ƒæƒ…å…­æ¬²ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è®°å¾—ä»¥å‰æœ‰ä¸€å±€ï¼Œæˆ‘é€‰æ‹©äº†æ³•å¸ˆï¼Œæˆ‘ä»¬5äººä¸€èµ·æ¨ä¸­è·¯ï¼Œè¿™æ—¶å€™ï¼Œå¯¹é¢4ä¸ªäººè¿‡æ¥äº†ï¼Œæˆ‘çš„ä¸Šå»å°±æ˜¯ä¸€ä¸ªå¤§ï¼Œç»“æœï¼Œæˆ‘çš„é˜Ÿå‹å…¨èµ°äº†ï¼Œå¯¹æ²¡é”™ï¼Œèµ°äº†ï¼Œç•™æˆ‘ä¸€ä¸ªäººåœ¨é‚£é‡Œæ‡µé€¼ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åé¢çš„å›åˆä¸­ï¼Œæˆ‘å¹¸è‹¦çš„æ‰“æ®‹è¡€äº†ä¸€ä¸ªï¼Œè¿™æ—¶å€™æˆ‘çš„ä¸¤ä¸ªé˜Ÿå‹å‹‡æ•¢çš„ä¸Šå»ï¼Œè¿½ç€äººå®¶æ®‹è¡€ä¸æ”¾ï¼Œå„ç§å–Šæ’¤é€€éƒ½ä¸åœï¼Œä»ä¸­è·¯ä¸€è·¯è¿½åˆ°ä¸‹è·¯ï¼Œç„¶åä¸­äº†åŸ‹ä¼ã€‚ä¸æ˜¯ï¼Œæˆ‘è¯´ä½ ä»¬è¿™ä¸ªä½•å¿…å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€æ¬¡ï¼Œå¯¹é¢ä¸¤ä¸ªè‚‰ç›¾åœ¨å‰é¢æ‰›ç€ï¼Œåé¢è¾“å‡ºè´¼çŒ›ï¼Œæˆ‘çš„é˜Ÿå‹å´ä¸€å¿ƒä¸€æ„ï¼Œå¾ˆè®¤çœŸå¾ˆè®¤çœŸçš„æ‰“è‚‰ç›¾ã€‚å’±èƒ½ä¸é€—å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®ï¼Œåœ¨å®é™…çš„ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å·¥ä½œçš„å›¢é˜Ÿä¹Ÿä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œå½“ä¸€ä¸ªä»»åŠ¡æ¥äº†ï¼Œå¾ˆå¤šäººéƒ½ä¼šé¿è€Œä¸åŠï¼Œå½“ä¸€ç‚¹å¥½å¤„æ¥äº†ï¼Œå¾ˆå¤šäººéƒ½ä¼šå¼ƒé˜Ÿå‹äºä¸é¡¾ï¼Œè‡ªå·±å…ˆä¸Šã€‚&lt;/p&gt;
&lt;p&gt;å¾€å¾€åœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œæ€»æ˜¯æƒ³åŠæ³•æŠŠé”…ä¸¢å‡ºå»ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è®°å¾—æˆ‘ä»¥å‰åœ¨æŸå…¬å¸ï¼Œå½“æ—¶å‘ç”Ÿäº†æ•…éšœï¼Œæ‰€æœ‰äººéƒ½åœ¨æ‰¾åˆ°åº•æ˜¯è°é€ æˆçš„ã€‚å…¶å®ï¼Œè¿™ä¸ªæ—¶å€™é‡è¦çš„ä¸æ˜¯æ‰¾åˆ°å¯¹ç­–ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿä¸ºå•¥éƒ½åœ¨æ‰¾æ˜¯è°é€ æˆçš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€å±€å†œè¯ä¸­ï¼Œæˆ‘æ˜¯ä¸€ä¸ªå¿«ä¹çš„å°å°„æ‰‹ï¼Œè¾…åŠ©æˆ‘çš„å“¥ä»¬åœ¨è‰ä¸›é‡Œé¢çœ‹ç€æˆ‘å’Œå¯¹é¢æ€¼ï¼Œæ²¡é”™ï¼Œçœ‹ç€ï¼Œå½“æˆ‘æŠŠå¯¹é¢æ€¼æ®‹è¡€çš„æ—¶å€™ï¼Œä»–ä¸€ä¸ªæ¼‚äº®çš„æŠ€èƒ½ï¼ŒæŠ¢åˆ°ä¸€ä¸ªäººå¤´ã€‚æ²¡é”™ï¼Œæˆ‘è¿˜ç«™åœ¨å“ªé‡Œè’™åœˆï¼Œç¬¬äºŒæ¬¡è¿˜è¿™æ ·ï¼Œç¬¬ä¸‰æ¬¡ä¹Ÿæ˜¯ã€‚ä¸å¾—ä¸æ‰¿è®¤ï¼Œå½“æ—¶æˆ‘å¾ˆæƒ³ç¥è´ºä»–ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ç†æƒ³çŠ¶æ€ä¸‹çš„å›¢é˜Ÿï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªè£è¾±ä¸å…±çš„ã€‚æ­£å¥½ä»Šå¤©å¬åˆ°ä¸€å¥å°è¯ï¼Œâ€œä½ ä»¬æ²¡æœ‰è£è€€ï¼Œè£è€€åªå±äºéµå®ˆçºªå¾‹çš„å›¢é˜Ÿï¼Œä¸å±äºä½ ä»¬è¿™æ ·çš„ï¼Œä¸€å›¢æ•£æ²™çš„é˜Ÿä¼â€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®šä½&#34;&gt;å®šä½&lt;/h2&gt;
&lt;p&gt;å®šä½ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦é€‰æ‹©é€‚åˆè‡ªå·±çš„è§’è‰²ï¼Œå¹¶ä¸”ï¼Œå°½å¯èƒ½å‘æŒ¥è‡ªå·±ï¼Œé…åˆé˜Ÿå‹ã€‚æ¯”å¦‚ï¼Œå½“æˆ‘é€‰æ‹©åšä¸€åè‚‰ç›¾çš„æ—¶å€™ï¼Œæˆ‘ä¼šå°½å¯èƒ½æ‹–ä½å¯¹é¢ï¼Œä¿æŠ¤åæ’çš„é˜Ÿå‹ï¼›å¦‚æœæˆ‘é€‰æ‹©äº†è¾“å‡ºï¼Œæˆ‘ä¼šå°½å¯èƒ½å…ˆæœç€å¯¹æ–¹è¾“å‡ºï¼Œåœ¨æˆ‘çš„é˜Ÿå‹å€’ä¸‹å‰ï¼Œå°½å¯èƒ½è®©ä»–ä»¬å—åˆ°æœ€çŸ­æ—¶é—´çš„ä¼¤å®³ï¼›å½“ä½œä¸ºä¸€ä¸ªè¾…åŠ©æ—¶ï¼Œéœ€è¦è®©é˜Ÿå‹å¾—åˆ°æœ€å¤šçš„èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®ç”Ÿæ´»ä¸­ä¹Ÿä¸€æ ·ï¼Œåœ¨ä¸€ä¸ªå›¢é˜Ÿé‡Œï¼Œä¸ç®¡ä½ æ˜¯è€äººï¼Œè¿˜æ˜¯æ–°äººï¼Œå¦‚æœè‡ªå·±æ‰åä¸å¦‚é˜Ÿå‹ï¼Œå°±å°½å¯èƒ½è¾…åŠ©é˜Ÿå‹ï¼Œè®©ä»–ç»½æ”¾è‡ªå·±çš„å…‰å½©ï¼Œè€Œåœ¨æŸäº›é¢†åŸŸï¼Œè‡ªå·±èƒ½å¤Ÿèƒœä»»çš„ï¼Œä¸€å®šè¦å°½å¿ƒå»å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™å…¶ä¸­è¿˜æœ‰ä¸ªé‡è¦çš„è§’è‰²ï¼Œå°±æ˜¯ä¸ºé˜Ÿä¼å‘å·æ–½ä»¤çš„äººï¼Œä»€ä¹ˆä»¬æ—¶å€™æ”¹å‰è¿›ï¼Œä»€ä¹ˆæ—¶å€™è¯¥æ’¤é€€ã€‚è€Œè¿™ä¸ªäººï¼Œå¿…é¡»èƒ½å¤Ÿå…³æ³¨åˆ°æˆ˜åœºçš„å½¢åŠ¿ï¼ŒåŠæ—¶è°ƒæ•´æˆ˜æœ¯ï¼Œå¯¹åº”ç¬æ¯ä¸‡å˜çš„æˆ˜åœºã€‚å†ä¸€æ¬¡ä»»åŠ¡å¤±è´¥åï¼Œä½œå‡ºæœ€ä½³çš„è°ƒæ•´ï¼Œé¼“åŠ±é˜Ÿå‹ï¼Œä¸‹ä¸€æ¬¡å†æˆ˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€å&#34;&gt;æœ€å&lt;/h2&gt;
&lt;p&gt;å¥½å§ï¼Œæˆ‘æ‰¿è®¤ï¼Œæˆ‘æ˜¯æ ‡é¢˜å…šã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¯´äº†ä¸€å †åºŸè¯ï¼Œå…¶å®æ˜¯å¸Œæœ›ï¼Œä¸€ä¸ªå›¢é˜Ÿï¼Œåº”è¯¥æ‹¥æœ‰è‡ªå·±çš„è£è€€ã€‚&lt;/p&gt;</description></item><item><title>ä»€ä¹ˆæ˜¯Zipkin</title><link>https://ronggle.com/2017/what-is-zipkin/</link><pubDate>Sat, 22 Jul 2017 23:30:22 +0800</pubDate><guid>https://ronggle.com/2017/what-is-zipkin/</guid><description>&lt;p&gt;&lt;strong&gt;Zipkin&lt;/strong&gt;æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿã€‚ å®ƒæœ‰åŠ©äºæ”¶é›†åœ¨å¾®æœåŠ¡æ¶æ„ä¸­æ’é™¤å»¶è¿Ÿé—®é¢˜æ‰€éœ€çš„æ—¶é—´æ•°æ®ã€‚ å®ƒç®¡ç†è¿™äº›æ•°æ®çš„æ”¶é›†å’ŒæŸ¥æ‰¾ã€‚ Zipkinæ˜¯åŸºäºGoogle Dapperè®ºæ–‡è®¾è®¡çš„ã€‚&lt;/p&gt;
&lt;p&gt;å°†åº”ç”¨ç¨‹åºç”¨äºå‘ZipkinæŠ¥å‘Šæ—¶åºæ•°æ®ã€‚ Zipkin UIè¿˜æä¾›äº†ä¸€ä¸ªä¾èµ–å…³ç³»å›¾ï¼Œæ˜¾ç¤ºäº†æ¯ä¸ªåº”ç”¨ç¨‹åºä¸­è·Ÿè¸ªçš„è¯·æ±‚æ•°é‡ã€‚ å¦‚æœè¦è§£å†³å»¶è¿Ÿé—®é¢˜æˆ–é”™è¯¯ï¼Œå¯ä»¥æ ¹æ®åº”ç”¨ç¨‹åºï¼Œè·Ÿè¸ªé•¿åº¦ï¼Œæ³¨é‡Šæˆ–æ—¶é—´æˆ³æ¥è¿‡æ»¤æˆ–æ’åºæ‰€æœ‰è·Ÿè¸ªã€‚ é€‰æ‹©è·Ÿè¸ªåï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ¯ä¸ªè·¨åº¦æ‰€éœ€çš„æ€»è·Ÿè¸ªæ—¶é—´çš„ç™¾åˆ†æ¯”ï¼Œä»è€Œå…è®¸æ‚¨è¯†åˆ«é—®é¢˜åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/what-is-zipkin/index.png&#34; alt=&#34;index&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿå¼€å§‹&#34;&gt;å¿«é€Ÿå¼€å§‹&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘æ˜¯ä¸€ä¸ªspring cloudçš„åˆå­¦è€…ï¼Œæ‰€ä»¥æˆ‘åœ¨æœ¬æ¬¡é‡‡ç”¨äº†spring cloudæ¥å­¦ä¹ zipkinï¼Œå½“ç„¶ï¼Œåªè¦ä½ æ„¿æ„ï¼Œä½ å®Œå…¨å¯ä»¥ä¸é‡‡ç”¨spring cloudã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;- platform
- account
- config
- registry
- zipkin
- zuul
pom.xml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ˜¯ä¸ªå¤šæ¨¡å—é¡¹ç›®ï¼Œå…¶ä¸­å­æ¨¡å—åˆ†åˆ«å¯¹åº”çš„æ˜¯è´¦å·æœåŠ¡ã€é…ç½®ä¸­å¿ƒã€æ³¨å†Œä¸­å¿ƒã€zipkinæœåŠ¡ã€API Getawayã€‚&lt;/p&gt;
&lt;h3 id=&#34;zipkin-server&#34;&gt;Zipkin Server&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹zipkinæ¨¡å—çš„pom.xml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;project xmlns=&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot;
xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
xsi:schemaLocation=&amp;quot;http://maven.apache.org/POM/4.0.0
http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&amp;gt;
&amp;lt;parent&amp;gt;
&amp;lt;artifactId&amp;gt;platform&amp;lt;/artifactId&amp;gt;
&amp;lt;groupId&amp;gt;team.soi&amp;lt;/groupId&amp;gt;
&amp;lt;version&amp;gt;1.0-SNAPSHOT&amp;lt;/version&amp;gt;
&amp;lt;/parent&amp;gt;
&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;
&amp;lt;artifactId&amp;gt;zipkin&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;1.0-SNAPSHOT&amp;lt;/version&amp;gt;
&amp;lt;dependencies&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.cloud&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-cloud-starter-config&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.cloud&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-cloud-starter-eureka&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-starter-actuator&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;io.zipkin.java&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;zipkin-server&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;io.zipkin.java&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;zipkin-autoconfigure-ui&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;io.zipkin.java&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;zipkin-autoconfigure-storage-mysql&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;mysql&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;mysql-connector-java&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-starter-jdbc&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.projectlombok&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;lombok&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.jetbrains.kotlin&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;kotlin-stdlib&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&amp;lt;build&amp;gt;
&amp;lt;finalName&amp;gt;zipkin&amp;lt;/finalName&amp;gt;
&amp;lt;plugins&amp;gt;
&amp;lt;plugin&amp;gt;
&amp;lt;groupId&amp;gt;org.apache.maven.plugins&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;maven-compiler-plugin&amp;lt;/artifactId&amp;gt;
&amp;lt;/plugin&amp;gt;
&amp;lt;plugin&amp;gt;
&amp;lt;artifactId&amp;gt;kotlin-maven-plugin&amp;lt;/artifactId&amp;gt;
&amp;lt;groupId&amp;gt;org.jetbrains.kotlin&amp;lt;/groupId&amp;gt;
&amp;lt;/plugin&amp;gt;
&amp;lt;plugin&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-maven-plugin&amp;lt;/artifactId&amp;gt;
&amp;lt;/plugin&amp;gt;
&amp;lt;/plugins&amp;gt;
&amp;lt;/build&amp;gt;
&amp;lt;/project&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»pom.xmlä¸­ï¼Œä¸éš¾çœ‹å‡ºï¼Œæˆ‘å¼•å…¥äº†&lt;code&gt;zipkin-server&lt;/code&gt;ã€&lt;code&gt;zipkin-autoconfigure-ui&lt;/code&gt;ã€&lt;code&gt;zipkin-autoconfigure-storage-mysql&lt;/code&gt;ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘é‡‡ç”¨çš„mysqlå­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¯åŠ¨ç±»ä¸­æ‰“å¼€&lt;code&gt;@EnableZipkinServer&lt;/code&gt;æ³¨è§£å°±OKã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package team.soi.platform.zipkin
import org.springframework.boot.SpringApplication
import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.cloud.client.discovery.EnableDiscoveryClient
import zipkin.server.EnableZipkinServer
/**
* @author Soi.
*
* @version 1.0
*
* @see
*/
@SpringBootApplication
@EnableZipkinServer
@EnableDiscoveryClient
open class App
fun main(args: Array&amp;lt;String&amp;gt;) {
SpringApplication.run(App::class.java, *args)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;zipkinæœåŠ¡çš„é…ç½®æ–‡ä»¶application.ymlå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;server:
port: ${port:9411}
spring:
application:
name: zipkin
datasource:
schema: classpath:/mysql.sql
url: jdbc:mysql://localhost:3306/zipkin?autoReconnect=true
username: root
password: root
driver-class-name: com.mysql.jdbc.Driver
initialize: true
continue-on-error: true
eureka:
client:
serviceUrl:
defaultZone: ${defaultZone:http://localhost:8761/eureka/}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;zipkin-client&#34;&gt;Zipkin Client&lt;/h3&gt;
&lt;p&gt;åœ¨ä½¿ç”¨zipkinæœåŠ¡çš„æ¨¡å—çš„pom.xmlä¸­åŠ å…¥ä¸‹é¢çš„ä¾èµ–ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.cloud&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-cloud-starter-zipkin&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶ååœ¨application.ymlä¸­æ³¨æ˜zipkinçš„urlï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;spring:
zipkin:
base-url: http://localhost:9411
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨æˆ‘çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘åˆ†åˆ«åœ¨configã€zuulã€accountæ¨¡å—ä¸­åŠ å…¥äº†zipkinçš„é…ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;zipkin-ui&#34;&gt;Zipkin UI&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘åˆ†åˆ«å¯åŠ¨äº†è¿™å‡ ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Eurekaçš„UIä¸­çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/what-is-zipkin/eureka.png&#34; alt=&#34;eureka&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘åˆ†åˆ«åœ¨æµè§ˆå™¨ä¸­è®¿é—®API Getawayä¸­æ˜ å°„çš„API&lt;code&gt;http://localhost:9200/account/accounts/1&lt;/code&gt;å’Œ&lt;code&gt;http://localhost:9200/config/platform/zuul/dev&lt;/code&gt;ï¼Œç„¶ååœ¨æ‰“å¼€Zipkiné¡µé¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/what-is-zipkin/trace.png&#34; alt=&#34;trace&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡è°ƒç”¨çš„ä¾èµ–å…³ç³»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/what-is-zipkin/dependencies.png&#34; alt=&#34;dependencies&#34; /&gt;&lt;/p&gt;
&lt;p&gt;è¿˜å¯ä»¥çœ‹åˆ°è°ƒç”¨çš„è¯¦ç»†ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ronggle.com/what-is-zipkin/traces_detail.png&#34; alt=&#34;traces detail&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;åœ¨spring cloudä¸­ï¼Œä¸ºæˆ‘ä»¬é›†æˆäº†è®¸è®¸å¤šå¤šå·¥å…·ï¼Œä¸ºæˆ‘ä»¬çš„å¾®æœåŠ¡å¼€å‘æä¾›äº†ä¾¿åˆ©ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº†æˆ‘ä»¬çš„ä¸€äº›ç—›ç‚¹ï¼Œè€ŒZipkinï¼Œä¸ºæˆ‘ä»¬è§£å†³äº†æœåŠ¡è°ƒç”¨é“¾çš„è¿½è¸ªé—®é¢˜ï¼ŒåŒæ—¶æä¾›äº†è¯¦ç»†çš„è°ƒç”¨æ—¶é—´ï¼Œå¯ä»¥æ˜¯æˆ‘ä»¬æ›´åŠ æœ‰æ•ˆåœ°çŸ¥æ™“æœåŠ¡çš„æ€§èƒ½ç“¶é¢ˆåœ¨å“ªäº›åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæœ¬ä¾‹åªæ˜¯ç®€å•çš„ä»‹ç»äº†ä¸‹Zipkinçš„ä½¿ç”¨ï¼Œæ²¡æœ‰æƒ³è¿‡ä¼šç»™ä½ å¸¦æ¥ä»€ä¹ˆã€‚&lt;/p&gt;</description></item></channel></rss>