<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content=noodp><meta name=author content=Soi><meta name=description content="Search Engine Oriented Programming."><meta name=keywords content=Soi,Programming,Blog,ycrxun><link rel=prev href=https://ronggle.com/2018/traefik-on-kubernetes/><link rel=next href=https://ronggle.com/2019/elassandra-getting-and-started/><link rel=canonical href=https://ronggle.com/2019/graph-db-getting-and-started/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>å›¾å½¢æ•°æ®åº“ç®€å•ä»‹ç» | å‡‰éƒ½å°é“</title><meta name=title content="å›¾å½¢æ•°æ®åº“ç®€å•ä»‹ç» | å‡‰éƒ½å°é“"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ronggle.com\/"},"articleSection":"posts","name":"å›¾å½¢æ•°æ®åº“ç®€å•ä»‹ç»","headline":"å›¾å½¢æ•°æ®åº“ç®€å•ä»‹ç»","description":"å›¾å½¢æ•°æ®åº“æ˜¯NoSQLæ•°æ®åº“çš„ä¸€ç§ç±»å‹ï¼Œå®ƒåº”ç”¨å›¾å½¢ç†è®ºå­˜å‚¨å®ä½“ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ã€‚å›¾å½¢æ•°æ®åº“æ˜¯ä¸€ç§éå…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒåº”ç”¨å›¾å½¢ç†è®ºå­˜å‚¨å®ä½“ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ã€‚","inLanguage":"en-us","author":"Soi","creator":"Soi","publisher":"Soi","accountablePerson":"Soi","copyrightHolder":"Soi","copyrightYear":"2019","datePublished":"2019-03-08 11:27:29 \x2b0800 CST","dateModified":"2019-03-08 11:27:29 \x2b0800 CST","url":"https:\/\/ronggle.com\/2019\/graph-db-getting-and-started\/","wordCount":"559","keywords":["Database","GraphDB","Graph","DGraph","Neo4j","å‡‰éƒ½å°é“"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://ronggle.com/>å‡‰éƒ½å°é“</a></div><div class="menu navbar-right"><a class=menu-item href=/posts>Posts</a>
<a class=menu-item href=/categories/>Categories</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://ronggle.com/>å‡‰éƒ½å°é“</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/posts>Posts</a>
<a class=menu-item href=/categories/>Categories</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">å›¾å½¢æ•°æ®åº“ç®€å•ä»‹ç»</h1><div class=post-meta>Written by <a itemprop=name href=https://ronggle.com/ rel=author>Soi</a>
with â™¥
<span class=post-time>on <time datetime=2019-03-08 itemprop=datePublished>March 8, 2019</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=https://ronggle.com/categories/programming/>Programming</a></span></div></header><div class=post-content><img src=/graph-db-getting-and-started/graph.png class=featured_image><h2 id=å…³ç³»å‹æ•°æ®åº“>å…³ç³»å‹æ•°æ®åº“</h2><p>å…³ç³»æ•°æ®åº“ï¼Œæ˜¯å»ºç«‹åœ¨å…³ç³»æ¨¡å‹åŸºç¡€ä¸Šçš„æ•°æ®åº“ï¼Œå€ŸåŠ©äºé›†åˆä»£æ•°ç­‰æ•°å­¦æ¦‚å¿µå’Œæ–¹æ³•æ¥å¤„ç†æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚</p><p>ç°å®ä¸–ç•Œä¸­çš„å„ç§å®ä½“ä»¥åŠå®ä½“ä¹‹é—´çš„å„ç§è”ç³»å‡ç”¨å…³ç³»æ¨¡å‹æ¥è¡¨ç¤ºã€‚å…³ç³»æ¨¡å‹æ˜¯ç”±åŸƒå¾·åŠ Â·ç§‘å¾·äº1970å¹´é¦–å…ˆæå‡ºçš„ï¼Œå¹¶é…åˆâ€œç§‘å¾·åäºŒå®šå¾‹â€ã€‚ç°å¦‚ä»Šè™½ç„¶å¯¹æ­¤æ¨¡å‹æœ‰ä¸€äº›æ‰¹è¯„æ„è§ï¼Œä½†å®ƒè¿˜æ˜¯æ•°æ®å­˜å‚¨çš„ä¼ ç»Ÿæ ‡å‡†ã€‚æ ‡å‡†æ•°æ®æŸ¥è¯¢è¯­è¨€SQLå°±æ˜¯ä¸€ç§åŸºäºå…³ç³»æ•°æ®åº“çš„è¯­è¨€ï¼Œè¿™ç§è¯­è¨€æ‰§è¡Œå¯¹å…³ç³»æ•°æ®åº“ä¸­æ•°æ®çš„æ£€ç´¢å’Œæ“ä½œã€‚ å…³ç³»æ¨¡å‹ç”±å…³ç³»æ•°æ®ç»“æ„ã€å…³ç³»æ“ä½œé›†åˆã€å…³ç³»å®Œæ•´æ€§çº¦æŸä¸‰éƒ¨åˆ†ç»„æˆã€‚</p><p>ç®€å•è¯´ï¼Œå…³ç³»å‹æ•°æ®åº“æ˜¯ç”±å¤šå¼ èƒ½äº’ç›¸è”æ¥çš„äºŒç»´è¡Œåˆ—è¡¨æ ¼ç»„æˆçš„æ•°æ®åº“ã€‚</p><h2 id=nosql>NoSQL</h2><p>NoSQL(Not Only SQL)ï¼Œæ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ã€‚</p><p>éšç€äº’è”ç½‘Web2.0ç½‘ç«™çš„å…´èµ·ï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨åº”ä»˜Web2.0ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯è¶…å¤§è§„æ¨¡å’Œé«˜å¹¶å‘çš„SNSç±»å‹çš„Web2.0çº¯åŠ¨æ€ç½‘ç«™å·²ç»æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œæš´éœ²äº†å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼Œè€Œéå…³ç³»å‹çš„æ•°æ®åº“åˆ™ç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹å¾—åˆ°äº†éå¸¸è¿…é€Ÿçš„å‘å±•ã€‚NoSQLæ•°æ®åº“çš„äº§ç”Ÿå°±æ˜¯ä¸ºäº†è§£å†³å¤§è§„æ¨¡æ•°æ®é›†åˆå¤šé‡æ•°æ®ç§ç±»å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯å¤§æ•°æ®åº”ç”¨éš¾é¢˜ã€‚</p><p>NoSQLæ•°æ®åº“çš„å››å¤§åˆ†ç±»:</p><ul><li>KVæ•°æ®åº“</li><li>å›¾å‹æ•°æ®åº“</li><li>æ–‡æ¡£å‹æ•°æ®åº“</li><li>åˆ—å­˜å‚¨æ•°æ®åº“</li></ul><p>ä»Šå¤©æˆ‘ä»¬è¦è¯´çš„ï¼Œä¾¿æ˜¯å›¾å½¢æ•°æ®åº“ã€‚</p><h2 id=å›¾å½¢æ•°æ®åº“>å›¾å½¢æ•°æ®åº“</h2><p>å›¾å½¢æ•°æ®åº“æ˜¯NoSQLæ•°æ®åº“çš„ä¸€ç§ç±»å‹ï¼Œå®ƒåº”ç”¨å›¾å½¢ç†è®ºå­˜å‚¨å®ä½“ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ã€‚å›¾å½¢æ•°æ®åº“æ˜¯ä¸€ç§éå…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒåº”ç”¨å›¾å½¢ç†è®ºå­˜å‚¨å®ä½“ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ã€‚æœ€å¸¸è§ä¾‹å­å°±æ˜¯ç¤¾ä¼šç½‘ç»œä¸­äººä¸äººä¹‹é—´çš„å…³ç³»ã€‚å…³ç³»å‹æ•°æ®åº“ç”¨äºå­˜å‚¨â€œå…³ç³»å‹â€æ•°æ®çš„æ•ˆæœå¹¶ä¸å¥½ï¼Œå…¶æŸ¥è¯¢å¤æ‚ã€ç¼“æ…¢ã€è¶…å‡ºé¢„æœŸï¼Œè€Œå›¾å½¢æ•°æ®åº“çš„ç‹¬ç‰¹è®¾è®¡æ°æ°å¼¥è¡¥äº†è¿™ä¸ªç¼ºé™·ã€‚</p><p>å’Œå…¶ä»–ä»¥åˆ—ã€è¡Œæˆ–è€…KVç­‰å½¢å¼å­˜å‚¨æ•°æ®çš„æ•°æ®åº“ä¸åŒï¼Œå›¾å½¢æ•°æ®åº“ä»¥èŠ‚ç‚¹ï¼ˆNodeï¼‰å’Œè¾¹ï¼ˆEdgeï¼‰çš„ç½‘ç»œå­˜å‚¨æ‰€æœ‰ä¿¡æ¯ã€‚è¾¹è¡¨ç¤ºé‚£äº›ä»£è¡¨å¯¹è±¡çš„èŠ‚ç‚¹ä¹‹é—´çš„è”ç³»ã€‚å› ä¸ºè¾¹å’ŒèŠ‚ç‚¹éƒ½å¯ä»¥è¢«æè¿°ä¸ºå¯¹è±¡ï¼Œå¼€å‘è€…å¯ä»¥ä¸ºå…¶æŒ‡å®šå±æ€§ï¼ˆAttributeï¼Œæˆ–è€… propertyï¼‰ã€‚ä¸ºè¾¹å¢åŠ æ–¹å‘æœ€ç»ˆä¼šåˆ›å»ºä¸€ä¸ªå±æ€§å›¾ï¼Œå®ƒä»£è¡¨å›¾å½¢æ•°æ®åº“ä¸­çš„æ˜ç¡®ç»“æ„ã€‚</p><h2 id=æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å›¾å½¢æ•°æ®åº“>æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å›¾å½¢æ•°æ®åº“ï¼Ÿ</h2><p>å›¾å½¢æ•°æ®åº“å¯ä»¥é€šè¿‡ä½¿ç”¨æ“ä½œã€æ‰€æœ‰æƒå’Œçˆ¶é¡¹å…³ç³»ç­‰æ¥è¡¨ç¤ºå®ä½“ä¹‹é—´çš„å…³è”å…³ç³»ã€‚å¦‚æœå®ä½“é—´çš„è¿æ¥æˆ–å…³ç³»æ˜¯æ‚¨æ­£åœ¨å°è¯•å»ºæ¨¡çš„æ•°æ®çš„æ ¸å¿ƒï¼Œé‚£å°±é€‚åˆä½¿ç”¨å›¾å½¢æ•°æ®åº“ã€‚å› æ­¤ï¼Œå›¾å½¢æ•°æ®åº“å¯¹äºå»ºæ¨¡å’ŒæŸ¥è¯¢ç¤¾äº¤ç½‘ç»œã€æ¨èå¼•æ“ã€çŸ¥è¯†å›¾è°±ã€é©¾é©¶æ–¹å‘ (è·¯çº¿æŸ¥æ‰¾)ã€ä¸šåŠ¡å…³ç³»ã€ä¾èµ–å…³ç³»ã€è´§ç‰©ç§»åŠ¨ç­‰ç±»ä¼¼é¡¹ç›®éå¸¸æœ‰ç”¨ã€‚</p><h3 id=ç¤¾äº¤ç½‘ç»œ>ç¤¾äº¤ç½‘ç»œ</h3><p>é€‚åˆé‡‡ç”¨å›¾å½¢çš„å¸¸è§ä½¿ç”¨æ¡ˆä¾‹çš„ä¸€ä¸ªç¤ºä¾‹å°±æ˜¯ç¤¾äº¤ç½‘ç»œæ•°æ®ã€‚<figure><img src=/images/ring.svg data-sizes=auto data-src=/graph-db-getting-and-started/friend-likes.png alt="graph db friend links" class=lazyload><figcaption class=image-caption>graph db friend links</figcaption></figure></p><h3 id=æ¨èå¼•æ“>æ¨èå¼•æ“</h3><p>å¯ä»¥åœ¨å›¾å½¢æ•°æ®åº“ä¸­å­˜å‚¨å®¢æˆ·å…´è¶£ã€å¥½å‹å’Œè´­ä¹°å†å²ç­‰ä¿¡æ¯ç±»åˆ«ä¹‹é—´çš„å…³ç³»ã€‚ç„¶åï¼Œå¿«é€ŸæŸ¥è¯¢å®ƒä»¥æå‡ºä¸ªæ€§åŒ–å’Œç›¸å…³çš„å»ºè®®ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨é«˜åº¦å¯ç”¨çš„å›¾å½¢æ•°æ®åº“ï¼Œæ ¹æ®å…³æ³¨ç›¸åŒè¿åŠ¨å†…å®¹ä¸”å…·æœ‰ç±»ä¼¼è´­ä¹°å†å²è®°å½•çš„å…¶ä»–äººè´­ä¹°çš„äº§å“ï¼Œå‘ç”¨æˆ·æä¾›äº§å“æ¨èã€‚æˆ–è€…ï¼Œå¯ä»¥è¯†åˆ«æœ‰å…±åŒå¥½å‹ä½†è¿˜ä¸è®¤è¯†å¯¹æ–¹çš„äººå‘˜ï¼Œç„¶åæä¾›å¥½å‹æ¨èã€‚</p><h3 id=çŸ¥è¯†å›¾è°±>çŸ¥è¯†å›¾è°±</h3><p>åˆ©ç”¨çŸ¥è¯†å›¾å½¢ï¼Œæ‚¨å¯ä»¥å°†ä¿¡æ¯å­˜å‚¨åœ¨å›¾å½¢æ¨¡å‹ä¸­ï¼Œå¹¶å¯ä»¥ä½¿ç”¨å›¾å½¢æŸ¥è¯¢å¸®åŠ©ç”¨æˆ·æ›´è½»æ¾åœ°å¯¼èˆªé«˜åº¦å…³è”çš„æ•°æ®é›†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·å¯¹ Leonardo da Vinci åˆ›ä½œçš„ Mona Lisa æ„Ÿå…´è¶£ï¼Œæ‚¨å¯ä»¥å¸®åŠ©ä»–ä»¬å‘ç°åŒä¸€è‰ºæœ¯å®¶çš„å…¶ä»–è‰ºæœ¯ä½œå“æˆ–å‘ç°åœ¨å¢æµ®å®«å±•è§ˆçš„å…¶ä»–ä½œå“ã€‚
åˆ©ç”¨çŸ¥è¯†å›¾è°±ï¼Œæ‚¨å¯ä»¥å°†ä¸»é¢˜ä¿¡æ¯æ·»åŠ åˆ°äº§å“ç›®å½•ï¼Œæ„å»ºå’ŒæŸ¥è¯¢å¤æ‚çš„ç›‘ç®¡è§„åˆ™æ¨¡å‹ï¼Œæˆ–è€…è¿›è¡Œä¸€èˆ¬ä¿¡æ¯å»ºæ¨¡ (å¦‚ç»´åŸºæ•°æ®)ã€‚</p><h2 id=neo4j>Neo4j</h2><p><a href=https://neo4j.com/docs/getting-started/current/ rel="nofollow noreferrer" target=_blank>Neo4j</a>æ˜¯ä¸–ç•Œé¢†å…ˆçš„å›¾å½¢æ•°æ®åº“ã€‚ å®ƒæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„å›¾å½¢å­˜å‚¨ï¼Œå…·æœ‰æˆç†Ÿå’Œå¼ºå¤§çš„æ•°æ®åº“æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¦‚å‹å¥½çš„æŸ¥è¯¢è¯­è¨€å’ŒACIDäº‹åŠ¡ã€‚ ç¨‹åºå‘˜ä½¿ç”¨çµæ´»çš„èŠ‚ç‚¹å’Œå…³ç³»ç½‘ç»œç»“æ„è€Œä¸æ˜¯é™æ€è¡¨ - ä½†äº«å—ä¼ä¸šçº§æ•°æ®åº“çš„æ‰€æœ‰å¥½å¤„ã€‚ å¯¹äºè®¸å¤šåº”ç”¨ç¨‹åºï¼Œä¸å…³ç³»æ•°æ®åº“ç›¸æ¯”ï¼ŒNeo4jæä¾›äº†æ•°é‡çº§çš„æ€§èƒ½ä¼˜åŠ¿ã€‚</p><h3 id=å®‰è£…>å®‰è£…</h3><p>è€æ ·å­ï¼Œæˆ‘ä¾æ—§ä¼šé€‚ç”¨Dockeræ¥è¿›è¡Œå®‰è£…ã€‚</p><pre><code class=language-bash>$ docker run -d \
    --name neo4j \
    -p 7474:7474 -p 7687:7687 \
    -v $HOME/neo4j/data:/data \
    -v $HOME/neo4j/logs:/logs \
    neo4j
</code></pre><p><figure><img src=/images/ring.svg data-sizes=auto data-src=/graph-db-getting-and-started/neo4j-dashboard.png alt=neo4j-dashboard class=lazyload><figcaption class=image-caption>neo4j-dashboard</figcaption></figure></p><h3 id=å®ä¾‹>å®ä¾‹</h3><h4 id=æ·»åŠ ä¾èµ–>æ·»åŠ ä¾èµ–</h4><pre><code class=language-gradle>dependencies {
    compile(&quot;org.neo4j:neo4j-ogm-core:3.1.7&quot;)
    compile(&quot;org.neo4j:neo4j-ogm-http-driver:3.1.7&quot;)
}
</code></pre><h4 id=ä»£ç >ä»£ç </h4><pre><code class=language-java>package team.soi.demo;

import lombok.Getter;
import lombok.Setter;
import org.neo4j.ogm.annotation.GeneratedValue;
import org.neo4j.ogm.annotation.Id;
import org.neo4j.ogm.annotation.NodeEntity;
import org.neo4j.ogm.annotation.Relationship;
import org.neo4j.ogm.config.Configuration;
import org.neo4j.ogm.session.Session;
import org.neo4j.ogm.session.SessionFactory;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class App {
    public static void main(String[] args) {
        Configuration configuration = new Configuration.Builder()
                .uri(&quot;http://neo4j:qazplm@localhost:7474&quot;)
                .build();
        SessionFactory sessionFactory = new SessionFactory(configuration, &quot;team.soi.demo&quot;);
        Session session = sessionFactory.openSession();

        User tom = new User();
        tom.setName(&quot;Tom&quot;);

        User bobby = new User();
        bobby.setName(&quot;Bobby&quot;);

        User linda = new User();
        linda.setName(&quot;Linda&quot;);

        linda.setFriends(Arrays.asList(tom, bobby));

        session.save(linda);
    }
}

@NodeEntity
@Getter
@Setter
class User implements Serializable {

    @Id
    @GeneratedValue
    private Long id;
    private String name;
    @Relationship(type = &quot;friend&quot;)
    private List&lt;User&gt; friends = new ArrayList&lt;&gt;();
}

</code></pre><p><figure><img src=/images/ring.svg data-sizes=auto data-src=/graph-db-getting-and-started/neo4j-friend.png alt=neo4j-friend class=lazyload><figcaption class=image-caption>neo4j-friend</figcaption></figure></p><blockquote><p><a href=https://www.w3cschool.cn/neo4j/ rel="nofollow noreferrer" target=_blank>neo4jæ•™ç¨‹</a></p></blockquote><h2 id=dgraph>Dgraph</h2><p>Dgraphæ˜¯ä¸€ä¸ªæ°´å¹³å¯æ‰©å±•çš„åˆ†å¸ƒå¼å›¾å½¢æ•°æ®åº“ï¼Œæä¾›ACIDäº‹åŠ¡ï¼Œä¸€è‡´çš„å¤åˆ¶å’Œçº¿æ€§åŒ–è¯»å–ã€‚ å®ƒæ˜¯ä»å¤´å¼€å§‹æ„å»ºçš„ï¼Œç”¨äºæ‰§è¡Œä¸°å¯Œçš„æŸ¥è¯¢ã€‚ ä½œä¸ºæœ¬æœºå›¾å½¢æ•°æ®åº“ï¼Œå®ƒä¸¥æ ¼æ§åˆ¶æ•°æ®åœ¨ç£ç›˜ä¸Šçš„æ’åˆ—æ–¹å¼ï¼Œä»¥ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½å’Œååé‡ï¼Œå‡å°‘ç£ç›˜æœç´¢å’Œç¾¤é›†ä¸­çš„ç½‘ç»œè°ƒç”¨ã€‚</p><p>Dgraphçš„ç›®æ ‡æ˜¯æä¾›è°·æ­Œç”Ÿäº§æ°´å¹³çš„è§„æ¨¡å’Œååé‡ï¼Œå…·æœ‰è¶³å¤Ÿä½çš„å»¶è¿Ÿï¼Œå¯ä»¥æä¾›è¶…è¿‡æ•°TBçš„ç»“æ„åŒ–æ•°æ®çš„å®æ—¶ç”¨æˆ·æŸ¥è¯¢ã€‚ Dgraphæ”¯æŒç±»ä¼¼GraphQLçš„æŸ¥è¯¢è¯­æ³•ï¼Œå¹¶é€šè¿‡GRPCå’ŒHTTPå“åº”JSONå’ŒProtocol Buffersã€‚</p><h3 id=å®‰è£…-1>å®‰è£…</h3><p>ç”±äºDgraphè‡³å°‘è¦æœ‰ä¸€ä¸ªzeroå’Œä¸€ä¸ªserveræ‰èƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨docker-compose.yaml</p><pre><code class=language-yaml>version: &quot;3.2&quot;
services:
  zero:
    image: dgraph/dgraph:latest
    volumes:
      - type: volume
        source: dgraph
        target: /dgraph
        volume:
          nocopy: true
    ports:
      - 5080:5080
      - 6080:6080
    restart: on-failure
    command: dgraph zero --my=zero:5080
  server:
    image: dgraph/dgraph:latest
    volumes:
      - type: volume
        source: dgraph
        target: /dgraph
        volume:
          nocopy: true
    ports:
      - 8080:8080
      - 9080:9080
    restart: on-failure
    command: dgraph alpha --my=server:7080 --lru_mb=2048 --zero=zero:5080
  ratel:
    image: dgraph/dgraph:latest
    volumes:
      - type: volume
        source: dgraph
        target: /dgraph
        volume:
          nocopy: true
    ports:
      - 8000:8000
    command: dgraph-ratel

volumes:
  dgraph:
</code></pre><h3 id=å®ä¾‹-1>å®ä¾‹</h3><h4 id=ä¾èµ–>ä¾èµ–</h4><pre><code>compile(&quot;io.dgraph:dgraph4j:1.7.1&quot;)
</code></pre><h4 id=ä»£ç -1>ä»£ç </h4><pre><code class=language-java>package team.soi.demo;

import com.google.gson.Gson;
import com.google.gson.annotations.SerializedName;
import com.google.protobuf.ByteString;
import io.dgraph.DgraphClient;
import io.dgraph.DgraphGrpc;
import io.dgraph.DgraphProto;
import io.dgraph.Transaction;
import io.grpc.ManagedChannel;
import io.grpc.ManagedChannelBuilder;
import lombok.Getter;
import lombok.Setter;

import java.io.Serializable;
import java.time.LocalDateTime;
import java.util.*;

public class DgraphApp {

    public static void main(String[] args) {
        ManagedChannel channel = ManagedChannelBuilder
                .forAddress(&quot;localhost&quot;, 9080)
                .usePlaintext()
                .build();
        DgraphGrpc.DgraphStub stub = DgraphGrpc.newStub(channel);
        DgraphClient dgraph = new DgraphClient(stub);

        //
        dgraph.alter(DgraphProto.Operation.newBuilder().setDropAll(true).build());

        Gson gson = new Gson();

        Transaction tx = dgraph.newTransaction();
        try {
            Tag database = new Tag();
            database.setName(&quot;Database&quot;);

            Tag graph = new Tag();
            graph.setName(&quot;Graph&quot;);

            Category category = new Category();
            category.setName(&quot;GraphDB&quot;);

            Post post = new Post();
            post.setTitle(&quot;Hello dgraph&quot;);
            post.setDigest(&quot;Dgraph demo.&quot;);
            post.setContent(&quot;Hello dgraph,this is a demo.&quot;);
            post.setViews(0);
            post.setCreated(LocalDateTime.now().toString());
            post.setTags(Arrays.asList(database, graph));
            post.setCategories(Collections.singletonList(category));

            String json = gson.toJson(post);
            DgraphProto.Mutation mu = DgraphProto.Mutation
                    .newBuilder()
                    .setSetJson(ByteString.copyFromUtf8(json))
                    .build();
            tx.mutate(mu);
            tx.commit();
        } finally {
            tx.discard();
        }

        // query
        String query = &quot;query posts($offset: int, $count: int){\n&quot; +
                &quot;\t\tposts(func: has(title), orderdesc: created, orderdesc: views, offset: $offset, first: $count){\n&quot; +
                &quot;\t\t\tuid\n&quot; +
                &quot;\t\t\ttitle\n&quot; +
                &quot;\t\t\tcategories {\n&quot; +
                &quot;\t\t\t\tuid\n&quot; +
                &quot;\t\t\t\tname\n&quot; +
                &quot;\t\t\t}\n&quot; +
                &quot;\t\t\ttags {\n&quot; +
                &quot;\t\t\t\tuid\n&quot; +
                &quot;\t\t\t\tname\n&quot; +
                &quot;\t\t\t}\n&quot; +
                &quot;\t\t\tdigest\n&quot; +
                &quot;\t\t\tcreated\n&quot; +
                &quot;\t\t}\n&quot; +
                &quot;\t}&quot;;
        Map&lt;String, String&gt; vars = new HashMap&lt;&gt;();
        vars.put(&quot;$offset&quot;, &quot;0&quot;);
        vars.put(&quot;$count&quot;, &quot;25&quot;);

        DgraphProto.Response response = dgraph.newReadOnlyTransaction().queryWithVars(query, vars);
        Posts posts = gson.fromJson(response.getJson().toStringUtf8(), Posts.class);

        System.out.printf(&quot;Found hot post: %d\n&quot;, posts.getPosts().size());

        posts.getPosts().forEach(post -&gt; System.out.println(post.getTitle()));
    }
}

@Getter
@Setter
class Posts implements Serializable {
    List&lt;Post&gt; posts;
}

@Getter
@Setter
class Post implements Serializable {
    @SerializedName(&quot;uid&quot;)
    private String id;
    private String title;
    private String digest;
    private String content;
    private String created;
    private Integer views;
    private List&lt;Tag&gt; tags = new ArrayList&lt;&gt;();
    private List&lt;Category&gt; categories = new ArrayList&lt;&gt;();
}

@Getter
@Setter
class Tag implements Serializable {
    @SerializedName(&quot;uid&quot;)
    private String id;
    private String name;
}

@Setter
@Getter
class Category implements Serializable {
    @SerializedName(&quot;uid&quot;)
    private String id;
    private String name;
}
</code></pre><p><figure><img src=/images/ring.svg data-sizes=auto data-src=/graph-db-getting-and-started/dgraph-post.png alt=dgraph-post class=lazyload><figcaption class=image-caption>dgraph-post</figcaption></figure></p><blockquote><p><a href=https://dgraph-zh.cn/#/home/index rel="nofollow noreferrer" target=_blank>Dgraphä¸­æ–‡æ–‡æ¡£</a></p></blockquote><h2 id=ç»“æŸè¯­>ç»“æŸè¯­</h2><p>å½“ç„¶ï¼Œæœ¬æ¬¡çŸ¥è¯†ç²—ç•¥ä»‹ç»äº†ä¸‹å›¾æ•°æ®åº“ï¼Œå¦‚æœæœ‰æ—¶é—´ï¼Œåç»­æˆ‘åº”è¯¥ä¼šæ‰¾ä¸€ä¸ªåœºæ™¯æ¥å®é™…åº”ç”¨ï¼Œå…ˆæŒ–ä¸ªå‘ï¼Œåç»­åŠªåŠ›è¡¥ä¸Š ğŸ˜„ ã€‚</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Soi</span></p><p class=copyright-item><span>Link:</span>
<a href=https://ronggle.com/2019/graph-db-getting-and-started/>https://ronggle.com/2019/graph-db-getting-and-started/</span></p><p class="copyright-item lincese">æœ¬æ–‡é‡‡ç”¨<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank>çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯</p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://ronggle.com/tags/database/>#Database</a></span>
<span class=tag><a href=https://ronggle.com/tags/graphdb/>#GraphDB</a></span>
<span class=tag><a href=https://ronggle.com/tags/graph/>#Graph</a></span>
<span class=tag><a href=https://ronggle.com/tags/dgraph/>#DGraph</a></span>
<span class=tag><a href=https://ronggle.com/tags/neo4j/>#Neo4j</a></span></section><section><a href=javascript:window.history.back();>back</a></span> Â·
<span><a href=https://ronggle.com/>home</a></span></section></div><div class=post-nav><a href=https://ronggle.com/2018/traefik-on-kubernetes/ class=prev rel=prev title="Traefik on Kubernetes"><i class="iconfont icon-left"></i>&nbsp;Traefik on Kubernetes</a>
<a href=https://ronggle.com/2019/elassandra-getting-and-started/ class=next rel=next title=Elassandraç®€å•ä»‹ç»>Elassandraç®€å•ä»‹ç»&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><link rel=stylesheet href=/css/gitalk.min.css><script src=/js/gitalk.min.min.js></script><div id=gitalk-container></div><script>var gitalk=new Gitalk({clientID:"a2f917f5cb45d6dffe92",clientSecret:"879169dfceea28b064c49ef7fd190cdafcc6e5a7",repo:"ycrxun.github.io",owner:"ycrxun",admin:"ycrxun",id:location.pathname,distractionFreeMode:false});gitalk.render('gitalk-container');</script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2015 - 2019</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://ronggle.com/>Soi</a> |</span>
<a href=http://www.beian.miit.gov.cn/ target=_blank rel="external nofollow">é»”ICPå¤‡15015267å·</a> |
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css rel=stylesheet><script src=/js/vendor_gallery.min.js async></script><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?VNkd8ZiQJH29dqsu";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><div id=landlord style=left:30px><div class=message style=opacity:0></div><canvas id=live2d width=280 height=250 class=live2d></canvas><div class=hide-button>éšè—</div></div><link rel=stylesheet href=/css/live2d.min.css><script src=/js/live2d.min.js></script><script src=/live2d/message.js></script><script type=text/javascript>loadlive2d("live2d","\/live2d\/model\/tia\/model.json");</script></div></body></html>